############################################################
## The Amstrad DRX890 is a Broadcom 7335 based box
## The Amstrad DRX595 is a Broadcom 7350 based box
############################################################


############################################################
## source-insight
############################################################
\\ukstbuild02\parkkt\cc\parkkt_BSKYB_GM_001\vobs\CMS_MEDIA_SERVICES
\\ukstbuild02\parkkt\cc\parkkt_BSKYB_GM_001\vobs\DARWIN_PLATFORM
\\ukstbuild02\parkkt\cc\parkkt_BSKYB_GM_001\vobs\CMS_SYSTEM_RESOURCE\
\\ukstbuild02\parkkt\cc\parkkt_BSKYB_GM_001\vobs\


############################################################
## CC
############################################################

# view storage name for ukstbuild3
\\ukstbuild3.uk.nds.com\parkkt\cc\parkkt_VGV_DARWIN_MAIN_int.vws

#-----------------------------------------------------------
# cc-note: read before joininig any projects		*:cc-note*
#-----------------------------------------------------------

(from http://hoover.uk.nds.com/fusionmadesimple/index.php/Using_Linux_ClearCase)

Add "alias ct=cleartool" (without the quotes) to your .bashrc file and use ct wherever you see cleartool below. 

Start project explorer

   1. From a linux environment run "clearprojexp&"
   2. Navigate to the appropriate project. E.g: /vobs/FUSION_SYSTEM_INTEGRATION_PROJECTS/BSKYB_SI_PROJECTS/BSKYB_INTEGRATION_MAIN
   3. Right-click and choose "Create Child Stream".
   4. Enter the name of the stream to use and accept defaults; click Next.
   5. Click "Snapshot". Edit "Snapshot View Location" to taste. Click Next. (**)
   6. IMPORTANT! Un-check "Load the development view now". We will do this later. Click Finish. (****)
   7. Confirm: Click Continue. 

Editing Load Rules

   1. From inside your snapshot view folder run "cleartool edcs"
   2. Navigate to the bottom line where it reads: 

#UCMCustomLoadBegin - DO NOT REMOVE - ADD CUSTOM LOAD RULES AFTER THIS LINE

   1. Add your load rules below this line, save and exit
   2. A box "Set config spec?" appears. Click "yes". A box "Continue, and unload these objects?" appears. Click "yes".
   3. The view will now be populated with files. Go and have a coffee. 

#-----------------------------------------------------------
# cc-rule-890
#-----------------------------------------------------------
VOB:
FUSION_SYSTEM_INTEGRATION_PROJECTS/BSKYB_SI_PROJECTS/BSKYB_GM/BSKYB_GM_Integration

Load Rules:
load /vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build
load /vobs/FUSIONOS_2/BLD_AMS_BCM_MIPS4K_LNUX_DARWIN_01/platform_cfg/linux
load /vobs/FUSIONOS_INPUT_DEL_2/DEL_AMS_BCM_MIPS4K_LNUX_DARWIN_01/Tarball
load /vobs/FUSIONOS_INPUT_DEL_2/DEL_AMS_BCM_MIPS4K_LNUX_DARWIN_01/build_platform
load /vobs/FUSIONOS_OUTPUT_DEL_2/KERN_AMS_BCM_MIPS4K_LNUX_DARWIN_01

#-----------------------------------------------------------
# cc-rule-595
#-----------------------------------------------------------
#VOB:
#FUSION_SYSTEM_INTEGRATION_PROJECTS/BSKYB_SI_PROJECTS/BSKYB_BRANCNES/BSKYB_HZ001
#
#load /vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build
#load /vobs/FUSIONOS_5/BLD_DARWIN_SKYDRX595_BCM97350_LNUX_01/platform_cfg/linux
#load /vobs/FUSIONOS_INPUT_DEL_5/DEL_DARWIN_SKYDRX595_BCM97350_LNUX_01


#-----------------------------------------------------------
# cc-cmds
#-----------------------------------------------------------
ct lsview -long parkkt_BSKYB_HR002

# GM : NOTE: when rebasing, there are warning mesgs showing overrides so have checks on those.
#
ct rebase -comp -base BSKYB_INTEGRATION_BLD_49.07.00_BSKYB_HR004_Int@/vobs/FUSION_SYSTEM_INTEGRATION_PROJECTS
ct rebase -comp -base BSKYB_INTEGRATION_BLD_58.14.00_BSKYB_HR006_Int@/vobs/FUSION_SYSTEM_INTEGRATION_PROJECTS  

# branch of branch
ct rebase -comp -base BSKYB_INTEGRATION_BLD_48.84.05_BSKYB_HR004_48.84_Int@/vobs/FUSION_SYSTEM_INTEGRATION_PROJECTS

ct rebase -comp -base BSKYB_INTEGRATION_BLD_48.53.02_BSKYB_HR004_48.53_Int@/vobs/FUSION_SYSTEM_INTEGRATION_PROJECTS

# HZ00x
ct rebase -comp -base BSKYB_INTEGRATION_BLD_01.64.00_BSKYB_HZ001_Int@/vobs/FUSION_SYSTEM_INTEGRATION_PROJECTS

# remove an overriden comp and rebase. -dba/seline baseline-selector[,...] 
ct rebase -comp -dba SIM_F43.0.REL_SIM_BSKYB_HZ_001_Integration@/vobs/CMS_INFORMATION_SERVICES_PROJECTS

ct rebase -base SIM_F43.1.REL_SIM_BSKYB_HZ_001_Integration@/vobs/CMS_INFORMATION_SERVICES_PROJECTS

# it's possible to run this with two baselines in one go: ct rebase -comp -base first,second
ct rebase -comp -base darwin_middleware_services_D57.0.17_DMS_MASTER_Integration_2_Int@/vobs/DARWIN_INTEGRATION_PROJECTS
ct rebase -comp -base FREETYPE2_F30.1.REL_FREETYPE2_MAIN_Int@/vobs/CMS_SYSTEM_INFRASTRUCTURE_PROJECTS
ct rebase -comp -base MSM_COMP_F47.1.REL_MSM_MAIN_5_Int@/vobs/CMS_MEDIA_SERVICES_PROJECTS
ct rebase -comp -base MEMMAN_F45.0.REL.0_pevanden_MEMMAN_MAIN@/vobs/CMS_SYSTEM_INFRASTRUCTURE_PROJECTS
ct rebase -comp -base DARWIN_ATG_F47.6.REL_DARWIN_ATG_MAIN_Int@/vobs/DARWIN_PLATFORM_PROJECTS

ct rebase -comp -base BSKYB_JTH_10.04F_BSKY_JTH_IMPORT_MAIN_Int@/vobs/THIRD_PARTY_LIBS_PROJECTS
ct rebase -comp -base BSKYB_JTH_trunk.56099_BSKYB_JTH_GM_Integration@/vobs/THIRD_PARTY_LIBS_PROJECTS

ct rebase -comp -base DARWIN_PLAYER_F44.1.REL_DARWIN_PLAYER_BSKYB_HZ_001_Int@/vobs/DARWIN_PLATFORM_PROJECTS
ct rebase -comp -base DARWIN_PLANNER_F45.4.REL_DARWIN_PLANNER_MAIN_Int@/vobs/DARWIN_PLATFORM_PROJECTS
ct rebase -comp -base DARWIN_SBM_F44.0.REL_DARWIN_SBM_BSKYB_HZ_001_Int@/vobs/DARWIN_PLATFORM_PROJECTS

ct rebase -base CDI_TRACKER_F1.0.17_CDI_TRACKER_MAIN_Int@/vobs/FUSIONOS_3_PROJECTS
ct rebase -base CRAFTWORK_LAE_darwin_f30.2-2010-10-13_CRAFTWORK_LAE_MAIN_Int@/vobs/THIRD_PARTY_LIBS_PROJECTS
ct rebase -comp -base MBLD_AMS_BCM_MIPS4K_LNUX_DARWIN_01_6.5.890.61-H1.18p1_0.2@/vobs/FUSIONOS_2_PROJECTS
ct rebase -comp -base VGV_DARWIN_F45.22.4.7.6.REL_VGV_DARWIN_MAIN_Integration@/vobs/VideoGuard_Projects

ct rebase -comp -base DARWIN_JAVA_ADAPTORS_COMP_56.0.36.08.REL_DARWIN_PLATFORM_JAVA_MAIN_Int@/vobs/DARWIN_PLATFORM_PROJECTS

# -rec/ommended
# Specifies that a development stream is to be rebased to its parent stream's recommended baselines. Using this option clears 
# the existing foundation baselines and replaces them with the recommended ones.
ct rebase -rec
ct rebase -status -view parkkt_BSKYB_HR002
ct rebase -resume -view parkkt_BSKYB_HR002
ct rebase -complete [-view parkkt_BSKYB_HR002]

# search baseline
ct describe baseline:BSKYB_INTEGRATION_BLD_01.59.00_BSKYB_HZ001_Int@/vobs/FUSION_SYSTEM_INTEGRATION_PROJECTS
ct describe baseline:darwin_middleware_services_D60.0.3_DMS_BSKYB_HR_006_Int@/vobs/DARWIN_INTEGRATION_PROJECTS

ct desc baseline:SYSTEM_COMPOSITE_SYSF31.03_BSKYB_HR002_Int@/vobs/FUSION_SYSTEM_INTEGRATION_PROJECTS
ct desc baseline:BUILD_OS_SYSF31.03_BSKYB_HR002_Int@/vobs/FUSION_SYSTEM_INTEGRATION_PROJECTS
ct desc baseline:BUILD_OS_SYSF31.03_BSKYB_HR002_Int@/vobs/FUSION_SYSTEM_INTEGRATION_PROJECTS | grep AMS
    MBLD_AMS_NXP_ARM9_LNUX_DARWIN_01_SDK_6.0.0.1240_0.4@/vobs/FUSIONOS_2_PROJECTS (MBLD_AMS_NXP_ARM9_LNUX_DARWIN_01@/vobs/FUSIONOS_2_PROJECTS)
    MBLD_AMS_BCM_MIPS4K_LNUX_DARWIN_01_6.5.890.43-H1.15_0.1@/vobs/FUSIONOS_2_PROJECTS (MBLD_AMS_BCM_MIPS4K_LNUX_DARWIN_01@/vobs/FUSIONOS_2_PROJECTS)
    MBLD_AMS_NXP_ARM9_LNUX_DARWIN_03_SPK_1.16_H3_7.5.1.5170_0.1@/vobs/FUSIONOS_3_PROJECTS (MBLD_AMS_NXP_ARM9_LNUX_DARWIN_03@/vobs/FUSIONOS_3_PROJECTS)


ct describe baseline:DARWIN_PLAYER_F40.2.REL_DARWIN_PLAYER_BSKYB_HR_002_Int@/vobs/DARWIN_PLATFORM_PROJECTS
ct describe activity:deliver.flengron_DARWIN_PLAYER_BSKYB_HR_002.20100806.181221@/vobs/DARWIN_PLATFORM_PROJECTS
ct desc stream:SIM_BSKYB_HZ_001_Integration@/vobs/CMS_INFORMATION_SERVICES_PROJECTS 

ct desc stream:BSKYB_GM_Integration@/vobs/FUSION_SYSTEM_INTEGRATION_PROJECTS | grep parkkt
ct desc activity:deliver.parkkt_BSKYB_GM_001.20130514.135443@/vobs/FUSION_SYSTEM_INTEGRATION_PROJECTS

ct lsstream -l -cview

# get foundation baselines and comp baselines
ct describe -fmt %[found_bls]Cp stream:BSKYB_GM_Integration@/vobs/FUSION_SYSTEM_INTEGRATION_PROJECTS | sed 's/, /\n/g'
ct describe -fmt %[found_bls]Cp stream:parkkt_BSKYB_GM_03@/vobs/FUSION_SYSTEM_INTEGRATION_PROJECTS | sed 's/, /\n/g'
ct describe -fmt %[found_bls]Xp stream:parkkt_BSKYB_GM_03@/vobs/FUSION_SYSTEM_INTEGRATION_PROJECTS | sed 's/ /\n/g'

# need sed as output is one line comma seperated.
ct lsbl -fmt "%[depends_on]XCp\n" darwin_middleware_services_D47.0.77_DMS_MASTER_Integration_Int@/vobs/DARWIN_INTEGRATION_PROJECTS | sed 's/, /\n/g' > D47.0.77.txt

# to get full list
if [ ${FULL_COMP_LISITNG} == "Y" ]; then
	for bl in $(cleartool lsstream -fmt '%[found_bls]Xp\n'); do
		echo "Getting list of component baselines for ${bl}..."
		echo "">>${out}
		echo "-----------------------------------------------------------------------------------------">>${out}
		echo "# $bl :">>${out}
		echo "-----------------------------------------------------------------------------------------">>${out}
		cleartool lsbl -fmt "%[depends_on_closure]Cp\n" ${bl} | sed 's/,./\n/g' | sed 's/@.*//g' | sort>>${out}
		echo "">>${out}
	done
fi

# get driver baseline detail
#
# get driver baseline from the full list
$ ct lsbl -fmt "%[depends_on_closure]Cp\n" darwin_middleware_services_26.12.00_BSKYB_GM_Integration@/vobs/FUSION_SYSTEM_INTEGRATION_PROJECTS | sed 's/, /\n/g' | egrep MBLD_AMS_BCM_MIPS4K
MBLD_AMS_BCM_MIPS4K_LNUX_DARWIN_01_6.5.890.60-H1.18p0_0.1@/vobs/FUSIONOS_2_PROJECTS

# get full list of a driver baseline and can use the below to filter out unnecessary details
# 
# CONTAIN_BLS=`( cleartool lsbl -fmt "%[member_of]XCp\n" $BL 2>&1; ) | sed '/^cleartool/d' | sed '/Warning/d' | sed 's/,.*//g'`
$ cleartool lsbl -fmt "%[member_of]XCp\n" MBLD_AMS_BCM_MIPS4K_LNUX_DARWIN_01_6.5.890.60-H1.18p0_0.1@/vobs/FUSIONOS_2_PROJECTS
AMS_BCM_MIPS4K_LNUX_DARWIN_01_6.5.890.60-H1.18p0_0.1@/vobs/FUSIONOS_2_PROJECTS


# get the detail of it
$ cleartool lsbl -fmt "    %[depends_on_closure]XCp\n" AMS_BCM_MIPS4K_LNUX_DARWIN_01_6.5.890.60-H1.18p0_0.1@/vobs/FUSIONOS_2_PROJECTS | sed 's/, /\n    /g'


#
# compare
#
cleartool diffbl -act BSKYB_INTEGRATION_BLD_01.38.00_BSKYB_HZ001_Int@/vobs/FUSION_SYSTEM_INTEGRATION_PROJECTS BSKYB_INTEGRATION_p01.32_BSKYB_HZ001_Int@/vobs/FUSION_SYSTEM_INTEGRATION_PROJECTS | egrep -v "deliver|rebase" | sed 's/@.*//g'

cleartool diffbl -base -act 'BSKYB_INTEGRATION_BLD_SYSF31.01_BSKYB_HR002_Int'@/vobs/FUSION_SYSTEM_INTEGRATION_PROJECTS 'BSKYB_INTEGRATION_BLD_SYSF30.11_BSKYB_HR002_Int'@/vobs/FUSION_SYSTEM_INTEGRATION_PROJECTS | findstr -V "rebase deliver << <-"

cleartool diffbl -base -act DARWIN_WLM_JAVA_F44.6.REL_DARWIN_PLATFORM_JAVA_MAIN_Integration@/vobs/DARWIN_PLATFORM_PROJECTS DARWIN_WLM_JAVA_F43.19.REL_DARWIN_PLATFORM_JAVA_MAIN_Integration@/vobs/DARWIN_PLATFORM_PROJECTS | findstr -V "rebase deliver << <-"

cleartool mkview -snap -tag parkkt_BSKYB_HR002_03 -tmode transparent -stre stream:parkkt_BSKYB_HR002_3@/vobs/FUSION_SYSTEM_INTEGRATION_PROJECTS -stgloc -auto /home/NDS-UK/parkkt/cc/parkkt_BSKYB_HR002_03

# get change detail
#
cleartool diffbl -base -act BSKYB_INTEGRATION_BLD_24.04.00_BSKYB_GM_Integration@/vobs/FUSION_SYSTEM_INTEGRATION_PROJECTS BSKYB_INTEGRATION_BLD_24.03.00_BSKYB_GM_Integration@/vobs/FUSION_SYSTEM_INTEGRATION_PROJECTS

# for a naming ref and rasing CQ.
#
ct desc activity:MSCQ169268_-_Model_name_in_SPM_needs_to_be_Sky_HD_not_Sky_HD@/vobs/FUSION_SYSTEM_INTEGRATION_PROJECTS

ct diff -gra -predecessor /view/parkkt_BSKYB_GM_int/vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/projects/picasso/SI_config.xml@@/main/BSKYB_GM_Integration/49
ct diff -ser -predecessor /view/parkkt_BSKYB_GM_int/vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/projects/picasso/SI_config.xml@@/main/BSKYB_GM_Integration/49

# search modified file. don't work when use on a sym link.
ct ls -r -l | grep hijacked

# update modified file with the version in the spec. -ove/rwrite
ct update -ove ./GFX/src/blitter/gfx_blitter_v1_p.c

#-----------------------------------------------------------
# cc-picasso
#-----------------------------------------------------------

# release email for outside
./get_diff_between_SI_baselines.sh -nb BSKYB_INTEGRATION_BLD_48.52.00_BSKYB_HR004_Int -ob BSKYB_INTEGRATION_BLD_48.51.00_BSKYB_HR004_Int
./get_diff_between_SI_baselines.sh -nb BSKYB_INTEGRATION_BLD_48.42.00_BSKYB_HR004_Int -ob BSKYB_INTEGRATION_BLD_48.41.00_BSKYB_HR004_Int -f

####
# pica drop
####

# search pica drop from engage: Picasso_DIGI_7.04 and unpgp it.

[parkkt@ukstbuild02 build]$ ct lsstream -l
stream "parkkt_BSKYB_PICASSO_DIGIBOX_MAIN"
views:
    parkkt_BSKYB_PICASSO_DIGIBOX_MAIN_01_dyn
foundation baselines:
    BSKYB_JTH_7.03F_BSKYB_PICASSO_DIGIBOX_MAIN_Int@/vobs/THIRD_PARTY_LIBS_PROJECTS

cd /view/parkkt_BSKYB_PICASSO_DIGIBOX_MAIN_01_dyn/vobs
cd /view/parkkt_BSKYB_PICASSO_DIGIBOX_MAIN_01_dyn/vobs/THIRD_PARTY_LIBRARIES/BSKYB_JTH/build

cleartool rebase -comp -rec
cleartool update -ove -f

clearfsimport -preview -recurse -rmname -nsetevent "/home/NDS-UK/parkkt/picasso_drop_801F/picasso" "/view/parkkt_BSKYB_PICASSO_DIGIBOX_MAIN_01_dyn/vobs/THIRD_PARTY_LIBRARIES/BSKYB_JTH/build/applications/Picasso" 2>&1 | tee ~/Picasso_import_801F_preview.txt

egrep -v "Skipping|unchanged" Picasso_import_801F_preview.txt | wc -l

ct mkact -nc -f -headline 'MSCQ6459 - Import Release 8.01F' 

clearfsimport -recurse -rmname -nsetevent "/home/NDS-UK/parkkt/picasso_drop_801F/picasso" "/view/parkkt_BSKYB_PICASSO_DIGIBOX_MAIN_01_dyn/vobs/THIRD_PARTY_LIBRARIES/BSKYB_JTH/build/applications/Picasso" 2>&1 | tee ~/Picasso_import_801F.txt

# diff
# -q     Report only whether the files differ, not the details of the differences.
# -r     When comparing directories, recursively compare any subdirectories found.
diff -qr "/home/NDS-UK/parkkt/picasso_drop_801F/picasso" "/view/parkkt_BSKYB_PICASSO_DIGIBOX_MAIN_01_dyn/vobs/THIRD_PARTY_LIBRARIES/BSKYB_JTH/build/applications/Picasso"

# deliever acts to the def stream(int stream). Can be skipped if use int stream?
# make a baseline.



####
# patch. this script will create baseline and recommand it so don't need to do more.
####
~/bin/patch_digibox_picasso.sh -f=/home/NDS-UK/parkkt/PicassoDIGI_8.01F_P1.patch
~/bin/patch_digibox_picasso.sh -f=/home/NDS-UK/parkkt/patches/PicassoDIGI_8.01F_P2.patch


####
# si baseline
# http://hudsonmaster1:9000/projects/hudsonadmin/wiki/SI_Baseline_process
# http://hudsonmaster1:9000/projects/hudsonadmin/wiki/PVR_-_BSKYB_GM
####

# MSCQ
Area: Fusion Product: DARWIN SI
#
# check in
ct mkactivity -hea "MSCQ180429:Import WIFI bootscript to GM"

# check out
$ ct co -nc build_mw_epg.sh

# check in
ct ci -nc bootlog-upload-1.sh bootlog-upload.sh 

# check in new elements. before
ct co -nc bootlog 
ct mkelem -nc -ci -ptime bootlog-upload_w.sh bootlog-wifi-upload.sh bootlog_w.sh

cd /view/parkkt_BSKYB_HZ001_int_dyn/vobs

baseline_and_recommend.sh BSKYB_GM_Integration

../cc/parkkt_BSKYB_GM_002/vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/tools/nds/si/clearcase_scripts/

./bins/get_diff_between_SI_baselines.sh -nb BSKYB_INTEGRATION_BLD_33.55.00_BSKYB_GM_Integration

# change or overrise baselines on int stream. when done, run following script.
# or
# make local changes and deliver it to the int stream.
create_595_bl.sh 

# check report in /home/NDS-UK/parkkt/baseline_reports

# run this to create hudson build. 
# http://hudsonmaster1.uk.nds.com:8080/hudson/job/GetSourceFromCI_drx595/
# http://hudsonmaster1.uk.nds.com:8080/hudson/view/All/job/GetSourceFromCI/
get_source_to_hudson.sh 

# do release email work

# for SDKs
./release_SDKs.sh --platform ams_bcm --project picasso
Unpack the tarball it creates
cd to the level where the make.sh is in the tarball
./make.sh --NDS_APP_TYPE picasso --NDS_BUILD_TYPE release_dbg --NDS_PLATFORM ams_bcm --NDS_PDL_SERVER NDS_UK

# hudson
http://hudsonmaster1.uk.nds.com:8080/hudson/view/Maintenance/job/Generate_Info_Page/lastSuccessfulBuild/artifact/current_baseline_all_platforms.htm


############################################################
## si-sp (shared planner)
############################################################

# filtering. see osport.c
(libupnp.cfg)
[PRODUCTNAME_FILTERING]
FILTERING_ENABLED=TRUE
PRODUCTNAME="SKY"			# seems not used. 
PRODUCTNAME_FILTER="SKY"

-sh-3.2# cd /mnt/nds/dev_5/part_0/FSN_DATA/
-sh-3.2# more UPNPUAID 
USERAGENTID=SKY

# when a sc no sp entitlement, it shows "avaiable" in network screen. otherwise, it shows "connected".
#

 
############################################################
## DMS
############################################################

#-----------------------------------------------------------
# dms-890
# http://hoover.uk.nds.com/fusionmadesimple/index.php/Run_DMS_999_for_SPM
# http://shareatnds.uk.nds.com/C13/DMS%20Integration/default.aspx
# http://172.19.94.100/sky/ and http://ndpedia.nds.com/index.php/BSkyB_Smart_Card
# http://oblivion.uk.nds.com/fusion_webhelp/DMS%20Test%20Plan/WebHelp/AA_Start.htm
# FSION-CRW-1618-Darwin Integration Clearcase Process Presentation.ppt
#
# http://oblivion.uk.nds.com/fusion_webhelp/Fusion_Integration_Processes/AA_Start.htm
# 	Creating a DMS Work Package Integration Stream
#
# HN(home network)
# http://ndpedia/index.php/UK_Fusion_DMS_Home_Networking
#-----------------------------------------------------------
VOB:
FUSION_SYSTEM_INTEGRATION_PROJECTS/BSKYB_SI_PROJECTS/BSKYB_GM/BSKYB_GM_Integration

Load Rules:
load /vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build
load /vobs/FUSIONOS_2/BLD_AMS_BCM_MIPS4K_LNUX_DARWIN_01/platform_cfg/linux
load /vobs/FUSIONOS_INPUT_DEL_2/DEL_AMS_BCM_MIPS4K_LNUX_DARWIN_01/Tarball
load /vobs/FUSIONOS_INPUT_DEL_2/DEL_AMS_BCM_MIPS4K_LNUX_DARWIN_01/build_platform
load /vobs/FUSIONOS_OUTPUT_DEL_2/KERN_AMS_BCM_MIPS4K_LNUX_DARWIN_01
load /vobs/DARWIN_PLATFORM/dms

# to build. --release_dbg is a default.
#
cd DARWIN_PLATFORM/dms/build/integration/dms/
./make_SKPD-AMS0201_scenario.sh --fast DMS_0999 (for Amstrad 890)

cd DARWIN_PLATFORM/dms/build/integration/dms/
./make_SKPD-AMS0201_scenario.sh --fast DMS_0706_1 (for Amstrad 890)

# end of build message
#
export FUSION_AMS_PROXY_URL=$AMS_PROXY_URI$
#/host/set_diag_level.sh P_Api 'I<>[]RP' # etc to set debug levels
/host/dms_startup.sh skpd-ams0201 DMS_0999 FORMAT 
##########################################################################
Built DMS_Player_Tuning_Suite.
  in 488 seconds.
TEST WARNINGS: 181
[parkkt@ukstbuild3 dms]$ 


# see a mapping between suite and test
#
[parkkt@ukstbuild3 DMS_Player_Tuning_Suite]$ pwd
/home/NDS-UK/parkkt/cc/parkkt_BSKYB_HR004_004/vobs/DARWIN_PLATFORM/dms/build/integration/dms/suites/DMS_Player_Tuning_Suite

[parkkt@ukstbuild3 DMS_Player_Tuning_Suite]$ ll
-r--r--r--  1 parkkt ccusers 29516 Jun  1 16:41 DMS_Player_Tuning_Suite.c
-r--r--r--  1 parkkt ccusers  7390 Jun  1 16:41 DMS_Player_Tuning_Suite.h
drwxr-xr-x  2 parkkt ccusers  4096 Jun  1 16:41 ini/		# see test numbers
-r-xr-xr-x  1 parkkt ccusers   397 Jun  1 16:41 makefile*
drwxr-xr-x 21 parkkt ccusers  4096 Jun  1 16:41 setup/
-r-xr-xr-x  1 parkkt ccusers  7192 Jun  1 16:41 src.mk*
drwxr-xr-x  2 parkkt ccusers 12288 Jun  1 16:41 tests/		# see actual test codes
[parkkt@ukstbuild3 DMS_Player_Tuning_Suite]$ 


# output
#
/home/NDS-UK/parkkt/cc/parkkt_BSKYB_HR004_004/vobs/DARWIN_PLATFORM/dms/
build/integration/dms/DMS_Player_Tuning_Suite/AMS_BCM_MIPS4K_LNUX_DARWIN_01/BigEndian/

(cerberus)
\\ukstbuild3\parkkt\cc\parkkt_BSKYB_HR004_004\vobs\DARWIN_PLATFORM\dms\build\integration\dms\
DMS_Player_Playback_Suite\AMS_BCM_MIPS4K_LNUX_DARWIN_01\BigEndian\cerberus_bin\


# on the box
#
mkdir /host
mount 172.18.253.233:/home/NDS-UK/parkkt/cc/parkkt_BSKYB_HR004_004/vobs/DARWIN_PLATFORM/dms/build/integration/dms/DMS_Player_Tuning_Suite/AMS_BCM_MIPS4K_LNUX_DARWIN_01/BigEndian /host

# /host/set_diag_output.sh ""
/host/set_stb_id.sh ""
/host/set_stb_id.sh "F0F0F0F0"
/host/set_stb_id.sh "00BC614E"
# /host/set_stb_id.sh "8 Hex digit Card Pairing Number*". 
#
# * STB Version: 4E3007
# * STB Number (STB ID in decimal): 0170839115
# * Card ID
#
# *NB. The card pairing number is not the number stencilled on the card. 
# It is the "Serial Number" displayed in decimal on the Settings - System Details page of a live box with which the card is paired
# "" will use "default".

/host/set_boris.sh "" "" ""

/host/dms_startup.sh skpd-ams0201 DMS_0999 FORMAT

# results
/host/fs/NDS/results

# diag log (from diagctl.cfg)
/tmp/dms/


############################################################
## pairing and serialization
############################################################

# serialization
NDS: chip id(KIC or KIB) and serial num(hardware id or stb id)
OP : smart card id and serial num(hardware serial id or stb id)
EMM: smart card id and serial num
SC : save serial num

(1) STB flash
use version info device(hardware serial id, manu id and etc) -> driver -> MW

(2) generic serial nmuber
when it's not a production box

(3) use config file
use sysinit_component.cfg by modifying MW.

(4) can use dummy pairing ( pairing to dummy box )
can use EMM that can pair any hardware id(box)

(5) smart card dump
can see following value. 

Paired IRD ID;FFFFFFFF

==
SPM_Srv_SysInfoGetString
	case SPM_API_SYSINFO_PROPID_STB_HARDWARE_SERIAL_NUM_ID:
	SPM_SYSINFO_DIAG_LOG_INFO(("Read PROPID_STB_HARDWARE_SERIAL_NUM_ID"));

	if(SYSINIT_API_GetVersionInformationString("STB_ID", systemString) != SYSINIT_STATUS_OK)
		status = ReadVersionInformationDevice(inputRequest, outputHandle);
		

# ./build_mw_epg.sh --clean --project picasso --platform ams-drx890 --use_sysinit_cfg --profile nds_si_devel --variant debug 
#
SI_Config.xml:		
  <profile name="read_serialisation_from_file">
   <file name="sysinit_component.cfg">
    <section name="HARDWARE_STRINGS">
     <key name="MODEL_NAME" type="STRING" value="TDS865NSDX">
     </key>
     <key name="STB_ID" type="STRING" value="F0F0F0F0">
     </key>
    </section>
   </file>
  </profile> 

  
SYSINIT SVR:	
	handleGetHardwareString		
	{
		#ifdef MSCQ144401_VERSION_INFORMATION_FROM_CONFIG
		
		or
		
		getHardwareStringFromDevice
	}
	

# serial num for 890 case
383999005 (obtained serial number) and convert it to hex. 0x16E3 5C1D (hex). This becomes CA id in the below desc.

* SERIAL.FLA
This contains the following sample serialization data:
CA_identification_number = 0xBC614E
manufacturer_id = 0x4F
model_type = 0x31
hardware_version = 0x01.
The file was created using a HEX editor and contains the following 7 bytes:
0x00 0xBC 0x61 0x4E 0x4F 0x31 0x01

Once flashed, EPG shows it as "0383999005 E".


############################################################
## si-box
############################################################
# so how about trun on diag debug on a specific file of a component but not a whole component?
# put the below at the beginning of c file. work?

/home/NDS-UK/parkkt/cc/parkkt_BSKYB_GM_002/vobs/CMS_SYSTEM_INFRASTRUCTURE/DIAG/inc/config/diag_master_config.xml


#-----------------------------------------------------------
# build_scripts
#-----------------------------------------------------------
./release_darwin_platform.sh --platform ams-drx780  --variant debug --profile sky_trials --clean --output $PWD
	./build_mw_epg.sh ${CMD_LINE}
		make.sh
	./make_image.sh ${CMD_LINE}

	
#-----------------------------------------------------------
# build-variants (from hudson)
#-----------------------------------------------------------
./release_darwin_platform.sh --platform ams-drx890 --project picasso --variant debug --clean --output ... --profile nds_si_devel
./release_darwin_platform.sh --platform ams-drx890 --project picasso --variant prod --clean --output ... --profile sky_prod
./release_darwin_platform.sh --platform ams-drx890 --project picasso --variant debug --clean --output ... --profile sky_trials
./release_darwin_platform.sh --platform ams-drx890 --project picasso --variant prod --clean --output ... --profile sky_tpt

# cust trial build from hudson. cartool is yes by default
./release_darwin_platform.sh --cartool no --output $PWD --profile cust_trials --variant preprod --platform ams-drx890 --project picasso --clean
./release_darwin_platform.sh --cartool no --output $PWD --profile sky_trials --variant debug --platform ams-drx890 --project picasso  --clean  


#-----------------------------------------------------------
# make_processes
#-----------------------------------------------------------
(vobs\BUILD_SYSTEM\COMMON_MAKEFILES\process.mk)

# (from platform.mk)
# The following commands are used outside of this file.  Hence, the variable names do not
# contain "LOCAL_"
PLATFORM_STRIP := $(COMPILER_ROOT)/bin/$(MIPS)-linux-uclibc-strip


ifeq (YES,$(NDS_STRIP_PROCESS))
define LOCAL_PROCESS_STRIP_PROCESS
	$(COMMANDS_MKDIR) $(NDS_BUILD_ROOT)/$(NDS_PLATFORM)/$(NDS_PLATFORM_ENDIAN)/unstripped_processes
	$(COMMANDS_CP) $@ $(NDS_BUILD_ROOT)/$(NDS_PLATFORM)/$(NDS_PLATFORM_ENDIAN)/unstripped_processes/$(notdir $@)
    @echo Removing debug information from $@
	$(PLATFORM_STRIP) $@
endef
else
define LOCAL_PROCESS_STRIP_PROCESS
	$(COMMANDS_MKDIR) $(NDS_BUILD_ROOT)/$(NDS_PLATFORM)/$(NDS_PLATFORM_ENDIAN)/unstripped_processes
	$(COMMANDS_CP) $@ $(NDS_BUILD_ROOT)/$(NDS_PLATFORM)/$(NDS_PLATFORM_ENDIAN)/unstripped_processes/$(notdir $@)
endef
endif


Removing debug information from 
/data/home/NDS-UK/parkkt/cc/parkkt_BSKYB_GM_002/vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/
picasso/AMS_BCM_MIPS4K_LNUX_DARWIN_01/BigEndian/release_dbg/components/../processes/APP_Process

define LOCAL_PROCESS_COPY_TO_FILESYSTEM
   @echo Copying $@ to file system
   @echo "-be---------------------------"
   @echo "$(COMMANDS_CP) $(CP_OPTIONS) $@ $(NDS_BUILD_ROOT)/$(NDS_PLATFORM)/$(NDS_PLATFORM_ENDIAN)/fs/NDS/bin/$(notdir $@)"
   ls -al $(NDS_BUILD_ROOT)/$(NDS_PLATFORM)/$(NDS_PLATFORM_ENDIAN)/fs/NDS/bin
   @echo "-af---------------------------"
   $(COMMANDS_CP) $(CP_OPTIONS) $@ $(NDS_BUILD_ROOT)/$(NDS_PLATFORM)/$(NDS_PLATFORM_ENDIAN)/fs/NDS/bin/$(notdir $@)
   ls -al $(NDS_BUILD_ROOT)/$(NDS_PLATFORM)/$(NDS_PLATFORM_ENDIAN)/fs/NDS/bin
   @echo "------------------------------"
endef

Copying /data/home/NDS-UK/parkkt/cc/parkkt_BSKYB_GM_002/vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/picasso/AMS_BCM_MIPS4K_LNUX_DARWIN_01/BigEndian/release_dbg/components/../processes/APP_Process to file system
-be---------------------------
cp -bRL /data/home/NDS-UK/parkkt/cc/parkkt_BSKYB_GM_002/vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/picasso/AMS_BCM_MIPS4K_LNUX_DARWIN_01/BigEndian/release_dbg/components/../processes/APP_Process /data/home/NDS-UK/parkkt/cc/parkkt_BSKYB_GM_002/vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/picasso/AMS_BCM_MIPS4K_LNUX_DARWIN_01/BigEndian/fs/NDS/bin/APP_Process
total 8
drwxr-xr-x 2 parkkt ccusers 4096 Oct 20 13:47 .
drwxr-xr-x 4 parkkt ccusers 4096 Oct 20 13:47 ..
-af---------------------------
total 12164
drwxr-xr-x 2 parkkt ccusers     4096 Oct 20 13:47 .
drwxr-xr-x 4 parkkt ccusers     4096 Oct 20 13:47 ..
-rwxr-xr-x 1 parkkt ccusers 12428348 Oct 20 13:47 APP_Process
------------------------------


Copying /data/home/NDS-UK/parkkt/cc/parkkt_BSKYB_GM_002/vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/picasso/AMS_BCM_MIPS4K_LNUX_DARWIN_01/BigEndian/release_dbg/components/../processes/APP_Process to file system
-be---------------------------
cp -bRL /data/home/NDS-UK/parkkt/cc/parkkt_BSKYB_GM_002/vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/picasso/AMS_BCM_MIPS4K_LNUX_DARWIN_01/BigEndian/release_dbg/components/../processes/APP_Process /data/home/NDS-UK/parkkt/cc/parkkt_BSKYB_GM_002/vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/picasso/AMS_BCM_MIPS4K_LNUX_DARWIN_01/BigEndian/fs/NDS/bin/APP_Process
total 28272
drwxr-xr-x 2 parkkt ccusers     4096 Oct 20 13:50 .
drwxr-xr-x 5 parkkt ccusers     4096 Oct 20 13:50 ..
-rwxr-xr-x 1 parkkt ccusers 12428348 Oct 20 13:47 APP_Process
-rwxr-xr-x 1 parkkt ccusers  2235508 Oct 20 13:50 CA_Process
-rwxr-xr-x 1 parkkt ccusers 12622740 Oct 20 13:50 MW_Process
-rwxr-xr-x 1 parkkt ccusers  1608284 Oct 20 13:47 SCD_Process
-af---------------------------
total 40428
drwxr-xr-x 2 parkkt ccusers     4096 Oct 20 13:52 .
drwxr-xr-x 5 parkkt ccusers     4096 Oct 20 13:50 ..
-rwxr-xr-x 1 parkkt ccusers 12428428 Oct 20 13:52 APP_Process
-rwxr-xr-x 1 parkkt ccusers 12428348 Oct 20 13:47 APP_Process~
-rwxr-xr-x 1 parkkt ccusers  2235508 Oct 20 13:50 CA_Process
-rwxr-xr-x 1 parkkt ccusers 12622740 Oct 20 13:50 MW_Process
-rwxr-xr-x 1 parkkt ccusers  1608284 Oct 20 13:47 SCD_Process
------------------------------


#-----------------------------------------------------------
# build-extra-libs
#-----------------------------------------------------------
# don't know how this script gets run during the build.
#
# vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/picasso/AMS_BCM_MIPS4K_LNUX_DARWIN_01/BigEndian/copy_drivers.sh

FUSIONOS_2/BLD_AMS_BCM_MIPS4K_LNUX_DARWIN_01/platform_cfg/linux/BigEndian/release/Modules/cdi-drivers-ams-drx890-debug.tar.bz2
FUSIONOS_2/BLD_AMS_BCM_MIPS4K_LNUX_DARWIN_01/platform_cfg/linux/BigEndian/release/Scripts/jhmknods_nds.sh
FUSIONOS_2/BLD_AMS_BCM_MIPS4K_LNUX_DARWIN_01/platform_cfg/linux/BigEndian/release/Scripts/supershell
FUSIONOS_2/BLD_AMS_BCM_MIPS4K_LNUX_DARWIN_01/platform_cfg/linux/BigEndian/release/Scripts/libforcesched.so
FUSIONOS_2/BLD_AMS_BCM_MIPS4K_LNUX_DARWIN_01/platform_cfg/linux/BigEndian/release/Scripts/libmutex-desched.so
FUSIONOS_2/BLD_AMS_BCM_MIPS4K_LNUX_DARWIN_01/platform_cfg/linux/BigEndian/debug/BootImage/vmlinux
FUSIONOS_2/BLD_AMS_BCM_MIPS4K_LNUX_DARWIN_01/platform_cfg/linux/BigEndian/release/lib/mhxnvramfs.ko
FUSIONOS_2/BLD_AMS_BCM_MIPS4K_LNUX_DARWIN_01/platform_cfg/linux/BigEndian/release/lib/xtvfs.ko
FUSIONOS_2/BLD_AMS_BCM_MIPS4K_LNUX_DARWIN_01/platform_cfg/linux/BigEndian/release/lib/xtvfs_format
FUSIONOS_2/BLD_AMS_BCM_MIPS4K_LNUX_DARWIN_01/platform_cfg/linux/compiler/mips4k_gcc_x86_linux_hound/mips-linux-uclibc/lib/libgcc_s.so
FUSIONOS_2/BLD_AMS_BCM_MIPS4K_LNUX_DARWIN_01/platform_cfg/linux/BigEndian/release/Scripts/wipe_nvram


############################################################
## CFE-OTV
############################################################

#-----------------------------------------------------------
# from-otv-to-cfe (from http://hoover.uk.nds.com/fusionmadesimple/index.php/RunGaudi)
#-----------------------------------------------------------
# copy it onto usb stick
\\ukstore4.UK.NDS.COM\Data2\SystemsIntegration\Tools\BCM studio\ams890\cfe\cfe_be_bseck_v2.9_svn451.bin

# rename it to 'bootload.fla'
# Place it under root directory of USB.
# Plug it to STB and reboot.
# wait for around 2 minutes, till blue LEDs stop rotating / glowing.
# unplug USB and reboot the box 

# cfe version
BCM97335B0 CFE v2.9, CFE core v2.5, SVN $Rev: 451 $, Endian Mode: Big
Build Date: Tue Aug  4 18:08:48 GMTDT 2009 (MorelAnt@BRWLT0109457)
Copyright (C) Broadcom Corporation.

#-----------------------------------------------------------
# from-cfe-to-otv (from http://hoover.uk.nds.com/fusionmadesimple/index.php/RunGaudi)
#-----------------------------------------------------------
# copy it onto linux server
\\ukstore4.UK.NDS.COM\Data2\SystemsIntegration\Tools\BCM studio\ams890\opentv\bl_eng_signed_00_09.bin

# from cfe
ifconfig eth0 -auto

# pc 
flash -noheader 172.18.200.140:/bl_eng_signed_00_09.bin flash0.cfe

# ukstbuild02
flash -noheader 172.18.253.143:/parkkt/890/bl_eng_signed_00_09.bin flash0.cfe



############################################################
## DICT
############################################################

#-----------------------------------------------------------
# dict-make
#-----------------------------------------------------------
# STEP-01: extract possible dict entries from successful logs. If possible, make sure using right diag.ctl for shortened diag
# output messages.
egrep -an -A 100 --colour=always | less -r

egrep -an --colour=always "(magnum|AFFIRM|HALT|Segmentation Fault|Runtime.exit|MEMMAN)"
egrep -an --colour=always "(AFFIRM|HALT|Segmentation Fault|Runtime.exit)"
egrep -an --colour=always "(AFFIRM|HALT|Segmentation Fault|Runtime.exit|MEMMAN)"
egrep -an --colour=always "(magnum)"
egrep -an "(\!ERROR|\!FATAL|\!WARN|magnum)"
egrep -an "(\!ERROR|\!FATAL|\!WARN|KEY_PRESS)"

# to see starting time from hudson log
egrep -an -A 1 --colour=always "(Starting test)"

egrep -an "SIM_SDT_ACQUISITION_Start\(0x00000000\)"
egrep -a "(-G_Sess|-SQ|-SFM|-J_GUIDE|AFFIRM|HALT)"
egrep -a "[^(G_Sess|SQ|SFM)]"
egrep -a "^[^\+]" ext.ext.log > ext.ext.ext.log
egrep -a '(magnum|cdi|callisto|cal_)' LOG-VI.log > input.dic


egrep -an '_FUNCTION_' LOGlast | grep --colour=always 'took' | cut -f 4 -d']' | cut -f 3 -d' ' | more

# cut
egrep estimated MEM574.TXT | cut -f 4 -d' ' | cut -f 1 -d'/' > memout.txt

# to rid time info in a hudson log
sed 's/^\[.*\]\s//' dic-at01-pass-hudson.dic > dic-at01-pass-hudson.out

# STEP-02: examine if there are any corrupted lines in the extracted via step one.

#
# STEP-03: remove duplicates using 'sort' command depending on diag output format as below.
#
NDS: ^0946684946.752246 !ERROR -aem          < M:aem_list.c F:AEM_ListGetApplicationByInviteHandle L:01808 > Can't find it in the ap
-1-- ----------2------- ---3-- -4--         -5 ------6----- -------------------7------------------ ---8--- 9 -10--

sort -u -k 4,10 ndsfusion.test > ndsfusion.dic 

NDS: ^0946684843.171913 !WARN  -MEMMAN       < p:0000008b t:01063b50 T:SIM_LCC_THREAD M:memman_pinit.c F:PoolCreate L:00316 > Memory 
-1-- ----------2------- ---3-- -4--         -5 ------6--- ----7----- ------8--------- -----9---------- -----10----- --11--- 12 -13-- 

sort -u -k 4,13 ndsfusion.test > ndsfusion.dic 

# STEP-04: run 'deldup.py input.dic main.dic' which will make 'input.dic.uniq'. this output file shows unique entries or duplicates.
#

# STEP-05: extract unique entries from 'input.dic.uniq' and add them into the 'main.dic' as follows
#
egrep '^[^#]' input.dic.uniq >> main.dic
sort -u -k 4,14 main.dic

# use this as don't use free string after '>'
sort -u -k 4,7 main.dic


# for use temp dic
ndsmatch-two dict log

# for use fusion.dic
ndsmatch log

############################################################
## FUSION
############################################################

# ! this is 'stripped/picasso-skelmir_ocap-djpa-zapper_strip_optim.jar'. that is 'stripped' release.
#
#
# once building done, use 'build output' directly as below
#
# mount -t nfs 172.18.253.143:/home/NDS-UK/parkkt/cc/parkkt_BSKYB_HZ001_01/vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/picasso/DARWIN_SKYDRX595_BCM97350_LNUX_01/BigEndian /host
#
# [parkkt@ukstbuild02 build]$ ls picasso/DARWIN_SKYDRX595_BCM97350_LNUX_01/BigEndian/
# bootscript       engines                          mw-epg-ams-drx595-debug-nds_si_devel.tar.bz2  unified_startup.sh
# components       fs                               netcat.py                                     unified_stop7401.sh
# config           get_APP_Process_link_options.mk  picasso_sublibraries_options.mk               unified_stop.sh
# copy_drivers.sh  get_CA_Process_link_options.mk   processes                                     unstripped_processes
# dms              get_MW_Process_link_options.mk   run
# drivers          get_SCD_Process_link_options.mk  unified_startup_7401c1.sh
# 
# then use 'unifiled_startup.sh'
#
# =================================
# 2) case 'picasso_flash_H1.sh'
# =================================
# ./picasso_flash_H1.sh -b ams_drx595 -p stripped_optim -s nds
# ./picasso_flash_H1.sh -b ams_drx595 -p debug
# (-s nds is default)
# 
# - there are *five* picasso files used by '-p' option: 'debug', 'full', 'obfuscated', 'stripped' and 'stripped_optim'.
# - copy jar file depending on '-p' from:
#   vobs/THIRD_PARTY_LIBRARIES/BSKYB_JTH/build/applications/Picasso/picasso/Picasso/dist/release/STB/
#   	debug  full  obfuscated  stripped
#
#   to:
#   vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/picasso/DARWIN_SKYDRX595_BCM97350_LNUX_01/BigEndian/fs/NDS/lib/
#   	picasso.jar
#
#   !Note: the script will rename it to 'picasso.jar'
#
# - run $BUILDHOME/tools/misc/genflash.sh
#
#    For example:
#    OUT_DIR_GAUDI= 
#    /data/home/NDS-UK/parkkt/cc/parkkt_BSKYB_GM_001/vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/picasso/AMS_BCM_MIPS4K_LNUX_DARWIN_01/BigEndian
# -- genflash: create tmp_flash0 and cd to it. e.g. ../build/tmp_flash0
# -- genflash: create /tmp_flash0/fs/NDS, drivers and scripts
# -- genflash: cp $BUILDHOME/tools/release/startstack.sh to /tmp/$USER/flash0/scripts
# -- genflash: cp $VERBOSE $BOOTSCRIPT_LOC .
# -- genflash: cp $VERBOSE ${OUT_DIR_GAUDI}/nvram.bin ./
# -- genflash: cp $VERBOSE -a ${OUT_DIR_GAUDI}/fs/NDS/* ./fs/NDS/ 	# will copy stripped images as these are different from unstripped_processes/
# -- genflash: cp $VERBOSE ${OUT_DIR_GAUDI}/drivers/* ./drivers/
# -- genflash: cp $VERBOSE ${OUT_DIR_GAUDI}/unified_startup.sh ./scripts/
# -- genflash: echo >./scripts/this_is_first_boot
# -- genflash: echo >./this_is_${PLATFORM}_install
# -- genflash: make 'stripped' mw image  # Q: run stip command again on already stripped images?
# -- genflash: tar czf flash0.tar.gz flash0 unstripped_bin  
# -- genflash: cp flash0.tar.gz to $BUILDHOME
# -- genflash: rm /tmp/$USER/flash0
#
# - untar flash0.tar.gz to 'vobs/flash0'
#
# - mount -t nfs 172.18.253.143:/home/NDS-UK/parkkt/cc/parkkt_BSKYB_HZ001_01/vobs/flash0 /flash0
# - run 'startstack.sh' in /flash0/scripts


# tail
script -c "telnet 172.18.201.54" `date +%Y-%m-%d-%k-%M`.log
tail -f /mnt/nds/dev_5/part_0/FSN_DATA/LOG

mkdir /mnt/temp
mount -t nfs 172.18.253.143:/home/NDS-UK/parkkt/fob/890/24206 /mnt/temp
cp /mnt/nds/dev_5/part_0/FSN_DATA/LOG /mnt/temp/
chmod 777 /mnt/temp/LOG 

#-----------------------------------------------------------
# fusion-nvram
#-----------------------------------------------------------
# Once system loaded, done ls on nvramfs:
-rwxrwxrwx    1 root     root          112 Jan  1  1970 99
-rwxrwxrwx    1 root     root          467 Jan  1  1970 dt
-rwxrwxrwx    1 root     root            0 Jan  1  1970 f0
-rwxrwxrwx    1 root     root           27 Jan  1  1970 fv
-rwxrwxrwx    1 root     root            0 Jan  1  1970 lc
-rwxrwxrwx    1 root     root          959 Jan  1  1970 mp
-rwxrwxrwx    1 root     root          670 Jan  1  1970 nv

hexdump -C nv


#-----------------------------------------------------------
# fusion-flash
#-----------------------------------------------------------
# flash0.tar.gz (made from 'release_flash0.sh' command)
# copy and untar it to mount point, e.g., ~/fob/nfsmnt/. this will have:
# note that '/flash0' is the mount point to /host in the box and this is pre-defined and will be used in 'startstack.sh'.
.
|-- flash0 (** this is mount point **)
(780 case)
|   |-- bootscript
|   |-- drivers
|   |   |-- cdi-drivers-ams-drx780-debug.tar.bz2
|   |   |-- cdi_tracker.so
|   |   |-- cnxt_base_drv.ko
|   |   |-- cnxt_cdi.ko
|   |   |-- cnxt_kernel_kal.ko
|   |   |-- dms_delete_partitions.sh
|   |   |-- kernel
|   |   |-- libforcesched.so
|   |   |-- libgcc_s.so
|   |   |-- mhxnvramfs.ko
|   |   |-- restricted_setmod_cnxt_cdi_insmod.sh
|   |   |-- rootfs.arm.squashfs
|   |   |-- setmod_cnxt_cdi_insmod.sh
|   |   |-- unified_startup.sh
|   |   |-- unified_startup.sh~
|   |   |-- unified_stop.sh
|   |   |-- unified_stop.sh~
|   |   |-- wipe_nvram
|   |   |-- xtvfs.ko
|   |   `-- xtvfs_format

(890 case)
|   |-- bootscript
|   |-- drivers
|   |   |-- cdi-drivers-ams-drx890-debug.tar.bz2
|   |   |-- jhmknods_nds.sh
|   |   |-- kernel
|   |   |-- libforcesched.so
|   |   |-- libgcc_s.so
|   |   |-- libmutex-desched.so
|   |   |-- mhxnvramfs.ko
|   |   |-- supershell
|   |   |-- unified_startup.sh
|   |   |-- unified_stop.sh
|   |   |-- xtvfs.ko
|   |   `-- xtvfs_format

|   |-- fs
|   |   `-- NDS
|   |       |-- bin
|   |       |   |-- APP_Process
|   |       |   |-- CA_Process
|   |       |   |-- MW_Process
|   |       |   |-- SCD_Process
|   |       |   |-- xtvfs_format
|   |       |-- config
|   |       |   |-- MS.CFG
|   |       |   |-- diag.cfg
|   |       |   |-- diagctl.cfg
|   |       |   |-- ...
|   |       |   `-- words.eng
|   |       `-- etc
|   |           `-- sysinit.cfg
|   |-- scripts
|   |   |-- startstack.sh
|   |   `-- unified_startup.sh
|   `-- this_is_ams_nxp_install

`-- unstripped_bin
    |-- APP_Process
    |-- CA_Process
    |-- MW_Process
    |-- SCD_Process
    |-- xtvfs_format
    `-- xtvfs_format~


# nfs on ukstbuild02
# mkdir /flash0
# mount -t nfs 172.18.253.143:/home/NDS-UK/parkkt/fob/890/nfs/flash0 /flash0
# run
#./flash0/scripts/startstack.sh



############################################################
## DIAG and TRACKER
############################################################

#-----------------------------------------------------------
# diag-mesg
#-----------------------------------------------------------

# FRAME_PRESENTED
#
!MIL   -MPM          < T:MPM_PROXYMONITOR_THREAD M:mpm_component_video.c F:MPMComponentVideoFramePresentedHandler L:00652 > FRAME_PRESENTED: hMC=6

# FRAME_DECODED
#
!INFO  -MPM          < T:MPM_ITCMAIN_THREAD M:mpm_pres_video_control.c F:MPM_PresHandleVideoDecoderBufferLowEvent L:01577 > FRAME_DECODED on decoder 0

# TransponderId
#
!MIL   -UAMC         < p:00000076 t:00b1a6c0 T:PLAYER_MAIN M:live_pbag.c F:Live_Pbag_Print L:00980 > UAM LIVE EVENT PROGRAM_OPEN
!MIL   -UAMC         < p:00000076 t:00b1a6c0 T:PLAYER_MAIN M:live_pbag.c F:Live_Pbag_Print L:00985 > Live params: NetworkId=0x00000002, TransponderId=0x000007F9 ServiceId=0x000023FB

OR

!MIL   -UAMC         < p:00000076 t:00b1a6c0 T:PLAYER_MAIN M:live_pbag.c F:Live_Pbag_Print L:00984 > UAM_DCM_PARAM_DATA_TYPE_PROGRAM_OFF
!MIL   -UAMC         < p:00000076 t:00b1a6c0 T:PLAYER_MAIN M:live_pbag.c F:Live_Pbag_Print L:00985 > Live params: NetworkId=0x00000002, TransponderId=0x000007F9 ServiceId=0x000023FB


# KEY_PRESS
#
!MIL   -aem          < p:00000076 t:00c47b40 T:AEM_INPUT_MONITOR_THREAD M:aem_userinput.c F:AEM_InputMonitorThread L:00429 > KEY_PRESS: code=0xe007

# DECODER_STARTED and DECODER_STOPPED:
#
!MIL   -MPM          < T:MPM_ITCMAIN_THREAD M:mpm_component_video.c F:MPMComponentVideoStop L:00526 > DECODER_STOPPED: hMC=4
!MIL   -MPM          < p:00000075 t:009d50a0 T:MPM_ITCMAIN_THREAD M:mpm_component_video.c F:MPMComponentVideoStart L:00440 > DECODER_STARTED: hMC=30
!MIL   -MPM          < p:00000075 t:009d50a0 T:MPM_ITCMAIN_THREAD M:mpm_component_audio.c F:MPMComponentAudioStart L:00392 > DECODER_STARTED: hMC=30


# CHANNEL UP
ioctl VIDEO_DECODER_STOP
ioctl DEMUX_STOP posted OK on /dev/nds/demux0/elementaryfilter
ioctl VIDEO_DECODER_FLUSH_RATE_BUFFER
ioctl DEMUX_STOP posted OK on /dev/nds/demux1/remux0

# remove pids: 0(video), 1(audio)
!INFO  -MPM          < T:MPM_ITCMAIN_THREAD M:mpm_demux.c F:MPMDemuxInvalidateTPid L:01455 > Invalidated tpid for component 0
!INFO  -MPM          < T:MPM_ITCMAIN_THREAD M:mpm_demux.c F:MPMDemuxInvalidateTPid L:01455 > Invalidated tpid for component 1

# remove tipd of remux, do 4 times in total.
ioctl DEMUX_REMUX_REMOVE_TPID posted OK on /dev/nds/demux1/remux0

# change pids:
# 0x04, SYSTEMOBJECT_ESI_STREAM_TYPE_MPEG_2_VIDEO
!INFO  -MPM          < T:MPM_ITCMAIN_THREAD M:mpm_media_connection.c F:MPM_MCProcessESIObject L:01037 > Got ESI object of type 0x4 tpid 0xd00
# 0x02, SYSTEMOBJECT_ESI_STREAM_TYPE_MPEG_2_AUDIO
!INFO  -MPM          < T:MPM_ITCMAIN_THREAD M:mpm_media_connection.c F:MPM_MCProcessESIObject L:01037 > Got ESI object of type 0x2 tpid 0xd01
# 0x0a, SYSTEMOBJECT_ESI_STREAM_TYPE_TELETEXT
!INFO  -MPM          < T:MPM_ITCMAIN_THREAD M:mpm_media_connection.c F:MPM_MCProcessESIObject L:01037 > Got ESI object of type 0xa tpid 0x91d
!INFO  -MPM          < T:MPM_ITCMAIN_THREAD M:mpm_media_connection.c F:MPM_MCProcessESIObject L:01037 > Got ESI object of type 0xa tpid 0x91d
# 0x0d, SYSTEMOBJECT_ESI_STREAM_TYPE_OTV_CAROUSEL
!INFO  -MPM          < T:MPM_ITCMAIN_THREAD M:mpm_media_connection.c F:MPM_MCProcessESIObject L:01037 > Got ESI object of type 0xd tpid 0x901

# 
ioctl DEMUX_ATTACH_TPIDFILTER posted OK on /dev/nds/demux0/elementaryfilter



[DEFAULT_VALUES]
# Default trace level for components which do not call DIAG_LOG_SetTraceSettings
# The format is the same as in diag_cli:
#
# F Fatal , E Error , W Warning , I Info , P Paramaters
# R Return , ! Event , < Function entry , > Function exit
 
TRACE_LEVEL="WEF"
 
# Default trace format for components which do not call DIAG_LOG_FormatTraceSettings
# The available patterns are:
#
#  %p : process identifier (hexadecimal format)
#  %t : thread identifier (hexadecimal format)
#  %m : source file name (string is truncated after 16 characters)
#  %f : function name
#  %l : source line number (decimal number)

# (from source)
# /* Source filename */
# case 'm': 
# /* Module name */
# case 'x':
# /* Function name */
# case 'f':
# /* Thread name */
# case 'T':    
# /* Process name */
# case 'P':    
# /* Line number */
# case 'l':
# /* Thread ID */                                        
# case 't':
# /* Process ID */
# case 'p':


TRACE_FORMAT= " %p %t %m %f %l "

[OVERRIDDEN_VALUES]
# it is possible to force all segments to use the same trace format by specifying the parameter TRACE_FORMAT_FOR_ALL.
# Force a trace format for all segments This format will be applied in all cases

TRACE_FORMAT_FOR_ALL=" %p %t %m %f %l "

# Specific trace level per segment. 
#
# In all cases (i.e. whether the segment called SetTracesSettings or not), 
# the segments specified below will use the overrided trace value.
#
# For example TRACE_LEVEL_cmp1 = "FEW" will force cmp1 to only output 
# FATAL, ERROR and WARN traces at startup
TRACE_LEVEL_APPLE = "PIE"
TRACE_LEVEL_SPOUSE = "WIFE"

# values
A            : ?
F            : Fatal
E            : Error
W            : Warning
M            : Milestone
I            : Information
P            : Parameters
!            : Events
<          : Function exit(&gt;)
>          : Function entry(&lt;)

#-----------------------------------------------------------
# diag-tip
#-----------------------------------------------------------

(first)
# so how about trun on diag debug on a specific file of a component but not a whole component?
# put the below at the beginning of c file. work?

#define DEBUG
#undef DIAG_RELEASE_DBG
#define DIAG_DEBUG
#define SPM_SVR_DIAG_LOG_INFO SPM_SVR_DIAG_LOG_MIL

(second)
# tips for quick diag mesg
Please could you capture a log with the INFO logs from sim_dbc_query_list.c enabled. Unless you’re running a full debug build, the easiest way I know to do this is to put a line such as the following just below the other #defines in that file:
#define SIM_TB_LOG_INFO SIM_TB_LOG_WARN


#-----------------------------------------------------------
# diag-cli
#-----------------------------------------------------------
iptables -F


#-----------------------------------------------------------
# cdi-tracker
#-----------------------------------------------------------
# there is pre-built cdi_tracker.so(clinet) in output_del.
#

# view
/view/parkkt_CDI_TRACKER_MAIN_01/vobs/FUSIONOS_3/CDI_TRACKER/build

# make
make NDS_PLATFORM=AMS_NXP_ARM9_LNUX_DARWIN_03 NDS_BUILD_ROOT=/tmp/cdi_tracker NDS_PROJECT=fusionos_cdi_tracker NDS_ENDIAN=LittleEndian

# make (ams890, bcm7335)
make NDS_PLATFORM=AMS_BCM_MIPS4K_LNUX_DARWIN_01 NDS_BUILD_ROOT=/tmp/cdi_tracker NDS_PROJECT=fusionos_cdi_tracker NDS_ENDIAN=BigEndian

# output
ls /tmp/cdi_tracker/AMS_NXP_ARM9_LNUX_DARWIN_03/LittleEndian/components/helper_libraries/cdi_tracker/lib/debug/

# from CC? does it work?
cc/parkkt_BSKYB_HR004_001/vobs/FUSIONOS_OUTPUT_DEL_2/KERN_AMS_BCM_MIPS4K_LNUX_DARWIN_01/BigEndian/debug/debug/lib

[parkkt@ukstbuild02 lib]$ ll
total 3040
drwxr-xr-x 2 parkkt ccusers   4096 Nov 23 11:23 ./
drwxr-xr-x 5 parkkt ccusers   4096 Nov 23 10:38 ../
-r-xr-xr-x 1 parkkt ccusers 532223 Nov 23 11:23 cdi_tracker.so*
-r--r--r-- 1 parkkt ccusers 476088 Nov 23 11:23 libnetwork_helper_api.a
-r--r--r-- 1 parkkt ccusers  10874 Nov 23 11:23 libnetwork_osi_utilities_api.a
-r--r--r-- 1 parkkt ccusers  56104 Nov 23 11:23 libserial_helper.a
-r--r--r-- 1 parkkt ccusers 429804 Nov 23 11:23 libstorage_helper_api.a
-r--r--r-- 1 parkkt ccusers  70574 Nov 23 11:23 libstorage_osi_utilities_api.a
-r--r--r-- 1 parkkt ccusers  69874 Nov 23 11:23 mhxnvramfs.ko
-r-xr-xr-x 1 parkkt ccusers 495472 Nov 23 11:23 xtvfs_format*
-r--r--r-- 1 parkkt ccusers 914399 Nov 23 11:23 xtvfs.ko


# run
#-----------------------------------------------------------

# run tracker server which is phyton script on linux server. 
# ensure that the server is started before starting up the STB and calls should automatically be logged.
# or use ezlog

./cdit_server <log destination>
./cdit_server cdi.log

# client side:
# ensure that following file in 'flash0/scripts/unified_startup.sh' is vaild to use cdi_tracker
# cdi tracker library must be always first in LD_PRELOAD line.
# echo "LD_PRELOAD=/NDS/lib/cdi_tracker.so:/NDS/lib/libforcesched.so:/lib/libresolv-refresh.so:/lib/libifnameindex.so /NDS
# /bin/SCD_Process" >> run.sh

#
    else
        echo "Info : Running without GDB"
		echo "Info : Copying cdi_traker"
		cp $host_root/drivers/cdit_bcm7335_be_1.0.23.so /usr/lib
		echo "Info : Loading cdi_traker"
		export CDIT_SERVER="172.18.253.143"
		echo "LD_PRELOAD=/usr/lib/cdit_bcm7335_be_1.0.23.so:/usr/lib/libforcesched.so:/lib/libresolv-refresh.so:/lib/libifnameindex.so:/usr/lib/libmutex-desched.so  /NDS/bin/SCD_Process" >> run.sh
        if [ "$WITH_CDI_TRACKER" = "1" ]
        then
           echo "LD_PRELOAD=/usr/lib/cdi_tracker.so /NDS/bin/SCD_Process" >> run.sh
        fi
    fi

# output to serial. ukstbuild02(172.18.253.143)
#
mount -t nfs 172.18.253.143:/home/NDS-UK/parkkt/fob/nfsmnt/flash0 /host
export HOME=/host
export CDIT_SERVER="1"
/host/scripts/startstack-tr.sh

# pc ip where ezlog is running
export CDIT_SERVER="172.18.200.140"

# ukstbuild02
export CDIT_SERVER="172.18.253.143"

# when tried to use a tracker, got this error. found that this was because libmutex-desched.so is somehow broken. 
# don't know how this get copied under flash0 but it's different from where it was
# vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/picasso/AMS_BCM_MIPS4K_LNUX_DARWIN_01/BigEndian/drivers
# remove this lib from the LD_PRELOAD and worked fine.
#
/NDS/bin/SCD_Process: can't resolve symbol 'dlinit' in lib '/usr/lib/libmutex-desched.so'

#-----------------------------------------------------------
# tracker-mesg
#-----------------------------------------------------------

videodecoder0
VIDEO_DECODER_SUBSCRIBE_EVENTS

demux0/icam0/descrambler
egrep (videodecoder0|descrambler)

# CLOSE(358="demux0/elementaryfilter")0 {1042 us}
grep -n elementaryfilter log.cdi | grep CLOSE

# userinputremote0
00:15:40:385 [pid=168,tid=13447712] POLL_EXIT(timeout=-1, [fd=124="userinputremote0", revents=POLLIN,] )  = 1
00:15:40:386 [pid=168,tid=13447712] READ(124="userinputremote0", buf=0xcd2b58(06E0010000E00000), size=128) = 4 {30 us}
00:15:40:387 [pid=168,tid=13447712] POLL_START(timeout=350, [fd=124="userinputremote0", events=POLLIN,],[fd=123, events=POLLIN,],)

#define USER_INPUT_KEY_CHANNEL_UP            (0xE006U)
06.E0.01.00.00.E0.00.00 -> 00.00.E0.00.00.01.E0.06


#-----------------------------------------------------------
# IP setting (static)
#-----------------------------------------------------------
172.18.203.92
172.18.203.93
172.18.203.94
172.18.203.95
172.18.203.96

\ eth get_ip

ip 172.18.203.92
subnet 255.255.252.0
gateway 172.18.203.254
mac <mac addr>

# 266 is box num found at the bottom
ip_default 266 

ping 172.18.203.92


#-----------------------------------------------------------
# IP setting from kernel
#-----------------------------------------------------------
ifconfig eth0 up

# not works
ifconfig eth0 172.18.203.92 netmask 255.255.252.0 broadcast 172.18.203.255
route add default gw 172.18.203.255 eth0
udhcpc
ifconfig eth0 hw ether 00:60:6E:00:00:25

# the below works
udhcpc
ifconfig eth0 172.18.203.92

# ukstbuild02
ping 172.18.253.143

############################################################
## key-code
############################################################

#define USER_INPUT_KEY_STANDBY               (0xE000U)
#define USER_INPUT_KEY_SELECT                (0xE001
#define USER_INPUT_KEY_BACK                  (0xE002U)
#define USER_INPUT_KEY_VOLUME_UP             (0xE003U)
#define USER_INPUT_KEY_VOLUME_DOWN           (0xE004U)
#define USER_INPUT_KEY_MUTE                  (0xE005U)
#define USER_INPUT_KEY_CHANNEL_UP            (0xE006, 06E0010000E00000, 
#define USER_INPUT_KEY_CHANNEL_DOWN          (0xE007, 
#define USER_INPUT_KEY_INTERACTIVE           (0xE008U)
#define USER_INPUT_KEY_HELP                  (0xE009U)
#define USER_INPUT_KEY_SERVICES              (0xE00AU)
#define USER_INPUT_KEY_GUIDE                 (0xE00BU)
#define USER_INPUT_KEY_MOSAIC                (0xE00CU)
#define USER_INPUT_KEY_CANCEL                (0xE00DU)
#define USER_INPUT_KEY_INFO                  (0xE00E, 57358, )
#define USER_INPUT_KEY_TEXT                  (0xE00FU)
#define USER_INPUT_KEY_TV                    (0xE010U)
#define USER_INPUT_KEY_RCH_UNPROGRAMMED      (0xE011U)
#define USER_INPUT_KEY_REMOTE_BATTERY_LOW    (0xE012U)
#define USER_INPUT_KEY_POWER_OFF             (0xE013U)
#define USER_INPUT_KEY_POWER_ON              (0xE014U)
#define USER_INPUT_KEY_UP                    (0xE100U)
#define USER_INPUT_KEY_DOWN                  (0xE101U)
#define USER_INPUT_KEY_LEFT                  (0xE102U)
#define USER_INPUT_KEY_RIGHT                 (0xE103U)
#define USER_INPUT_KEY_RED                   (0xE200, 00E2000000E00000, 
#define USER_INPUT_KEY_GREEN                 (0xE201)
#define USER_INPUT_KEY_YELLOW                (0xE202, , 57858
#define USER_INPUT_KEY_BLUE                  (0xE203U)

#define USER_INPUT_KEY_NUMERIC_ZERO          (0xE300)
#define USER_INPUT_KEY_NUMERIC_ONE           (0xE301)
#define USER_INPUT_KEY_NUMERIC_TWO           (0xE302,
#define USER_INPUT_KEY_NUMERIC_THREE         (0xE303,
#define USER_INPUT_KEY_NUMERIC_FOUR          (0xE304U)
#define USER_INPUT_KEY_NUMERIC_FIVE          (0xE305U)
#define USER_INPUT_KEY_NUMERIC_SIX           (0xE306U)
#define USER_INPUT_KEY_NUMERIC_SEVEN         (0xE307U)
#define USER_INPUT_KEY_NUMERIC_EIGHT         (0xE308U)
#define USER_INPUT_KEY_NUMERIC_NINE          (0xE309U)
#define USER_INPUT_KEY_PLAY                  (0xE400U)
#define USER_INPUT_KEY_PAUSE                 (0xE401U)
#define USER_INPUT_KEY_STOP                  (0xE402U)
#define USER_INPUT_KEY_RECORD                (0xE403U)
#define USER_INPUT_KEY_FORWARD               (0xE404U)
#define USER_INPUT_KEY_FAST_FORWARD          (0xE405U)
#define USER_INPUT_KEY_REVERSE               (0xE406U)
#define USER_INPUT_KEY_FAST_REVERSE          (0xE407U)
#define USER_INPUT_KEY_STEP_FORWARD          (0xE408U)
#define USER_INPUT_KEY_STEP_BACKWARD         (0xE409U)
#define USER_INPUT_KEY_BOX_OFFICE            (0xEF00U)
#define USER_INPUT_KEY_SKY                   (0xEF01U)
#define USER_INPUT_KEY_PRIVATE_002           (0xEF02U)
#define USER_INPUT_KEY_PRIVATE_003           (0xEF03U)
#define USER_INPUT_KEY_PRIVATE_004           (0xEF04U)
#define USER_INPUT_KEY_PRIVATE_005           (0xEF05U)


############################################################
## si-sock
############################################################

BSKYB_GM_Integration:34.32.00:ams-drx890:sky_trials:debug:BSKYB_INTEGRATION_BLD_34.26.00

# hudsonmater1
172.17.53.98


http://hudsonmaster1.uk.nds.com:8080/hudson/
http://hudsonmaster1.uk.nds.com:8082/farmstatus

# stormtest1 
\\172.17.53.1\d$\Picasso\stormtest\internal\soak\Tests
\\172.17.53.1\d$\Picasso\stormtest\internal\soak\Tests\logs\Fri-110527\AT21-900-171132_PORT3

# stormtest2
\\172.17.53.33\d$\Picasso\stormtest\internal\soak\Tests 

# stormtest4
\\172.17.53.129\d$\Picasso\stormtest\internal\soak\Tests 

# console full
Logging into

# look for the below from 'Console Output':
# Storm: All logs stored in \\STORMTEST1\D$\Picasso\stormtest\internal\soak\Tests\logs\Sun-110508\AT3-720-175640_PORT16
All logs stored in logs\Mon-101122\AT1-900-170202_PORT8

command=AT10_ChannelTypes.py stormtest1 14 hudson /export/systemTestFarmBoxes/STORM-01_14 True 900 20
Test FAILED

# http://hoover.uk.nds.com/fusionmadesimple/index.php/GaudiTesting
# AT1: test_script_name <Server> <Slot> <Tester> <mount point> <power cycle> <max run time>
# test=AT1_Channel_UpDown.py %s %s %s %s True 900 129
# echo Usage:AT1_ChannelZap.bat 'redratname' 'number of channel zaps' 'number of milliseconds btw channelzap' 'number of times test to be run'
AT1_ChannelZap.bat KT-RR01 10 9000 20
AT1_ChannelZap.bat KT-RR02 100 9000 360

# 2
AT2_BannerNavigate.bat KT-RR01 50000000000

# 3
AT3_Interactive.bat KT-RR01 5000000000

# 4: Booking, Live Pause, Review Buffer Trick Modes, Playback, Delete
AT4_Trickmode.bat KT-RR01 50000000000

# 6
# AT6_NormalUsuage.bat <redratname> <number of times to run the test> <smart card pin>
AT6_NormalUsuage.bat KT-RR02 10000 8586

# 8
# test=AT8_GuideNavigate.py %s %s %s %s True 900 32
AT8_GuideNavigate.bat KT-RR01 20 10 50000000000

# 10: Viewing and live pause on SD, HD and Radio channels 
AT10_ChannelTypes.bat KT-RR01 50000000000

# 13:
AT13_Banner.bat KT-RR01 50000000000

AT18_TuningConflict.bat KT-RR02 1000

# 21:
AT21_ManEventRec.bat KT-RR01 40 50000000000
AT21_ManEventRec.bat KT-RR02 40 50000000000

# 10: Viewing and live pause on SD, HD and Radio channels 
AT28_DITL.bat KT-RR01 500000

# 24
AT24_FastChannelZap.bat KT-RR01 50000000000
AT24_FastChannelZap.bat KT-RR02 50000000000

# 28
AT28_DITL.bat KT-RR02 50000000000

# 
[si_logs@theyard translation]$ list_log hudson


############################################################
## PYTHON
############################################################
# calc
>>> hex(((25 & 0x3FF) << 22) | ((0x02 & 0x3) << 16) | ((2 & 0xF) << 12) | (1))
'0x6422001'

>>> print "0x%x" % 104996865
0x6422001


############################################################
## LINUX CMDS
############################################################
#
egrep -nr "java.lang.Exception|KEY_PRESS:|ERROR|FATAL|AFFIRM"
grep -nr --include makefile COMPONENT_NAME ./ | more

# -r reverse
# -n numeric
# -k range
sort -r -n -k 25,25 output.ext.log | more

# 
# -n : only print lines specified with the p command or the p flag of the s command.
sed -n 25,75p you-file-here 

# sed '11 q' which quits when the eleventh line is reached.
# the below outputs '25-74' excluding 75th line.
sed -n '75q;25,75p' you-file-here 

#
# | sed 's/^[ \t]*//;s/[ \t]*$//'
#
# (before)
               ALARM_MEMORY_POOL
                 BEM_SERVER_POOL
                CAMM_SERVER_POOL
                     CAPPROC_SVR
                             CTM
                         CTM_SVR

# (after)
ALARM_MEMORY_POOL
BEM_SERVER_POOL
CAMM_SERVER_POOL
CAPPROC_SVR
CTM

# exampe input
#                ALARM_MEMORY_POOL,   28016,   28016,   30720
# remove spaces between columns and ',' as well
#
# output:
# ALARM_MEMORY_POOL 28016 28016 30720
#
| sed 's/ //g' | sed 's/,/ /g'


# sed -n -e '/BEGIN/,/END/p' /my/test/file > needed blocks* 
sed -n -e '/PCAT_VIEW_CLNT_POOL/,/usage/p' MEM117.TXT | more

sed 's/^NDS.*F://' all.out > all-shout.out

while x=0; do echo "----"; grep ADPT_GUIDE /tmp/MPROF122.TXT;grep ADPT_GUIDE /mnt/nds/dev_5/part_0/FSN_DATA/LOG; sleep 60; done

#-----------------------------------------------------------
# klogd
#-----------------------------------------------------------
klogd -c 7

#-----------------------------------------------------------
# LD_LIBRARY_PATH
#-----------------------------------------------------------
export LD_LIBRARY_PATH=./

#-----------------------------------------------------------
# force core dump
#-----------------------------------------------------------
# print a process tree
ps axjf

# print threads info
ps -eLf

# print threads belongs to this PID
ps -p PID -T

# to see the priority of all threads
ps -eL -o pid,ppid,rtprio,cmd


############################################################
## ANSI COLOR PRINT
############################################################

# dark blue
printf("\033[32m CR-1048: NVRAM Retry Byte set to 0xqlX \033[0m \n",nvram_retry_bytes);


############################################################
## UTILS
############################################################
# key presses
# log_convert logfile
# extract key presesses and covert it into redrat scripts


############################################################
## CFE
############################################################
# vmlinux isn't a compressed file, do not use 'boot -z'
vobs/FUSIONOS_OUTPUT_DEL_2/KERN_AMS_BCM_MIPS4K_LNUX_DARWIN_01/BigEndian/debug/release/BootImage/vmlinux

##
macprog2 00-19-FB-1A-2C-2F

##
ifconfig eth0 -auto
100 MB Full-Duplex (auto-neg)
Device eth0:  hwaddr 00-19-FB-1A-2C-2F, ipaddr 172.18.200.200, mask 255.255.252.0
        gateway 172.18.203.254, nameserver 172.18.253.100, domain uk.nds.com
*** command status = 0

##
ping 172.18.253.143

##
ifconfig eth0 -auto; boot -elf 172.18.253.143:/parkkt/890/vmlinux 'mem=128M ip=dhcp console=uart,mmio,0x10400b00,115200n8'
setenv -p STARTUP "ifconfig eth0 -auto;boot -elf 172.18.253.143:/parkkt/890/vmlinux 'mem=128M ip=dhcp console=uart,mmio,0x10400b00,115200n8'"
setenv -p STARTUP " "

############################################################
# look for the below error mesg from the main log, all-tests.log.
=============================[SYSTEM TEST ERROR]================================



############################################################
## DMS
############################################################
DMS_0452.1 - Book PPV event from promo



############################################################
## ca-cards
############################################################
946684917205: PooledExecutor#3: [  EPG_CA:WARN]: CA.stateActive: __________________________________________________________________
946684917205: PooledExecutor#3: [  EPG_CA:WARN]: CA.stateActive: 
946684917205: PooledExecutor#3: [  EPG_CA:WARN]: CA.stateActive: CARD ID: 42705542
946684917205: PooledExecutor#3: [  EPG_CA:WARN]: CA.stateActive: CARD TYPE: 1
946684917205: PooledExecutor#3: [  EPG_CA:WARN]: CA.stateActive: CARD CHECK DIGIT: 1
946684917205: PooledExecutor#3: [  EPG_CA:WARN]: CA.stateActive: SUBSCRIBER ID: 22633364
946684917205: PooledExecutor#3: [  EPG_CA:WARN]: CA.stateActive: CAS ID: 2403
946684917205: PooledExecutor#3: [  EPG_CA:WARN]: CA.stateActive: BOUQUET ID: 4101
946684917205: PooledExecutor#3: [  EPG_CA:WARN]: CA.stateActive: SUB-BOUQUET ID: 1
946684917205: PooledExecutor#3: [  EPG_CA:WARN]: CA.stateActive: COUNTRY CODE: 4670034
946684917205: PooledExecutor#3: [  EPG_CA:WARN]: CA.stateActive: CURRENCY CODE: 1
946684917205: PooledExecutor#3: [  EPG_CA:WARN]: CA.stateActive: ZIP CODE: TW7     
946684917205: PooledExecutor#3: [  EPG_CA:WARN]: CA.stateActive: CARD AUTHORIZED: true
946684917205: PooledExecutor#3: [  EPG_CA:WARN]: CA.stateActive: CARD PAIRED: true
946684917205: PooledExecutor#3: [  EPG_CA:WARN]: CA.stateActive: PVR SUB: true
946684917205: PooledExecutor#3: [  EPG_CA:WARN]: CA.stateActive: BSKYB IPPV ALLOWED: false
946684917205: PooledExecutor#3: [  EPG_CA:WARN]: CA.stateActive: PDL ENTITLEMENT: true
946684917205: PooledExecutor#3: [  EPG_CA:WARN]: CA.stateActive: COMMERCIAL: false
946684917205: PooledExecutor#3: [  EPG_CA:WARN]: CA.stateActive: __________________________________________________________________

############################################################
## sky-contacts
############################################################

# QC?
Kumar, Satish [Satish.Kumar@bskyb.com], 07982024680

# Picasso Dev
Louw, Thorben (Thorben.Louw@bskyb.com, Toby)
Tapper, James [James.Tapper@bskyb.com]
Bayliss, James [mailto:James.Bayliss@bskyb.com] 
O'Regan, Mike
Jim (was NDS colleague)
Lee Miles, 02070324757
McDonnell, Deirdre Sky is 0207 03 24779
#
Nodwell, Charlie

#
Golani, Santosh

#
Robin Davis
Release Support Manager 

#
Ravindranath, Dileep [Dileep.Ravindranath@bskyb.com] 01277208836


############################################################
## si-vim
############################################################
# not working
Fp KEY_PRESS\|VRM_JOB_START

Fp VRM_JOB_START\|TUNER_LOCKED\|hMC=0x304\|hMC=772
s/MCM_MEDIACONN_Run\|VRM_JOB_START\|hMC=0x36

cscope -q -b -R -s/vobs/CMS_INFORMATION_SERVICES -s/vobs/DARWIN_PLATFORM -s/vobs/CMS_MEDIA_SERVICES -s/vobs/CMS_SECURITY_SERVICES -s/vobs/CMS_SYSTEM_INFRASTRUCTURE -s/vobs/CMS_SYSTEM_RESOURCE 

# gtags
cnoreabbrev csa cs add
cnoreabbrev csf cs find
cnoreabbrev csk cs kill
cnoreabbrev csr cs reset
cnoreabbrev css cs show
cnoreabbrev csh cs help
cnoreabbrev csc call setqflist([])

# in vim
:Gtags main


