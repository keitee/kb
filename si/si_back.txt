############################################################
## The Amstrad DRX890 is a Broadcom 7335 based box
## The Amstrad DRX595 is a Broadcom 7350 based box
############################################################


############################################################
## source-insight
############################################################
\\ukstbuild02\parkkt\cc\parkkt_BSKYB_GM_001\vobs\CMS_MEDIA_SERVICES
\\ukstbuild02\parkkt\cc\parkkt_BSKYB_GM_001\vobs\DARWIN_PLATFORM
\\ukstbuild02\parkkt\cc\parkkt_BSKYB_GM_001\vobs\CMS_SYSTEM_RESOURCE\
\\ukstbuild02\parkkt\cc\parkkt_BSKYB_GM_001\vobs\


############################################################
## CC
############################################################

#-----------------------------------------------------------
# cc-note: read before joininig any projects		*:cc-note*
#-----------------------------------------------------------

(from http://hoover.uk.nds.com/fusionmadesimple/index.php/Using_Linux_ClearCase)

Add "alias ct=cleartool" (without the quotes) to your .bashrc file and use ct wherever you see cleartool below. 

Start project explorer

   1. From a linux environment run "clearprojexp&"
   2. Navigate to the appropriate project. E.g: /vobs/FUSION_SYSTEM_INTEGRATION_PROJECTS/BSKYB_SI_PROJECTS/BSKYB_INTEGRATION_MAIN
   3. Right-click and choose "Create Child Stream".
   4. Enter the name of the stream to use and accept defaults; click Next.
   5. Click "Snapshot". Edit "Snapshot View Location" to taste. Click Next. (**)
   6. IMPORTANT! Un-check "Load the development view now". We will do this later. Click Finish. (****)
   7. Confirm: Click Continue. 

Editing Load Rules

   1. From inside your snapshot view folder run "cleartool edcs"
   2. Navigate to the bottom line where it reads: 

#UCMCustomLoadBegin - DO NOT REMOVE - ADD CUSTOM LOAD RULES AFTER THIS LINE

   1. Add your load rules below this line, save and exit
   2. A box "Set config spec?" appears. Click "yes". A box "Continue, and unload these objects?" appears. Click "yes".
   3. The view will now be populated with files. Go and have a coffee. 


#-----------------------------------------------------------
# cc-rule-890
#-----------------------------------------------------------
VOB:
FUSION_SYSTEM_INTEGRATION_PROJECTS/BSKYB_SI_PROJECTS/BSKYB_GM/BSKYB_GM_Integration

Load Rules:
load /vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build
load /vobs/FUSIONOS_2/BLD_AMS_BCM_MIPS4K_LNUX_DARWIN_01/platform_cfg/linux
load /vobs/FUSIONOS_INPUT_DEL_2/DEL_AMS_BCM_MIPS4K_LNUX_DARWIN_01/Tarball
load /vobs/FUSIONOS_INPUT_DEL_2/DEL_AMS_BCM_MIPS4K_LNUX_DARWIN_01/build_platform
load /vobs/FUSIONOS_OUTPUT_DEL_2/KERN_AMS_BCM_MIPS4K_LNUX_DARWIN_01


#-----------------------------------------------------------
# cc-rule-595
#-----------------------------------------------------------
#VOB:
#FUSION_SYSTEM_INTEGRATION_PROJECTS/BSKYB_SI_PROJECTS/BSKYB_BRANCNES/BSKYB_HZ001
#
#load /vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build
#load /vobs/FUSIONOS_5/BLD_DARWIN_SKYDRX595_BCM97350_LNUX_01/platform_cfg/linux
#load /vobs/FUSIONOS_INPUT_DEL_5/DEL_DARWIN_SKYDRX595_BCM97350_LNUX_01


#-----------------------------------------------------------
# cc-cmds
#-----------------------------------------------------------
ct lsview -long parkkt_BSKYB_HR002

# GM : NOTE: when rebasing, there are warning mesgs showing overrides so have checks on those.
#
ct rebase -comp -base BSKYB_INTEGRATION_BLD_48.80.00_BSKYB_HR004_Int@/vobs/FUSION_SYSTEM_INTEGRATION_PROJECTS
ct rebase -comp -base BSKYB_INTEGRATION_BLD_48.53.02_BSKYB_HR004_48.53_Int@/vobs/FUSION_SYSTEM_INTEGRATION_PROJECTS

# HZ00x
ct rebase -comp -base BSKYB_INTEGRATION_BLD_01.64.00_BSKYB_HZ001_Int@/vobs/FUSION_SYSTEM_INTEGRATION_PROJECTS

# remove an overriden comp and rebase. -dba/seline baseline-selector[,...] 
ct rebase -comp -dba SIM_F43.0.REL_SIM_BSKYB_HZ_001_Integration@/vobs/CMS_INFORMATION_SERVICES_PROJECTS

ct rebase -base SIM_F43.1.REL_SIM_BSKYB_HZ_001_Integration@/vobs/CMS_INFORMATION_SERVICES_PROJECTS

# it's possible to run this with two baselines in one go: ct rebase -comp -base first,second
ct rebase -comp -base darwin_middleware_services_D48.0.13_DMS_MASTER_Integration_Int@/vobs/DARWIN_INTEGRATION_PROJECTS
ct rebase -comp -base FREETYPE2_F30.1.REL_FREETYPE2_MAIN_Int@/vobs/CMS_SYSTEM_INFRASTRUCTURE_PROJECTS
ct rebase -comp -base MSM_COMP_F47.1.REL_MSM_MAIN_5_Int@/vobs/CMS_MEDIA_SERVICES_PROJECTS
ct rebase -comp -base MEMMAN_F45.0.REL.0_pevanden_MEMMAN_MAIN@/vobs/CMS_SYSTEM_INFRASTRUCTURE_PROJECTS
ct rebase -comp -base DARWIN_ATG_F47.6.REL_DARWIN_ATG_MAIN_Int@/vobs/DARWIN_PLATFORM_PROJECTS

ct rebase -comp -base BSKYB_JTH_10.04F_BSKY_JTH_IMPORT_MAIN_Int@/vobs/THIRD_PARTY_LIBS_PROJECTS
ct rebase -comp -base DARWIN_PLAYER_F44.1.REL_DARWIN_PLAYER_BSKYB_HZ_001_Int@/vobs/DARWIN_PLATFORM_PROJECTS
ct rebase -comp -base DARWIN_PLANNER_F45.4.REL_DARWIN_PLANNER_MAIN_Int@/vobs/DARWIN_PLATFORM_PROJECTS
ct rebase -comp -base DARWIN_SBM_F44.0.REL_DARWIN_SBM_BSKYB_HZ_001_Int@/vobs/DARWIN_PLATFORM_PROJECTS

ct rebase -base CDI_TRACKER_F1.0.17_CDI_TRACKER_MAIN_Int@/vobs/FUSIONOS_3_PROJECTS
ct rebase -base CRAFTWORK_LAE_darwin_f30.2-2010-10-13_CRAFTWORK_LAE_MAIN_Int@/vobs/THIRD_PARTY_LIBS_PROJECTS
ct rebase -comp -base MBLD_AMS_BCM_MIPS4K_LNUX_DARWIN_01_6.5.890.61-H1.18p1_0.2@/vobs/FUSIONOS_2_PROJECTS
ct rebase -comp -base VGV_DARWIN_F45.22.4.7.6.REL_VGV_DARWIN_MAIN_Integration@/vobs/VideoGuard_Projects

# -rec/ommended
# Specifies that a development stream is to be rebased to its parent stream's recommended baselines. Using this option clears 
# the existing foundation baselines and replaces them with the recommended ones.
ct rebase -rec
ct rebase -status -view parkkt_BSKYB_HR002
ct rebase -resume -view parkkt_BSKYB_HR002
ct rebase -complete [-view parkkt_BSKYB_HR002]

# search baseline
ct describe baseline:BSKYB_INTEGRATION_BLD_01.59.00_BSKYB_HZ001_Int@/vobs/FUSION_SYSTEM_INTEGRATION_PROJECTS
ct describe baseline:darwin_middleware_services_D40.0.16_DMS_BSKYB_HR_002_Int@/vobs/DARWIN_INTEGRATION_PROJECTS
ct desc baseline:SYSTEM_COMPOSITE_SYSF31.03_BSKYB_HR002_Int@/vobs/FUSION_SYSTEM_INTEGRATION_PROJECTS
ct desc baseline:BUILD_OS_SYSF31.03_BSKYB_HR002_Int@/vobs/FUSION_SYSTEM_INTEGRATION_PROJECTS
ct desc baseline:BUILD_OS_SYSF31.03_BSKYB_HR002_Int@/vobs/FUSION_SYSTEM_INTEGRATION_PROJECTS | grep AMS
    MBLD_AMS_NXP_ARM9_LNUX_DARWIN_01_SDK_6.0.0.1240_0.4@/vobs/FUSIONOS_2_PROJECTS (MBLD_AMS_NXP_ARM9_LNUX_DARWIN_01@/vobs/FUSIONOS_2_PROJECTS)
    MBLD_AMS_BCM_MIPS4K_LNUX_DARWIN_01_6.5.890.43-H1.15_0.1@/vobs/FUSIONOS_2_PROJECTS (MBLD_AMS_BCM_MIPS4K_LNUX_DARWIN_01@/vobs/FUSIONOS_2_PROJECTS)
    MBLD_AMS_NXP_ARM9_LNUX_DARWIN_03_SPK_1.16_H3_7.5.1.5170_0.1@/vobs/FUSIONOS_3_PROJECTS (MBLD_AMS_NXP_ARM9_LNUX_DARWIN_03@/vobs/FUSIONOS_3_PROJECTS)


ct describe baseline:DARWIN_PLAYER_F40.2.REL_DARWIN_PLAYER_BSKYB_HR_002_Int@/vobs/DARWIN_PLATFORM_PROJECTS
ct describe activity:deliver.flengron_DARWIN_PLAYER_BSKYB_HR_002.20100806.181221@/vobs/DARWIN_PLATFORM_PROJECTS
ct desc stream:SIM_BSKYB_HZ_001_Integration@/vobs/CMS_INFORMATION_SERVICES_PROJECTS 

ct lsstream -l -cview

# get foundation baselines and comp baselines
ct describe -fmt %[found_bls]Cp stream:BSKYB_GM_Integration@/vobs/FUSION_SYSTEM_INTEGRATION_PROJECTS | sed 's/, /\n/g'
ct describe -fmt %[found_bls]Cp stream:parkkt_BSKYB_GM_03@/vobs/FUSION_SYSTEM_INTEGRATION_PROJECTS | sed 's/, /\n/g'
ct describe -fmt %[found_bls]Xp stream:parkkt_BSKYB_GM_03@/vobs/FUSION_SYSTEM_INTEGRATION_PROJECTS | sed 's/ /\n/g'

# need sed as output is one line comma seperated.
ct lsbl -fmt "%[depends_on]XCp\n" darwin_middleware_services_D47.0.77_DMS_MASTER_Integration_Int@/vobs/DARWIN_INTEGRATION_PROJECTS | sed 's/, /\n/g' > D47.0.77.txt

# to get full list
if [ ${FULL_COMP_LISITNG} == "Y" ]; then
	for bl in $(cleartool lsstream -fmt '%[found_bls]Xp\n'); do
		echo "Getting list of component baselines for ${bl}..."
		echo "">>${out}
		echo "-----------------------------------------------------------------------------------------">>${out}
		echo "# $bl :">>${out}
		echo "-----------------------------------------------------------------------------------------">>${out}
		cleartool lsbl -fmt "%[depends_on_closure]Cp\n" ${bl} | sed 's/,./\n/g' | sed 's/@.*//g' | sort>>${out}
		echo "">>${out}
	done
fi

# get driver baseline detail
#
# get driver baseline from the full list
$ ct lsbl -fmt "%[depends_on_closure]Cp\n" darwin_middleware_services_26.12.00_BSKYB_GM_Integration@/vobs/FUSION_SYSTEM_INTEGRATION_PROJECTS | sed 's/, /\n/g' | egrep MBLD_AMS_BCM_MIPS4K
MBLD_AMS_BCM_MIPS4K_LNUX_DARWIN_01_6.5.890.60-H1.18p0_0.1@/vobs/FUSIONOS_2_PROJECTS

# get full list of a driver baseline and can use the below to filter out unnecessary details
# 
# CONTAIN_BLS=`( cleartool lsbl -fmt "%[member_of]XCp\n" $BL 2>&1; ) | sed '/^cleartool/d' | sed '/Warning/d' | sed 's/,.*//g'`
$ cleartool lsbl -fmt "%[member_of]XCp\n" MBLD_AMS_BCM_MIPS4K_LNUX_DARWIN_01_6.5.890.60-H1.18p0_0.1@/vobs/FUSIONOS_2_PROJECTS
AMS_BCM_MIPS4K_LNUX_DARWIN_01_6.5.890.60-H1.18p0_0.1@/vobs/FUSIONOS_2_PROJECTS


# get the detail of it
$ cleartool lsbl -fmt "    %[depends_on_closure]XCp\n" AMS_BCM_MIPS4K_LNUX_DARWIN_01_6.5.890.60-H1.18p0_0.1@/vobs/FUSIONOS_2_PROJECTS | sed 's/, /\n    /g'


#
# compare
#
cleartool diffbl -act BSKYB_INTEGRATION_BLD_01.38.00_BSKYB_HZ001_Int@/vobs/FUSION_SYSTEM_INTEGRATION_PROJECTS BSKYB_INTEGRATION_p01.32_BSKYB_HZ001_Int@/vobs/FUSION_SYSTEM_INTEGRATION_PROJECTS | egrep -v "deliver|rebase" | sed 's/@.*//g'

cleartool diffbl -base -act 'BSKYB_INTEGRATION_BLD_SYSF31.01_BSKYB_HR002_Int'@/vobs/FUSION_SYSTEM_INTEGRATION_PROJECTS 'BSKYB_INTEGRATION_BLD_SYSF30.11_BSKYB_HR002_Int'@/vobs/FUSION_SYSTEM_INTEGRATION_PROJECTS | findstr -V "rebase deliver << <-"

cleartool diffbl -base -act DARWIN_WLM_JAVA_F44.6.REL_DARWIN_PLATFORM_JAVA_MAIN_Integration@/vobs/DARWIN_PLATFORM_PROJECTS DARWIN_WLM_JAVA_F43.19.REL_DARWIN_PLATFORM_JAVA_MAIN_Integration@/vobs/DARWIN_PLATFORM_PROJECTS | findstr -V "rebase deliver << <-"

cleartool mkview -snap -tag parkkt_BSKYB_HR002_03 -tmode transparent -stre stream:parkkt_BSKYB_HR002_3@/vobs/FUSION_SYSTEM_INTEGRATION_PROJECTS -stgloc -auto /home/NDS-UK/parkkt/cc/parkkt_BSKYB_HR002_03

# get change detail
#
cleartool diffbl -base -act BSKYB_INTEGRATION_BLD_24.04.00_BSKYB_GM_Integration@/vobs/FUSION_SYSTEM_INTEGRATION_PROJECTS BSKYB_INTEGRATION_BLD_24.03.00_BSKYB_GM_Integration@/vobs/FUSION_SYSTEM_INTEGRATION_PROJECTS

ct desc activity:MSCQ169268_-_Model_name_in_SPM_needs_to_be_Sky_HD_not_Sky_HD@/vobs/FUSION_SYSTEM_INTEGRATION_PROJECTS

ct diff -gra -predecessor /view/parkkt_BSKYB_GM_int/vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/projects/picasso/SI_config.xml@@/main/BSKYB_GM_Integration/49
ct diff -ser -predecessor /view/parkkt_BSKYB_GM_int/vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/projects/picasso/SI_config.xml@@/main/BSKYB_GM_Integration/49

# search modified file. don't work when use on a sym link.
ct ls -r -l | grep hijacked

# update modified file with the version in the spec. -ove/rwrite
ct update -ove ./GFX/src/blitter/gfx_blitter_v1_p.c

#-----------------------------------------------------------
# cc-picasso
#-----------------------------------------------------------

# release email for outside
./get_diff_between_SI_baselines.sh -nb BSKYB_INTEGRATION_BLD_48.52.00_BSKYB_HR004_Int -ob BSKYB_INTEGRATION_BLD_48.51.00_BSKYB_HR004_Int
./get_diff_between_SI_baselines.sh -nb BSKYB_INTEGRATION_BLD_48.42.00_BSKYB_HR004_Int -ob BSKYB_INTEGRATION_BLD_48.41.00_BSKYB_HR004_Int -f

####
# pica drop
####

# search pica drop from engage: Picasso_DIGI_7.04 and unpgp it.

[parkkt@ukstbuild02 build]$ ct lsstream -l
stream "parkkt_BSKYB_PICASSO_DIGIBOX_MAIN"
views:
    parkkt_BSKYB_PICASSO_DIGIBOX_MAIN_01_dyn
foundation baselines:
    BSKYB_JTH_7.03F_BSKYB_PICASSO_DIGIBOX_MAIN_Int@/vobs/THIRD_PARTY_LIBS_PROJECTS

cd /view/parkkt_BSKYB_PICASSO_DIGIBOX_MAIN_01_dyn/vobs
cd /view/parkkt_BSKYB_PICASSO_DIGIBOX_MAIN_01_dyn/vobs/THIRD_PARTY_LIBRARIES/BSKYB_JTH/build

cleartool rebase -comp -rec
cleartool update -ove -f

clearfsimport -preview -recurse -rmname -nsetevent "/home/NDS-UK/parkkt/picasso_drop_801F/picasso" "/view/parkkt_BSKYB_PICASSO_DIGIBOX_MAIN_01_dyn/vobs/THIRD_PARTY_LIBRARIES/BSKYB_JTH/build/applications/Picasso" 2>&1 | tee ~/Picasso_import_801F_preview.txt

egrep -v "Skipping|unchanged" Picasso_import_801F_preview.txt | wc -l

ct mkact -nc -f -headline 'MSCQ6459 - Import Release 8.01F' 

clearfsimport -recurse -rmname -nsetevent "/home/NDS-UK/parkkt/picasso_drop_801F/picasso" "/view/parkkt_BSKYB_PICASSO_DIGIBOX_MAIN_01_dyn/vobs/THIRD_PARTY_LIBRARIES/BSKYB_JTH/build/applications/Picasso" 2>&1 | tee ~/Picasso_import_801F.txt

# diff
# -q     Report only whether the files differ, not the details of the differences.
# -r     When comparing directories, recursively compare any subdirectories found.
diff -qr "/home/NDS-UK/parkkt/picasso_drop_801F/picasso" "/view/parkkt_BSKYB_PICASSO_DIGIBOX_MAIN_01_dyn/vobs/THIRD_PARTY_LIBRARIES/BSKYB_JTH/build/applications/Picasso"

# deliever acts to the def stream(int stream). Can be skipped if use int stream?
# make a baseline.



####
# patch. this script will create baseline and recommand it so don't need to do more.
####
~/bin/patch_digibox_picasso.sh -f=/home/NDS-UK/parkkt/PicassoDIGI_8.01F_P1.patch
~/bin/patch_digibox_picasso.sh -f=/home/NDS-UK/parkkt/patches/PicassoDIGI_8.01F_P2.patch


####
# config overrides
####

# make.sh
#
mkdir -p ${OUTPUT}/${PLATFORM_DIR}/${ENDIAN}Endian/si/config

# run 'FusionConfigExport' which creates most cfg files.
# /home/NDS-UK/parkkt/cc/parkkt_BSKYB_GM_001/vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/picasso/FusionConfig/FusionConfigExport
# ./FusionConfigExport AUTO ./si/config/ projects/picasso/SI_config.xml BASESET BSKYB_HD_PVR ams0201 si_bskyb ams_bcm release_dbg pdl_nds_uk 

echo "${OUTPUT}/FusionConfig/FusionConfigExport AUTO 
${OUTPUT}/${PLATFORM_DIR}/${ENDIAN}Endian/si/config/ 
projects/${PROJECT}/"SI_config.xml" BASESET ${BSKYB_CONFIG_PROFILE} ${DMS_PLATFORM_CONFIG} si_bskyb ${PLATFORM} ${BUILD_TYPE} pdl_${PDL_SERVER} ${SERIALISATION}"

/home/NDS-UK/parkkt/cc/parkkt_BSKYB_GM_003/vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/picasso/FusionConfig/FusionConfigExport AUTO 
/home/NDS-UK/parkkt/cc/parkkt_BSKYB_GM_003/vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/picasso/AMS_BCM_MIPS4K_LNUX_DARWIN_01/BigEndian/si/config/ 
projects/picasso/SI_config.xml BASESET BSKYB_HD_PVR ams0201 si_bskyb ams_bcm release_dbg pdl_nds_uk 


# Copy across Fusion formatted Platform config files for CFG2BIN conversion.
cp -f ../../../${FUSIONOS}/BLD_${PLATFORM_DIR}/platform_cfg/linux/${ENDIAN}Endian/${OS_BUILD_TYPE}/config/fusion_os_cdi_labels.cfg ${OUTPUT}/${PLATFORM_DIR}/${ENDIAN}Endian/si/config/
cp -f ../../../${FUSIONOS}/BLD_${PLATFORM_DIR}/platform_cfg/linux/${ENDIAN}Endian/${OS_BUILD_TYPE}/config/fusion_os_storage_labels.cfg ${OUTPUT}/${PLATFORM_DIR}/${ENDIAN}Endian/si/config/


# Copy project config files that override DMS
cp projects/${PROJECT}/fs/NDS/config/overrides/* ${OUTPUT}/${PLATFORM_DIR}/${ENDIAN}Endian/si/config/

# run dms config
${OUTPUT}/FusionConfig/FusionConfigExport AUTO ${OUTPUT}/${PLATFORM_DIR}/${ENDIAN}Endian/dms/config/ projects/${PROJECT}/SI_config.xml BASESET ${BSKYB_CONFIG_PROFILE} ${DMS_PLATFORM_CONFIG} ${PLATFORM} ${BUILD_TYPE}

/home/NDS-UK/parkkt/cc/parkkt_BSKYB_GM_003/vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/picasso/FusionConfig/FusionConfigExport AUTO /home/NDS-UK/parkkt/cc/parkkt_BSKYB_GM_003/vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/picasso/AMS_BCM_MIPS4K_LNUX_DARWIN_01/BigEndian/dms/config/ projects/picasso/SI_config.xml BASESET BSKYB_HD_PVR ams0201 ams_bcm release_dbg

# run cfg2bin
${OUTPUT}/FusionConfig/FusionConfigImport CFG2BIN ./ *

# copy configs across to output
cp -f ${OUTPUT}/${PLATFORM_DIR}/${ENDIAN}Endian/si/config/* ${OUTPUT}/${PLATFORM_DIR}/${ENDIAN}Endian/fs/NDS/config


# SI_config.xml
#
# SI_config.xml which defines 'si_bskyb' profile
 <include name="projects/dms/fs/NDS/dms_master_config.xml" />

# dms_master_config.xml which includes each comp's config and defines BASESET, and BSKYB_HD_PVR profile.
 <include name="components/comms_services/ncm/inc/config/ncm_master_config.xml" />
 ...

# build/projects/picasso/fs/NDS/config
diagctl.cfg          guide_cms_cde_3.cfg  guide_cms_cde.cfg  guide_cms_num.cfg  siege_def.cfg  version.cfg
guide_cms_cde_2.cfg  guide_cms_cde_4.cfg  guide_cms_dsc.cfg  lae.cfg            stbe.ini

# build/projects/picasso/fs/NDS/etc
sysinit.cfg


####
# si baseline
# http://hudsonmaster1:9000/projects/hudsonadmin/wiki/SI_Baseline_process
####

cd /view/parkkt_BSKYB_HZ001_int_dyn/vobs

# change or overrise baselines on int stream. when done, run following script.
# or
# make local changes and deliver it to the int stream.
create_595_bl.sh 

# check report in /home/NDS-UK/parkkt/baseline_reports

# run this to create hudson build. 
# http://hudsonmaster1.uk.nds.com:8080/hudson/job/GetSourceFromCI_drx595/
# http://hudsonmaster1.uk.nds.com:8080/hudson/view/All/job/GetSourceFromCI/
get_source_to_hudson.sh 

# do release email work

# for SDKs
./release_SDKs.sh --platform ams_bcm --project picasso
Unpack the tarball it creates
cd to the level where the make.sh is in the tarball
./make.sh --NDS_APP_TYPE picasso --NDS_BUILD_TYPE release_dbg --NDS_PLATFORM ams_bcm --NDS_PDL_SERVER NDS_UK

# hudson
http://hudsonmaster1.uk.nds.com:8080/hudson/view/Maintenance/job/Generate_Info_Page/lastSuccessfulBuild/artifact/current_baseline_all_platforms.htm


############################################################
## TRIALS
#######################################10

############################################################
## trial-boot-scripts
############################################################

# from start-mw.sh on a box
/usr/bin/bootlog.sh 15 1024 upload
run CFG2BIN
call SCD process

# http://hoover.uk.nds.com/fusionmadesimple/index.php/Boot_Log
# \vobs\FUSION_SYSTEM_INTEGRATION\BSKYB_INTEGRATION\build\tools\nds\si\bootlog\
#
# (bootlog-config.sh)
# BLOG_mntpath="/mnt/nds/BLOGDIR" 		# before 21.15
BLOG_mntpath="/tmp/dummydisk/BLOGDIR" 	# from 21.15
FSN_DATAPATH="/mnt/nds/dev_5/part_0/FSN_DATA"

BLOG_mntdev="/dev/sda1"
BLOG_DATAPATH="${BLOG_mntpath}/FSN_DATA"

#
# [bootlog.sh] - main
# Usage: bootlog.sh <rotate limit> <size limit> [upload]
#
# check if it's already mounted.
grep -q "${BLOG_mntpath}" /proc/mounts

# mounts
mount "${BLOG_mntdev}" "${BLOG_mntpath}"
#
/usr/bin/bootlog-rotate.sh "$rotate_limit"
#
/usr/bin/bootlog-create.sh
#
/usr/bin/bootlog-diskusage.sh "$rotate_limit" "$size_limit"
# upload
[ -n "$upload" ] && /usr/bin/bootlog-upload.sh

# Run crash monitor at high priority in background
chrt -r 97 /usr/bin/crash-monitor.sh </dev/null &

# COPY MEMPROF log in background 
chrt -r 2 /usr/bin/bootlog-copymemprof.sh </dev/null &

# umount. updated from 21.15 baseline
umount "${BLOG_mntpath}"


# [bootlog-rotate.sh]
# Logs are rotated into numbered directories with the following naming scheme: 
# Higher numbered directories are older. 
# base="/mnt/nds/BLOGDIR/FSN_DATA/BOOTLOG.x"
mv 'BOOTLOG' to 'BOOTLOG.1'

# [bootlog-create.sh]
cd /mnt/nds/BLOGDIR/FSN_DATA
rm BOOTLOG
mkdir /mnt/nds/BLOGDIR/FSN_DATA/VERINFO
cp -a *.DB BOOTLOG/
mv ${BLINFOPATH}/INFO.TXT LOG LOG.* *.LOG *.CUR *.COR *.TXT BOOTLOG/

# [bootlog-mkinfo.sh] create info file, nvram file, etc..
/usr/bin/bootlog-mkinfo.sh >${BLINFOPATH}/INFO.TXT
# Middleware version
grep NDS_SW_VERSION /NDS/config/version.cfg && echo

# CDI version information properties
/usr/bin/cdi-vi STBM_NAME MODEL_VER STB_ID && echo

# Linux kernel version
uname -a
cat /proc/version && echo

# CDI driver version
cat /proc/callisto/version && echo


# [bootlog-upload.sh]
# Do upload
logdir="${BLOG_DATAPATH}"/BOOTLOG
if /usr/bin/bootlog-upload-1.sh "$logdir" &>/tmp/UPLOAD.LOG; then
  echo '---- UPLOAD COMPLETE ----' >>"$logdir"/UPLOAD.LOG
  cat /tmp/UPLOAD.LOG >>"$logdir"/UPLOAD.LOG

  # Remove global log file if upload succeeded
  rm -f "${BLOG_DATAPATH}"/UPLOAD.LOG
else

# Disable "online" LED
/usr/bin/cdi-fpi 0 0 0


# [bootlog-upload-1.sh]
# FTP settings
host=87.86.191.132
user=anonymous
pass=upload@sky.com
path=upload

# Enable "online" LED
# "usage: cdi-fpi <index> <state> <luminosity>\n"
/usr/bin/cdi-fpi 0 1 1

# Create tarball. upload 'BOOTLOG'
tar -c \
  "${BLOG_DATAPATH}"/UPLOAD.LOG \
  "$logdir"/LOG \
  "$logdir"/*.LOG \			# previous binary DIAG log
  "$logdir"/*.CUR \ 		# current binary DIAG log
  "$logdir"/*.TXT \
  "$logdir"/MFS.DB \
  "$logdir"/PCAT.DB \
  "$logdir"/REMBOOK.DB \
  "$logdir"/NVRAM0.BIN \
  "$logdir"/NVRAM1.BIN \
  "$logdir"/*.COR \ 
| gzip >"$logdir"/UPLOAD || exit $?


# get mac
# -sh-3.2# cat /sys/class/net/eth0/address
# 00:10:18:00:12:00
# 
cut -c1-2,4-5,7-8,10-11,13-14,16-17 </sys/class/net/eth0/address

# [crash-monitor.sh]
# Set core dump location and format
echo '/tmp/%p.COR' >/proc/sys/kernel/core_pattern

# The crash monitor is a process which runs in the background checking for core dumps and then copying them to the disk when they appear. 
# The core dumps are written to /tmp/<pid>.COR by the kernel. The crash monitor copies these to /FSN_DATA/. 
# Looking at the date of the core files may give you a clue as to when a crash occurred. 


#-----------------------------------------------------------
# to_dates
#-----------------------------------------------------------
Readable Any Date

to_dates converts any possible timestamp into a date format.

Usage guide: cat something | to_dates

Example usage:

tail -1 LOGlastrun | to_dates 

NDS: ^[16:28:22]0946744102.035999 ...

To save this to a file, just do

cat LOGlastrun | to_dates > LOG.converted

It is also possible to convert the file "in place":

to_dates LOGlastrun

Additionally, if the time desired is the actual time from the stream, rather than the time related to the box's last boot-time, it is possible to use

to_dates -real LOGlastrun

This uses the first SYSTEMTIME message "Time has been updated to" as callibration, and amends all times relative to that, e.g.

-
NDS: ^[18:21:16]0946685685.229684 !MIL   -SYSTEMTIME   < p:00000064 t:2aeb4830 T:SIM_PLUGIN_XSI_MC_ENGINE_THREAD 
 M:systemtime.c F:SYSTEMTIME_SetTime L:00911 > Time has been updated to 18:21:16
NDS: ^[18:21:23]0946685692.827540 !MIL   -aem          < p:00000065 t:010d3c40 T:AEM_INPUT_MONITOR_THREAD 
 M:aem_userinput.c F:AEM_InputMonitorThread L:00429 > KEY_PRESS: code=0x(INFO)e00e
-

#-----------------------------------------------------------
# test_log: logparser
#-----------------------------------------------------------
# this is a scrip to run logparser
#
# pre-condition:
# 	there should be 'LOGlastrun' or 'LOGlastrun.gz'
#
# logic:
#
#  	1.1 PATTERN MATCHING
# 	this runs simple reg pattern match based on '/bin/testlist'. Run by 'generic_tester.sh'
#
#	(testlist format example)
#	# prio strs
#
#   3	Error iterating through calls to PLANNER_DBINTERFACE_ResetIncoherentBooking	PLANNER_DBINTERFACE_ResetIncoherentBooking - Engage 21467
#   
#
# 	1. LOGPARSER CASE PER P VALUE
# 	find out if there are matchs to each file under '~kibbler/log_parser/tests/'. USE ~kibbler/bin/tests/
# 	(theyard@/home/si_logs/bin/tests)
#
#	(memcheck2)
#    !WARN   -MEMMAN       	< M:mem_static.c F:MHWMemAllocStatic L:67 > Cannot allocate 148 bytes in pool " "ADPT_GUIDE"  
# 	
# 	These are files which defines error case according to P{num}, priority.
# 	   Basically each file represent one case for logparser.
#
#
# 	2. LOGPARSER CASE FOR ALL
# 	After running parser per P, run each file under '/bin/test_all/' on input log
#
#	3. result
# 	.test_out
#

@ukstbuild01
cd /home/si_logs/mirrored/upload
ls -alt picassodigi*

# 890 case
darwin_001018001200_30c26f7d966c03ff4f850a19380182b4.tgz


# on the box
/mnt/nds/dev_2/part_0/BOOTLOG/*
/mnt/nds/dev_2/part_0/*

# fsky?
[parkkt@ukstbuild01 bin]$ more fsky 
ftpsky "dir *$1*"
./ftpsky "get darwin_001018001200_30c26f7d966c03ff4f850a19380182b4.tgz"


#-----------------------------------------------------------
# check_log: check_log <md5sum or mac address>: do the conversion of the upload file 
#-----------------------------------------------------------
# run on dirs
~kibbler/bin/check_log ./

==
[si_logs@ukstbuild01 parkkt]$ check_log 930bfc54ac88565a249ae01328a8a88b
WC=1
File line now {Jul 5 10:22 darwin_0019fbddef0c_930bfc54ac88565a249ae01328a8a88b.tgz}
Using 
...
# from the below log, can get diag_bin_parser from '/home/si_logs/tx/drx890/20.05.00'
diag_bin1 (/home/si_logs/tx/drx890/19.14.00,/home/si_logs/tx/drx890/20.05.00) Pre-parse...


# grep from UPLOAD.LOG
# Uploading to ftp://anonymous@87.86.191.132/upload/darwin_00101800122e_c9a6001730871c2bc4b38f57a34844f9.tgz
+ hwaddr=001018001200
+ md5=080f6bcc972075befa5dc039265e54f6

# get list of uploaded files (890 case)
ls /home/si_logs/mirrored/upload/darwin_00101800122e*

cp /home/si_logs/mirrored/upload/darwin_00101800122e_157cab819be0c785f41d8cdcde7aaead.tgz .


############################################################
## CORE
############################################################
set solib-absolute-prefix /jk
set solib-search-path /home/NDS-UK/parkkt/gdb/lib_kt
file APP_Process 
core 286.COR 
bt

export LD_LIBRARY_PATH=/home/si_logs
/home/si_logs/bin/mips-gdb MW_Process 272.COR
set solib-absolute-prefix /junk
set solib-search-path /home/si_logs/com.nds.darwin.debugsupport/debug_libs/uClibc-nptl-0.9.29-20070423

export LD_LIBRARY_PATH=/home/NDS-UK/parkkt/bins
set solib-search-path /home/NDS-UK/parkkt/com.nds.darwin.debugsupport/debug_libs/uClibc-nptl-0.9.29-20070423
core 272.COR
bt


############################################################
## BUILD
############################################################

#-----------------------------------------------------------
# build-si-890 (picasso)
#-----------------------------------------------------------

# should see 'gaudi_orchid MAKE COMPLETED'
# should see 'picasso MAKE COMPLETED'

cd vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/

# make.sh: Build the Darwin middleware and/or application.
# (but don't support 890 platform)
#./make.sh --platform "ams-drx890" --profile "NDS_SI_Devel" 
#./make.sh -c --platform "ams-drx890" --profile "NDS_SI_Devel"

# build_mw_epg: Build the Darwin middleware and/or application.
./build_mw_epg.sh --platform ams-drx890 --project picasso --variant debug --profile nds_si_devel --clean [--output /home/NDS-UK/parkkt/cc/parkkt_BSKYB_INTEGRATION_MAIN_01/vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build]
./build_mw_epg.sh --platform ams-drx890 --project picasso --variant debug --profile nds_si_devel --clean
./build_mw_epg.sh --platform ams-drx890 --project picasso --variant debug --profile nds_si_devel --use_sysinit_cfg 
./build_mw_epg.sh --platform ams-drx890 --project picasso --variant debug --profile nds_si_devel --baseline ENG_4273_MB
./build_mw_epg.sh --platform ams-drx890 --project picasso --variant debug --profile nds_si_devel --clean --mw_only --baseline ENG_KT_PCAT_05
./build_mw_epg.sh --platform ams-drx890 --project picasso --variant debug --profile sky_trials --baseline ENG_VGV_KT
./build_mw_epg.sh --platform ams-drx890 --project picasso --variant debug --profile nds_si_devel --memprof --bootlog --baseline ENG_SOC_03
./build_mw_epg.sh --platform ams-drx890 --project picasso --variant debug --profile nds_si_devel
./build_mw_epg.sh --platform ams-drx890 --project picasso --variant debug --profile cust_trials --clean
#./build_mw_epg.sh --platform "ams-drx780" --profile "NDS_SI_Devel" -nm

# to get flash0.tar.gz. use this but not release.sh
./picasso_flash_H1.sh -b ams_bcm -p stripped_optim -s nds
./picasso_flash_H1.sh -b ams_bcm -p debug -s nds

# bsysconfig.bin
/home/NDS-UK/parkkt/cc/parkkt_BSKYB_GM_002/vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/picasso/FusionConfig
/home/NDS-UK/parkkt/cc/parkkt_BSKYB_GM_001/vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/picasso/FusionConfig/FusionConfigImport CFG2BIN ./ *
/home/NDS-UK/parkkt/cc/parkkt_BSKYB_GM_002/vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/picasso/FusionConfig/FusionConfigImport CFG2BIN ./ *
/home/NDS-UK/parkkt/cc/parkkt_BSKYB_GM_003/vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/picasso/FusionConfig/FusionConfigImport CFG2BIN ./ *

/home/NDS-UK/parkkt/cc/parkkt_BSKYB_GM_003/vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/picasso/FusionConfig/FusionConfigImport BIN2XML x.xml bsysconfig.bin 

# takes about 5 mins
./make_image.sh --platform ams-drx890 --project picasso --profile "NDS_SI_Devel" 
./make_image.sh --platform ams-drx890 --project picasso --profile "sky_trials" 
./make_image.sh --platform ams-drx890 --project picasso --variant preprod --profile cust_trials

# takes about 37 mins
./make_image.sh --platform ams-drx890 --project picasso --profile "NDS_SI_Devel" -c
./make_image.sh --platform ams-drx890 --project picasso --profile "NDS_SI_Devel" --kernel_only 

# box hw
ETH0_HWADDR 00:10:18:00:12:00 (top, 001018001200)
ETH0_HWADDR 00:10:18:00:12:2E (00101800122e)

# top
telnet 172.18.200.80
telnet 172.18.202.17

get_log top 172.18.201.13
get_log bot 172.18.202.17

# gcc
/home/NDS-UK/parkkt/cc/parkkt_BSKYB_GM_001/vobs/FUSIONOS_2/BLD_AMS_BCM_MIPS4K_LNUX_DARWIN_01/platform_cfg/linux/compiler/mips4k_gcc_x86_linux_hound/bin

#-----------------------------------------------------------
# build-si-595 (picasso)
#-----------------------------------------------------------
#
#./build_mw_epg.sh --platform ams-drx595 --project picasso --variant debug --profile nds_si_devel
#./build_mw_epg.sh --platform ams-drx595 --project picasso --variant debug --profile nds_si_devel --clean
#
# sky_prod
#./build_mw_epg.sh --platform ams-drx595 --project picasso --variant debug --profile sky_prod
#./build_mw_epg.sh --platform ams-drx595 --project picasso --variant debug --profile nds_si_devel -nm
#./make_image.sh --platform ams-drx595 --project picasso --profile "NDS_SI_Devel" 
#./make_image.sh --platform ams-drx595 --project picasso --profile sky_prod 
#./make_image.sh --platform ams-drx595 --project picasso --variant prod --profile sky_prod --output $PWD
#
# should run 'kernel_only' after running usual full make_image. otherwise, will get none-working image which has no cdi device nodes.
#./make_image.sh --platform ams-drx595 --project picasso --profile "NDS_SI_Devel" --kernel_only 
#./make_image.sh --platform ams-drx595 --project picasso --profile "NDS_SI_Devel" 
#
# move up to ./utils
#./picasso_flash_H1.sh -b ams_drx595 -p stripped_optim -s nds
#./picasso_flash_H1.sh -b ams_drx595 -p debug -s nds
#
#
# gcc
#~/cc/parkkt_BSKYB_HZ001_01/vobs/FUSIONOS_5/BLD_DARWIN_SKYDRX595_BCM97350_LNUX_01/platform_cfg/linux/compiler/mips4k_gcc_x86_linux_hound/bin/mips-linux-gcc test.c


#-----------------------------------------------------------
# build-debug or release
#-----------------------------------------------------------

# comp makefile
COMPONENT_NAME:=spm_server
include $(NDS_ROOT)/projects/$(NDS_PROJECT)/build_options.mk

# build_options.mk
# vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/projects/picasso/build_options.mk
NDS_BUILD_TYPE_ncm_server = debug
include $(NDS_ROOT)/projects/fusion2/build_options.mk

# fusion2/build_options.mk
ifeq ($(strip $(NDS_BUILD_TYPE_$(COMPONENT_NAME))),debug)
  GLOBAL_DEFINES += DEBUG
  GLOBAL_DEFINES += DIAG_DEBUG
endif

ifeq ($(strip $(NDS_BUILD_TYPE_$(COMPONENT_NAME))),release)
  GLOBAL_DEFINES += RELEASE
  ifeq (YES,$(DIAG_RELEASE_MIL))
    GLOBAL_DEFINES += DIAG_RELEASE_MIL
  else
    GLOBAL_DEFINES += DIAG_RELEASE
  endif
endif

ifeq ($(strip $(NDS_BUILD_TYPE_$(COMPONENT_NAME))),release_dbg)
  ifeq (YES,$(DIAG_ENABLE_ALL_LEVELS))
    GLOBAL_DEFINES += RELEASE_DBG
    GLOBAL_DEFINES += DIAG_DEBUG
  else
    GLOBAL_DEFINES += RELEASE_DBG
    GLOBAL_DEFINES += DIAG_RELEASE_DBG
  endif
endif

# /vobs/FUSIONOS_2/BLD_AMS_BCM_MIPS4K_LNUX_DARWIN_01/platform_cfg/linux/platform.mk
#
ifeq ($(NDS_BUILD_TYPE_$(COMPONENT_NAME)), debug)
  LOCAL_PLATFORM_CC_FLAGS += -O0
else
  ifneq ($(NDS_GCOV_$(COMPONENT_NAME)), YES)
    LOCAL_PLATFORM_CC_FLAGS += -Os
  endif
  LOCAL_PLATFORM_CC_FLAGS += -fno-strict-aliasing
endif


define PLATFORM_CC_BUILD_OBJECT
     echo +++ Message from $(NDS_PLATFORM)/platform.mk - Creating object $@
     echo "KT: $(LOCAL_PLATFORM_CC) $(LOCAL_PLATFORM_CC_FLAGS) $(COMMON_CC_FLAGS) -c $< -o $@"                                   
     $(LOCAL_PLATFORM_CC) $(LOCAL_PLATFORM_CC_FLAGS) $(COMMON_CC_FLAGS) -c $< -o $@
endef

define PLATFORM_BUILD_PROCESS_FROM_OBJECTS
    @echo +++ Message from $(NDS_PLATFORM)/platform.mk Linking Process $@
    @echo "KT: $(LOCAL_PLATFORM_LD) -Xlinker -Map -Xlinker $@.map -Xlinker --start-group $(^:$(PLATFORM_LIB_PREFIX)%$(PLATFORM_LIB_SUFFIX)=-l%) $(LOCAL_PLATFORM_PROCESS_LD_FLAGS) -Xlinker --end-group -o $@"
    $(LOCAL_PLATFORM_LD) -Xlinker -Map -Xlinker $@.map -Xlinker --start-group $(^:$(PLATFORM_LIB_PREFIX)%$(PLATFORM_LIB_SUFFIX)=-l%) $(LOCAL_PLATFORM_PROCESS_LD_FLAGS) -Xlinker --end-group -o $@
endef

PLATFORM_STRIP := $(COMPILER_ROOT)/bin/$(MIPS)-linux-uclibc-strip

# /vobs/BUILD_SYSTEM/COMMON_MAKEFILES/process.mk
ifeq (YES,$(NDS_STRIP_PROCESS))                                                                                                 
define LOCAL_PROCESS_STRIP_PROCESS
    $(COMMANDS_MKDIR) $(NDS_BUILD_ROOT)/$(NDS_PLATFORM)/$(NDS_PLATFORM_ENDIAN)/unstripped_processes
    $(COMMANDS_CP) $@ $(NDS_BUILD_ROOT)/$(NDS_PLATFORM)/$(NDS_PLATFORM_ENDIAN)/unstripped_processes/$(notdir $@)
    @echo Removing debug information from $@
    $(PLATFORM_STRIP) $@
endef


# cflag for si_devel taken from 26.17. Nov 15 2011
#
/linux/compiler/mips4k_gcc_x86_linux_hound/bin/mips-linux-uclibc-gcc  
-Os -fno-strict-aliasing -Wall -g -fno-builtin -DNeedFunctioPrototypes=1 -Wmissing-prototypes -Wshadow -Wpointer-arith 
-Wstrict-prototypes -Wmissing-declarations

-DAMS_SUPPORTED -DAPP_MGMT_SIGNAL_24_7_SERVICE_TYPE_82H -DAPP_MGMT_SIGNAL_ETV_OTV_TRIGGER_MOD 
-DAPP_MGMT_SIGNAL_RECOMMENDATION_OTV_PROMO_MOD -DCALLBACK_PSTN -DCAPTION_TELETEXT_LEGACY_LAYOUT -DCAROUSEL_OTV 
-DCA_VIDEOGUARD_NDS_SECURE_RETURN_PATH -DCA_VIDEOGUARD_PARENTAL_RESTRICT -DCA_VIDEOGUARD_WATERSHED -DFRONT_END_SAT 
-DFRONT_END_SAT_SCR -DFUSION_APP_MGMT_SUPPORTED -DFUSION_CA_VIDEOGUARD_SUPPORTED -DFUSION_HEADEND_METADATA_SUPPORTED 
-DFUSION_HOME_NETWORK_SUPPORTED -DFUSION_METADATA_SUPPORTED -DFUSION_PDL_SUPPORTED -DFUSION_PVR_SUPPORTED 
-DFUSION_USER_ACTIVITY_SUPPORTED -DGUIDE_BSKYB_FORMAT_LOGICAL_CHAN_NO -DGUIDE_BSKYB_SUBSCRIBER_PROPERTIES_USED 
-DHEADEND_METADATA_OIGC -DHOME_NETWORK_MEDIA_RENDERER -DHOME_NETWORK_PLANNER_SERVER -DIPPV -DMCM_PVR_RECORD_CA_HOLES 
-DMETADATA_SI_XSI_SSR -DPDL_NDS_SECURE_AUTH -DPLAYER_PIN_HANDLING_A -DPVR_CHECK_XTV_STATUS -DPVR_CLASSIC_REVIEW_BUFFER 
-DSERIES_IMPLICIT_SERIES_DELETION -DSERIES_SYNCHRONIZE_BOOKINGS_WITH_SIGNUPS -DSI_SERVICE_SCAN_XSI -DSOFTWARE_DOWNLOAD_BACKGROUND 
-DSOFTWARE_DOWNLOAD_OTV -DSRM_ELEMENTARY_STREAMS_SELECTION_A -DSRM_USE_PI_SCHEDULE_FLAG_FOR_AVAILABILITY -DUSB_SUPPORTED 
-DUSER_ACTIVITY_BARB -DUSER_ACTIVITY_SSP -DWIFI_SUPPORTED -DRELEASE_DBG -DDIAG_RELEASE_DBG -DOTV_CAROUSEL_SUPPORTED -DXSI_SUPPORTED 
-DLINT_ERRORS_ONLY= -DLINT_RESTORE= -DMEMPROF -DPROFILE_A -DDIAG_LOG_NDEBUG -DNDEBUG -DMEMMAN_TRUSTED_CLIENT -DGFX_NO_SHAPE 
-DGFX_IMAGE_NO_DITHERING -DGFX_PAINTER_NO_ARGB16_4444 -DGFX_PAINTER_NO_ARGB16_4444_PREMULT -DGFX_PAINTER_NO_RGB16_565 
-DGFX_PAINTER_NO_SURFACE_RW -DMSCQ560970 -DLEGACY_MIGRATION_SUPPORT -DSUN_BUILD -DNDS_APP_TYPE_PICASSO -DDIAG_JAVA_DEBUG 
-D_XOPEN_SOURCE=600 -DAMS_BCM_MIPS4K_LNUX_DARWIN_01 -DFUSION_PROFILE -DMEMMAN_TRUSTED_CLIENT -DCQ380004_USE_STB_SW_01 
-DMSCQ550407_3DEPG  
-DCDI_IOCTL_DEFINITIONS="/data/home/NDS-UK/parkkt/cc/parkkt_BSKYB_GM_002/vobs/FUSIONOS_2/BLD_AMS_BCM_MIPS4K_LNUX_DARWIN_01/platform_cfg/linux/inc/ioctl_magic.h" 
-DCDI -DIS_BIG_ENDIAN -D__BIG_ENDIAN -D_XOPEN_SOURCE=600 -D__USE_XOPEN2K -D_GNU_SOURCE 

# link flags for si_devel taken from HR004(48.10). 
#
+++ Message from AMS_BCM_MIPS4K_LNUX_DARWIN_01/platform.mk Linking Process ../../processes/MW_Process
KT: ..//platform_cfg/linux/compiler/mips4k_gcc_x86_linux_hound/bin/
mips-linux-uclibc-gcc -Xlinker -Map -Xlinker 
../release_dbg/components/../processes/MW_Process.map
-Xlinker 
--start-group 
.../
../processes/mw_process_main.o 
../processes/../common/memprof.o 
../release_dbg//components/media_services/camm/src/libcamm.a 
../release_dbg//components/media_services/camm/src/core/mci/ipc/server/src/libcamm_ipc_server.a 
../release_dbg//components/media_services/camm/src/rpc/client/src/libcamm_rpc_client.a 
../release_dbg//components/media_services/camm/src/rpc/server/src/libcamm_rpc_server.a 
../release_dbg//components/misc_libraries/cmdc/src/libcmdc.a 
../release_dbg//components/media_services/ctm/src/server/libctm_server.a 
../release_dbg//components/media_services/ctm/src/client/libctm_client.a 
../release_dbg//components/darwin_system_platform_components/darwin_dlm/src/libdarwin_dlm.a 
../release_dbg//components/darwin_system_platform_components/darwin_dlm/src/dlm_server/libdarwin_dlm_server.a
../release_dbg//components/darwin_platform_components/darwin_pcatp/src/common/libdarwin_pcatp.a
../release_dbg//components/darwin_platform_components/darwin_prefs/src/server/libdarwin_prefs_srv.a 
../release_dbg//components/darwin_system_platform_components/darwin_sbm/src/server/libdarwin_sbm_server.a 
../release_dbg//components/darwin_system_platform_components/darwin_sbm/src/client/libdarwin_sbm_client.a 
../release_dbg//components/darwin_system_platform_components/darwin_srm/src/libdarwin_srm.a 
../release_dbg//components/darwin_system_platform_components/darwin_rembook/src/libdarwin_rembook.a 
../release_dbg//components/darwin_system_platform_components/darwin_uam/src/server/src/libdarwin_uam_server.a 
../release_dbg//components/darwin_system_platform_components/darwin_uam/src/libdarwin_uam.a 
../release_dbg//components/information_services/dbengine/src/Interface/libdbengine.a 
../release_dbg//components/system_libraries/diag/src/log/src/libdiag_log.a ../release_dbg//components/misc_libraries/expat/src/libexpat.a 
../release_dbg//components/information_services/fdm/src/fdm_fs/src/libfdm_fs.a 
../release_dbg//components/information_services/fdm/src/fdm_svr/src/libfdm_svr.a ../release_dbg//components/misc_libraries/http/src/libhttp.a 
../release_dbg//components/misc_libraries/httpserver/src/libhttpserver.a ../release_dbg//components/system_libraries/ipc/src/client/libIPC_CLIENT.a 
../release_dbg//components/system_libraries/ipc/src/server/libIPC_SERVER.a ../release_dbg//components/system_libraries/memman/src/libmemman.a 
../release_dbg//components/media_services/bem/src/server/libms_bem_server_src.a 
../release_dbg//components/media_services/capproc/src/server/libms_capproc_server_src.a 
../release_dbg//components/media_services/fem/src/libms_fem_src.a 
../release_dbg//components/media_services/msm/src/libmsm.a ../release_dbg//components/media_services/mcm/src/libms_mcm_src.a 
../release_dbg//components/media_services/mdm/src/libms_mdm_src.a ../release_dbg//components/media_services/mpm/src/libms_mpm_src.a 
../release_dbg//components/comms_services/ncm/src/client/libncm_client.a 
../release_dbg//components/information_services/pcat/src/common/libpcat_common.a 
../release_dbg//components/information_services/pcat/src/server/libpcat_server.a 
../release_dbg//components/system_resource_management/pdm/src/server/libpdm_srv.a 
../release_dbg//components/information_services/psched/src/libpsched.a 
../release_dbg//components/darwin_system_platform_components/darwin_rmfplugin/src/librmfplugin.a 
../release_dbg//components/system_resource_management/rmf/src/server/librmf_server.a 
../release_dbg//components/darwin_system_platform_components/rnc/src/server/librnc_server.a 
../release_dbg//components/information_services/sdm/src/libis_sdm.a ../release_dbg//components/information_services/sfm/src/libsfm.a 
../release_dbg//components/information_services/sim/src/server/sql/lifecycle-ctrl/libsim_sql_lifecycle_controller.a 
../release_dbg//components/information_services/sim/src/client/si/libsim_client_si.a 
../release_dbg//components/information_services/sim/src/utils/profile/libsim_utils_profile_library.a 
../release_dbg//components/comms_services/spc/src/client/libspc_client.a ../release_dbg//components/comms_services/spc/src/common/libspc_common.a 
../release_dbg//components/comms_services/spc/src/server/libspc_server.a 
../release_dbg//components/darwin_system_platform_components/darwin_spm/src/client/libspm_client.a 
../release_dbg//components/darwin_system_platform_components/darwin_spm/src/server/libspm_server.a 
../release_dbg//components/system_resource_management/ssm/src/ssm_client/libSSM_CLIENT.a 
../release_dbg//components/system_resource_management/ssm/src/ssm_common/libSSM_COMMON.a 
../release_dbg//components/system_resource_management/ssm/src/ssm_server/libSSM_SERVER.a 
../release_dbg//components/system_control_and_diagnostics/sysinit/src/client/libSYSINIT_CLIENT.a 
../release_dbg//components/system_libraries/systemalarm/src/libsystemalarm.a 
../release_dbg//components/system_libraries/systemconfig/src/libsystemconfig.a 
../release_dbg//components/system_libraries/systemitc/src/libsystemitc.a ../release_dbg//components/system_libraries/systemlang/src/libsystemlang.a 
../release_dbg//components/system_libraries/systemlocator/src/libsystemlocator.a 
../release_dbg//components/system_libraries/systemobject/src/libsystemobject.a 
../release_dbg//components/system_libraries/systemstring/src/libsystemstring.a 
../release_dbg//components/system_libraries/systemtime/src/libsystemtime.a 
../release_dbg//components/system_libraries/systemutil/src/libsystemutil.a 
../release_dbg//components/media_services/vrm/src/server/libvrm_server.a ../release_dbg//components/misc_libraries/zlib/src/libzlib.a
../release_dbg//components/presentation_services/gfx/src/libgfx.a ../release_dbg//components/media_services/bem/src/client/libms_bem_client_src.a 
../release_dbg//components/system_resource_management/pdm/src/client/libpdm_cli.a 
../release_dbg//components/system_resource_management/rmf/src/client/librmf_client.a 
../release_dbg//components/comms_services/wlm/src/common/libwlm_common.a ../release_dbg//components/comms_services/wlm/src/server/libwlm_server.a 
../release_dbg//components/misc_libraries/upnp/src/libupnp.a 
../release_dbg//components/darwin_system_platform_components/darwin_scm/src/server/libdarwin_scm_server.a 
../release_dbg//components/darwin_system_platform_components/darwin_scm/src/mscp/libdarwin_scm_mscp.a 
../release_dbg//components/misc_libraries/binxml/src/libbinxml.a 

../build/components/security_services/vgv/darwin/src/AMS_BCM_MIPS4K_LNUX_DARWIN_01/BigEndian/release_dbg/libvgc_mw.a 
../platform_cfg/linux/BigEndian/release_dbg/lib/libstorage_helper_api.a 
../platform_cfg/linux/BigEndian/release_dbg/lib/libstorage_osi_utilities_api.a 
../platform_cfg/linux/BigEndian/release_dbg/lib/libnetwork_helper_api.a 
../platform_cfg/linux/BigEndian/release_dbg/lib/libnetwork_osi_utilities_api.a 
../platform_cfg/linux/BigEndian/release_dbg/lib/libserial_helper.a 
../platform_cfg/linux/compiler/mips4k_gcc_x86_linux_hound/nds/lib/BigEndian//libposix_spawn.a 
../platform_cfg/linux/compiler/mips4k_gcc_x86_linux_hound/nds/lib/BigEndian//libclocks.a 
../platform_cfg/linux/compiler/mips4k_gcc_x86_linux_hound/nds/lib/BigEndian//libshmem.a  

-lm -lpthread -Wl,-rpath-link=..//platform_cfg/linux/compiler/mips4k_gcc_x86_linux_hound/mips-linux-uclibc/lib 
..//platform_cfg/linux/compiler/mips4k_gcc_x86_linux_hound/mips-linux-uclibc/lib/libstdc++.a 
-Xlinker --end-group 
-o ../../processes/MW_Process


mips-linux-uclibc-strip build/picasso/AMS_BCM_MIPS4K_LNUX_DARWIN_01/BigEndian/release_dbg/components/../processes/APP_Process
mips-linux-uclibc-strip build/picasso/AMS_BCM_MIPS4K_LNUX_DARWIN_01/BigEndian/release_dbg/components/../processes/SCD_Process
mips-linux-uclibc-strip build/picasso/AMS_BCM_MIPS4K_LNUX_DARWIN_01/BigEndian/release_dbg/components/../processes/MW_Process
mips-linux-uclibc-strip build/picasso/AMS_BCM_MIPS4K_LNUX_DARWIN_01/BigEndian/release_dbg/components/../processes/CA_Process


# so how about trun on diag debug on a specific file of a component but not a whole component?
# put the below at the beginning of c file. work?

/home/NDS-UK/parkkt/cc/parkkt_BSKYB_GM_002/vobs/CMS_SYSTEM_INFRASTRUCTURE/DIAG/inc/config/diag_master_config.xml


#-----------------------------------------------------------
# build_scripts
#-----------------------------------------------------------
./release_darwin_platform.sh --platform ams-drx780  --variant debug --profile sky_trials --clean --output $PWD
	./build_mw_epg.sh ${CMD_LINE}
		make.sh
	./make_image.sh ${CMD_LINE}

	
#-----------------------------------------------------------
# build-variants (from hudson)
#-----------------------------------------------------------
./release_darwin_platform.sh --platform ams-drx890 --project picasso --variant debug --clean --output ... --profile nds_si_devel
./release_darwin_platform.sh --platform ams-drx890 --project picasso --variant prod --clean --output ... --profile sky_prod
./release_darwin_platform.sh --platform ams-drx890 --project picasso --variant debug --clean --output ... --profile sky_trials
./release_darwin_platform.sh --platform ams-drx890 --project picasso --variant prod --clean --output ... --profile sky_tpt

# cust trial build from hudson. cartool is yes by default
./release_darwin_platform.sh --cartool no --output $PWD --profile cust_trials --variant preprod --platform ams-drx890 --project picasso --clean
./release_darwin_platform.sh --cartool no --output $PWD --profile sky_trials --variant debug --platform ams-drx890 --project picasso  --clean  


#-----------------------------------------------------------
# build_mw_epg.sh
#-----------------------------------------------------------
# ./build_mw_epg.sh --platform ams-drx890 --project picasso --variant debug --profile nds_si_devel --clean
# 
# OUTPUT = $(pwd)
# VARIANT = debug

build_mw_epg()
{
	# picasso case
	# else [ "${USE_SYSINIT_CFG}" == "YES" ]
	# ./make.sh --clean --profile ${PROFILE} --project ${PROJECT} -a ${PROJECT} --box ${BOX} --output ${OUTPUT} --baseline ${BASELINE}
	./make.sh --clean --profile nds_si_devel --project picasso -a picasso --box ams_bcm 
	--output /home/NDS-UK/parkkt/cc/parkkt_BSKYB_GM_001/vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build --baseline  
}	

BUILD_OUTPUT_ROOT == .../picasso/AMS_BCM_MIPS4K_LNUX_DARWIN_01/BigEndian/fs/NDS

package_mw_epg_binary()
{
	# Enable FTP uploading for Sky Trials only 
	if [ -z "$UPLOAD" ]; then
	if [ ${PROFILE} =  "sky_trials" ] || [ ${PROFILE} =  "cust_trials" ]; then
	   UPLOAD=1
	  # Enable new BOOTLOG Mechanism to upload logs for sky trials
	   BOOTLOG=1
	fi
	else
	
	# SPK_SCRIPT_MW=/etc/start-mw.sh
	mkdir -p "nds-mw/`dirname "$SPK_SCRIPT_MW"`"

	if (([ "${PROFILE}" = "nds_si_devel" ] || [ "${PROFILE}" = "s3_picasso" ]) && [ "${VARIANT}" = "debug" ]); then
		echo 'echo'
		echo 'echo "##########################"'
		echo 'echo "# Loading NDS middleware #"'
		echo 'echo "##########################"'
		echo 'echo'
		echo 'echo "####################################"'
		echo 'echo "# Middleware starting in 5 seconds #"'
		echo 'echo "# Hit ctrl-C to cancel             #"'
		echo 'echo "####################################"'
		echo 'echo'
		echo 'stty brkint'
		echo 'sleep 5 || exit'
	fi

	if ( [ "${VARIANT}" = "debug" ] ); then
		echo 'mkdir -p /mnt/nds'
		echo 'chgrp NDS_MW /mnt/nds'
		echo 'chown NDS_U2 /mnt/nds'
		echo 'mkdir -p /mnt/nds/disk/FSN_DATA && mount -t tmpfs none /mnt/nds/disk/FSN_DATA -o ro'
	fi

	# don't need to re-build cfg files if prod build
	if ! (([ "${PROFILE}" = "sky_prod" ]) && [ "${VARIANT}" = "prod" ]); then
		echo 'cd /NDS/config'
		echo '/NDS/bin/FusionConfigImport CFG2BIN ./ *'      
	fi

	# make files on root fs and generates scripts. e.g. upload script, boot log scripts. 'start-mw.sh' 
	# tars all files under 'nds-mw' into mw-epg-ams-drx890-debug-nds_si_devel.tar.bz2. mv it into picasso/AMS_BCM_MIPS4K_LNUX_DARWIN_01/BigEndian
	#
	# convention is: ( VARIANT is only used to define this var)
	#
	SPK_TARBALL_MW=mw-epg-${PLATFORM}-${VARIANT}-${PROFILE}.tar.bz2 
}


# -C means 'change dir'
#
tar -cjvf "$SPK_TARBALL_MW" -C nds-mw .
tar -cjvf x.bz2 -C /home/si_logs/translation/brentwood_52_1_Feb_13_10_07_b453e4424ac4c2b2300428469adb7710 .
tar -cjvf ~/ktpark/SI-4453.bz2 .

#-----------------------------------------------------------
# make.sh
#-----------------------------------------------------------
# run from 'python tools/nds/si/python/version_string_calculation.py' for GM case
#
# (version_string_calculation.py)
#
def get_letter_for_build_type(build_type):
    build_type_list=dict(sky_prod='P', 
                         sky_trials='U', 
                         sky_tpt='T', 
                         nds_si_devel='D',
                         cust_trials='C')

# sets per 'profiles'
#
      sky_trials )    ## for trials testing
        BUILD_TYPE=release_dbg
        PDL_SERVER=SKY_Trials
        PICASSO_BLD_TYPE=release-trials
        DIAG_BINARY_MODE=YES
        DIAG_PERFORMANCE_MODE=YES
        MEMPROF=YES
        ;;
      cust_trials )    ## for Sky customer testing 
        BUILD_TYPE=release_dbg
        PDL_SERVER=SKY_Production
        PICASSO_BLD_TYPE=release-trials
        DIAG_BINARY_MODE=YES
        DIAG_PERFORMANCE_MODE=YES
        ;;

# 
#
# "  -n, --no_app              build the middleware, but no application"
#
make -s     NDS_MW_PROJECT:=BSKYB_HD_PVR_SI     JAVA_APP_TO_BUILD:=picasso     JAVA_APP_ONLY:=     LAE_ONLY:=     NO_LAE:=     MEMMAN_TIMINGS:=0     MEMMAN_OUTPUT_ONCE:=YES     NDS_BUILD_ROOT:=/home/NDS-UK/parkkt/cc/parkkt_BSKYB_GM_001/vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/picasso     NDS_BUILD_PROJECT:=picasso     NDS_PLATFORM:=AMS_BCM_MIPS4K_LNUX_DARWIN_01     SQLITE_WANT_PROFILING:=YES     NDS_PLATFORM_ENDIAN:=BigEndian     NDS_FUSIONOS:=FUSIONOS_2     NDS_USE_CPP:=YES     NDS_LOCATION:=ST     

# -d | --debug_level. NDS_BUILD_TYPE_DEFAULT:="${BUILD_TYPE}". from profile sets
NDS_BUILD_TYPE_DEFAULT:=release_dbg     

PICASSO_BUILD_TYPE:=release     

# -o | --os_debug_level. NDS_OS_BUILD_TYPE:="${OS_BUILD_TYPE}". 'release' is default 
NDS_OS_BUILD_TYPE:=release     

NDS_CHECK_DEF:=NO     SQL_MEMMAN:=MEMOTHER3     NDS_CAROUSEL:=OTV     NDS_PROFILE:=XSI     DMS_ROOT:=/data/home/NDS-UK/parkkt/cc/parkkt_BSKYB_GM_001/vobs/DARWIN_PLATFORM/dms/build/integration/dms     VOB_ROOT:=/data/home/NDS-UK/parkkt/cc/parkkt_BSKYB_GM_001/vobs     NDS_INTERNAL_BUILD:=NO     DIAG_BINARY_MODE:=     DIAG_PERFORMANCE_MODE:=     DIAG_ENABLE_ALL_LEVELS:=     DIAG_RELEASE_MIL:=     USE_SYSINIT_CFG:=NO     MEMPROF:=NO     VOB_ROOT_UNIX:=/data/home/NDS-UK/parkkt/cc/parkkt_BSKYB_GM_001/vobs


#
# mesg when app build starts
#
make[2]: Entering directory `/data/home/NDS-UK/parkkt/cc/parkkt_BSKYB_GM_cust_trials/vobs/THIRD_PARTY_LIBRARIES/BSKYB_JTH/build/applications/java_common/build'
Project Root  /data/home/NDS-UK/parkkt/cc/parkkt_BSKYB_GM_cust_trials/vobs/..
JAVA_HOME Already set /data/home/NDS-UK/parkkt/cc/parkkt_BSKYB_GM_cust_trials/vobs/SYSTEM_BIN/jdk_1.6_linux
ANT_HOME Already set /home/NDS-UK/parkkt/cc/parkkt_BSKYB_GM_cust_trials/vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/tools/cots/ant
Buildfile: build.xml

#
# mesg when mw build ends.
#
Built picasso ams_bcm release_dbg cust_trials


#-----------------------------------------------------------
# make_processes
#-----------------------------------------------------------
(vobs\BUILD_SYSTEM\COMMON_MAKEFILES\process.mk)

# (from platform.mk)
# The following commands are used outside of this file.  Hence, the variable names do not
# contain "LOCAL_"
PLATFORM_STRIP := $(COMPILER_ROOT)/bin/$(MIPS)-linux-uclibc-strip


ifeq (YES,$(NDS_STRIP_PROCESS))
define LOCAL_PROCESS_STRIP_PROCESS
	$(COMMANDS_MKDIR) $(NDS_BUILD_ROOT)/$(NDS_PLATFORM)/$(NDS_PLATFORM_ENDIAN)/unstripped_processes
	$(COMMANDS_CP) $@ $(NDS_BUILD_ROOT)/$(NDS_PLATFORM)/$(NDS_PLATFORM_ENDIAN)/unstripped_processes/$(notdir $@)
    @echo Removing debug information from $@
	$(PLATFORM_STRIP) $@
endef
else
define LOCAL_PROCESS_STRIP_PROCESS
	$(COMMANDS_MKDIR) $(NDS_BUILD_ROOT)/$(NDS_PLATFORM)/$(NDS_PLATFORM_ENDIAN)/unstripped_processes
	$(COMMANDS_CP) $@ $(NDS_BUILD_ROOT)/$(NDS_PLATFORM)/$(NDS_PLATFORM_ENDIAN)/unstripped_processes/$(notdir $@)
endef
endif


Removing debug information from 
/data/home/NDS-UK/parkkt/cc/parkkt_BSKYB_GM_002/vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/
picasso/AMS_BCM_MIPS4K_LNUX_DARWIN_01/BigEndian/release_dbg/components/../processes/APP_Process

define LOCAL_PROCESS_COPY_TO_FILESYSTEM
   @echo Copying $@ to file system
   @echo "-be---------------------------"
   @echo "$(COMMANDS_CP) $(CP_OPTIONS) $@ $(NDS_BUILD_ROOT)/$(NDS_PLATFORM)/$(NDS_PLATFORM_ENDIAN)/fs/NDS/bin/$(notdir $@)"
   ls -al $(NDS_BUILD_ROOT)/$(NDS_PLATFORM)/$(NDS_PLATFORM_ENDIAN)/fs/NDS/bin
   @echo "-af---------------------------"
   $(COMMANDS_CP) $(CP_OPTIONS) $@ $(NDS_BUILD_ROOT)/$(NDS_PLATFORM)/$(NDS_PLATFORM_ENDIAN)/fs/NDS/bin/$(notdir $@)
   ls -al $(NDS_BUILD_ROOT)/$(NDS_PLATFORM)/$(NDS_PLATFORM_ENDIAN)/fs/NDS/bin
   @echo "------------------------------"
endef

Copying /data/home/NDS-UK/parkkt/cc/parkkt_BSKYB_GM_002/vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/picasso/AMS_BCM_MIPS4K_LNUX_DARWIN_01/BigEndian/release_dbg/components/../processes/APP_Process to file system
-be---------------------------
cp -bRL /data/home/NDS-UK/parkkt/cc/parkkt_BSKYB_GM_002/vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/picasso/AMS_BCM_MIPS4K_LNUX_DARWIN_01/BigEndian/release_dbg/components/../processes/APP_Process /data/home/NDS-UK/parkkt/cc/parkkt_BSKYB_GM_002/vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/picasso/AMS_BCM_MIPS4K_LNUX_DARWIN_01/BigEndian/fs/NDS/bin/APP_Process
total 8
drwxr-xr-x 2 parkkt ccusers 4096 Oct 20 13:47 .
drwxr-xr-x 4 parkkt ccusers 4096 Oct 20 13:47 ..
-af---------------------------
total 12164
drwxr-xr-x 2 parkkt ccusers     4096 Oct 20 13:47 .
drwxr-xr-x 4 parkkt ccusers     4096 Oct 20 13:47 ..
-rwxr-xr-x 1 parkkt ccusers 12428348 Oct 20 13:47 APP_Process
------------------------------


Copying /data/home/NDS-UK/parkkt/cc/parkkt_BSKYB_GM_002/vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/picasso/AMS_BCM_MIPS4K_LNUX_DARWIN_01/BigEndian/release_dbg/components/../processes/APP_Process to file system
-be---------------------------
cp -bRL /data/home/NDS-UK/parkkt/cc/parkkt_BSKYB_GM_002/vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/picasso/AMS_BCM_MIPS4K_LNUX_DARWIN_01/BigEndian/release_dbg/components/../processes/APP_Process /data/home/NDS-UK/parkkt/cc/parkkt_BSKYB_GM_002/vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/picasso/AMS_BCM_MIPS4K_LNUX_DARWIN_01/BigEndian/fs/NDS/bin/APP_Process
total 28272
drwxr-xr-x 2 parkkt ccusers     4096 Oct 20 13:50 .
drwxr-xr-x 5 parkkt ccusers     4096 Oct 20 13:50 ..
-rwxr-xr-x 1 parkkt ccusers 12428348 Oct 20 13:47 APP_Process
-rwxr-xr-x 1 parkkt ccusers  2235508 Oct 20 13:50 CA_Process
-rwxr-xr-x 1 parkkt ccusers 12622740 Oct 20 13:50 MW_Process
-rwxr-xr-x 1 parkkt ccusers  1608284 Oct 20 13:47 SCD_Process
-af---------------------------
total 40428
drwxr-xr-x 2 parkkt ccusers     4096 Oct 20 13:52 .
drwxr-xr-x 5 parkkt ccusers     4096 Oct 20 13:50 ..
-rwxr-xr-x 1 parkkt ccusers 12428428 Oct 20 13:52 APP_Process
-rwxr-xr-x 1 parkkt ccusers 12428348 Oct 20 13:47 APP_Process~
-rwxr-xr-x 1 parkkt ccusers  2235508 Oct 20 13:50 CA_Process
-rwxr-xr-x 1 parkkt ccusers 12622740 Oct 20 13:50 MW_Process
-rwxr-xr-x 1 parkkt ccusers  1608284 Oct 20 13:47 SCD_Process
------------------------------


#-----------------------------------------------------------
# make_image.sh
#-----------------------------------------------------------

SPK_VARIANT=debug
# will be override when use --variant

./make_image.sh --platform ams-drx595 --project picasso --profile "NDS_SI_Devel" 

make_image.sh
{
	# default values
	FULLSTACK="fullstack"
	SPK_VARIANT=debug


	function set_up_platform()
	{
		source /build/tools/nds/si/platform.sh
		{
			ams_595|ams-drx595)
	    	PLATFORM="ams-drx595"
      		NDS_ENDIAN="BigEndian"
      	
			# tools/nds/si/platform/ams-drx890/functions.sh 
			source "$SCRIPTS_PATH/platform/$PLATFORM/functions.sh
			{
				function platform_init() 
				{
					#
					# NDS_VOB_ROOT=/data/home/NDS-UK/parkkt/cc/parkkt_BSKYB_HZ001_01/vobs
					#
					NDS_PLATFORM=DARWIN_SKYDRX595_BCM97350_LNUX_01
					NDS_FUSIONOS_PATH=${NDS_VOB_ROOT}/FUSIONOS_5/BLD_${NDS_PLATFORM}
					  
					#
					NDS_FUSIONOS_INPUT_PATH=${NDS_VOB_ROOT}/FUSIONOS_INPUT_DEL_5/DEL_${NDS_PLATFORM}
					  
					NDS_FUSIONOS_OUTPUT_PATH=${NDS_VOB_ROOT}/FUSIONOS_OUTPUT_DEL_5/KERN_${NDS_PLATFORM}
					NDS_FUSIONOS_TOOLCHAIN_PATH=${NDS_FUSIONOS_PATH}/platform_cfg/linux/compiler/mips4k_gcc_x86_linux_hound
					SPK_TARBALL_DIR="${NDS_FUSIONOS_INPUT_PATH}/build_platform/spk/"
					SPK_TARBALL=`find "${SPK_TARBALL_DIR}" -maxdepth 1 -name darwin-spk-*.tar.bz2`
					OTV_TOOLS="${NDS_FUSIONOS_INPUT_PATH}/build_platform/image_generation"
					SPK_PLATFORM=ams-drx595
					 
					CDI_DRIVERS_TARBALL_DIR=${NDS_FUSIONOS_INPUT_PATH}/Tarball
					 
					NDS_DRIVERS_TARBALL_DIR=${NDS_FUSIONOS_INPUT_PATH}/Tarball
					CDI_DRIVERS_CONFIG_TARBALL_DIR=${NDS_FUSIONOS_INPUT_PATH}/build_platform/configs
					EOTV_IMAGE_OUTPUT=APPLI_0.FLA
					OTV_IMAGE=flash.out
					OTV_IMAGE_GEN_SCRIPT=generate-otv-image.sh
					OTV_IMAGE_GEN_TARBALL=image-generation-${SPK_PLATFORM}.tar.bz2
					IMAGE_INPUT_TO_GEN_SCRIPT=vmlinux
				}      	
			  }
      platform_init
		}
	} # function set_up_platform
	
	# vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/picasso/DARWIN_SKYDRX595_BCM97350_LNUX_01/BigEndian
	#
	# -rw-r--r--  1 parkkt ccusers 8036938 Apr 19 13:36 mw-epg-ams-drx595-debug-nds_si_devel.tar.bz2
	# -rw-r--r--  1 parkkt ccusers 8037073 Apr 19 11:41 mw-epg-ams-drx595-debug-sky_prod.tar.bz2
	#
	#
	# vobs/FUSIONOS_INPUT_DEL_5/DEL_DARWIN_SKYDRX595_BCM97350_LNUX_01/Tarball
	#
	# -r-xr--r-- 1 parkkt ccusers 2860009 Apr 12 16:17 cdi-drivers-ams-drx595-debug.tar.bz2*
	# -r--r--r-- 1 parkkt ccusers 1950345 Apr 12 16:17 cdi-drivers-ams-drx595-preprod.tar.bz2
	# -r--r--r-- 1 parkkt ccusers 1909451 Apr 12 16:17 cdi-drivers-ams-drx595-prod.tar.bz2
	# -r--r--r-- 1 parkkt ccusers 5478873 Apr 12 16:17 kernel-headers-ams-drx595-debug.tar.gz
	# -r--r--r-- 1 parkkt ccusers 5477086 Apr 12 16:18 kernel-headers-ams-drx595-preprod.tar.gz
	# -r--r--r-- 1 parkkt ccusers 5477524 Apr 12 16:18 kernel-headers-ams-drx595-prod.tar.gz
	# -r-xr-xr-x 1 parkkt ccusers   21349 Apr 12 16:17 nds-drv-ams-drx595-debug.tar.bz2*
	# -r-xr-xr-x 1 parkkt ccusers   21355 Apr 12 16:17 nds-drv-ams-drx595-preprod.tar.bz2*
	# -r-xr-xr-x 1 parkkt ccusers   15675 Apr 12 16:17 nds-drv-ams-drx595-prod.tar.bz2*
	# -r--r--r-- 1 parkkt ccusers   36305 Apr 12 16:18 service-centre-ams-drx595-debug.tar.bz2
	# -r--r--r-- 1 parkkt ccusers   36305 Apr 12 16:18 service-centre-ams-drx595-preprod.tar.bz2
	# -r--r--r-- 1 parkkt ccusers   36305 Apr 12 16:18 service-centre-ams-drx595-prod.tar.bz2
	#
	
	function check_input_tarballs()
	{
    MW_EPG_TARBALL_DIR=${OUTPUT}/${PROJECT}/${NDS_PLATFORM}/${NDS_ENDIAN}/
    
    # PROFILE
    MW_EPG_TARBALL=${MW_EPG_TARBALL_DIR}/mw-epg-${SPK_PLATFORM}-${SPK_VARIANT}-${PROFILE}.tar.bz2
    MW_EPG_WIPEOUT_TARBALL=${MW_EPG_TARBALL_DIR}/mw-epg-${SPK_PLATFORM}-${SPK_VARIANT}-${PROFILE}.wipeout.tar.bz2    
    MW_EPG_SPK_TARBALL_NAME=mw-epg-${SPK_PLATFORM}-${SPK_VARIANT}.tar.bz2
    
	# xtvfs and nvramfs.ko
    NDS_DRIVERS_TARBALL=${NDS_DRIVERS_TARBALL_DIR}/nds-drv-${SPK_PLATFORM}-${SPK_VARIANT}.tar.bz2

    CDI_DRIVERS_TARBALL=${CDI_DRIVERS_TARBALL_DIR}/cdi-drivers-${SPK_PLATFORM}-${SPK_VARIANT}.tar.bz2
    CDI_DRIVERS_CONFIG_TARBALL=${CDI_DRIVERS_CONFIG_TARBALL_DIR}/config-${SPK_PLATFORM}-${SPK_VARIANT}.tar.bz2
    SCS_BINARY_TARBALL=${CDI_DRIVERS_TARBALL_DIR}/service-centre-${SPK_PLATFORM}-${SPK_VARIANT}.tar.bz2

	# + MW_EPG_TARBALL_DIR=.../build/picasso/AMS_BCM_MIPS4K_LNUX_DARWIN_01/BigEndian/
	# + MW_EPG_TARBALL=.../build/picasso/AMS_BCM_MIPS4K_LNUX_DARWIN_01/BigEndian//mw-epg-ams-drx890-debug-cust_trials.tar.bz2
	# + MW_EPG_WIPEOUT_TARBALL=.../build/picasso/AMS_BCM_MIPS4K_LNUX_DARWIN_01/BigEndian//mw-epg-ams-drx890-debug-cust_trials.wipeout.tar.bz2
	# + MW_EPG_SPK_TARBALL_NAME=mw-epg-ams-drx890-debug.tar.bz2
	#
	} # function check_input_tarballs


	# untar spk
	set_up_spk
	{
		tar -C /home/NDS-UK/parkkt/cc/parkkt_BSKYB_HR004_002/vobs/FUSIONOS_INPUT_DEL_2/DEL_AMS_BCM_MIPS4K_LNUX_DARWIN_01/build_platform/spk/ -jxvf 
		/home/NDS-UK/parkkt/cc/parkkt_BSKYB_HR004_002/vobs/FUSIONOS_INPUT_DEL_2/DEL_AMS_BCM_MIPS4K_LNUX_DARWIN_01/build_platform/spk/darwin-spk-1.18-20111010.tar.bz2

		# output is:
		/home/NDS-UK/parkkt/cc/parkkt_BSKYB_HR004_002/vobs/FUSIONOS_INPUT_DEL_2/DEL_AMS_BCM_MIPS4K_LNUX_DARWIN_01/build_platform/spk/darwin-spk-1.18
	}

	function copy_packages() 
	{
	  pwd
	  rm -rvf "$SPK_PATH/dl/*nds*tar*"
	  rm -rvf "$SPK_PATH/dl/*cdi*tar*"

	  # Copy all the required packages
	  cp -f ${MW_EPG_TARBALL} ${SPK_PATH}/dl/${MW_EPG_SPK_TARBALL_NAME} || return $?
	  cp -f ${NDS_DRIVERS_TARBALL} ${SPK_PATH}/dl/ || return $?
	 
	  # darwin-spk-1.17 is made when do clean build.
	  # + SPK_PATH=.../vobs/FUSIONOS_INPUT_DEL_2/DEL_AMS_BCM_MIPS4K_LNUX_DARWIN_01/build_platform/spk/darwin-spk-1.17
	  # + SPK_PATH=.../vobs/FUSIONOS_INPUT_DEL_2/DEL_AMS_BCM_MIPS4K_LNUX_DARWIN_01/build_platform/spk/darwin-spk-1.17/dl
	}
}		



# called in set_up_spk
# get executed once when untarred so need to use clean option to make sure it's run to apply SI patches.
#
patch_spk()

if [ -d ${BUILD_ROOT}/spk_patches/${SPK_PLATFORM}/${SPK_VARIANT} ]; then
  SPK_VARIANT_PATCH_DIR=${BUILD_ROOT}/spk_patches/${SPK_PLATFORM}/${SPK_VARIANT}
echo "KT: ${SPK_VARIANT_PATCH_DIR}"
else
  echo "KT: not exist? ${BUILD_ROOT}/spk_patches/${SPK_PLATFORM}/${SPK_VARIANT}"
fi


SPK_VARIANT_PATCH_DIR=.../vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/spk_patches/ams-drx890/debug
SPK_PATCHES_DIR=.../vobs/FUSIONOS_INPUT_DEL_2/DEL_AMS_BCM_MIPS4K_LNUX_DARWIN_01/build_platform/spk/darwin-spk-1.17/patches


# before running configure, uptar and apply pactches on source and configs.
#
configure_spk()
# cust_trials case manually turning off SCS_FLAG
# if SCS FLAG is set to "" then it means that SCS has to be included
+ ./configure O=/home/NDS-UK/parkkt/cc/parkkt_BSKYB_HR004_002/vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/picasso/SPK/ams-drx890-debug ams-drx890 debug initramfs otv fullstack noconsole

# this is dest:
# /home/NDS-UK/parkkt/cc/parkkt_BSKYB_HR004_002/vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/picasso/SPK/ams-drx890-debug

* Buildroot Configuration
* Sky packages
Allow DNS requests/replies (BR2_PACKAGE_SKY_FIREWALL_ALLOW_DNS) [Y/n/?] y
* Kernel

# output from configurations
vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/picasso/SPK/ams-drx890-debug/.config

#-----------------------------------------------------------
# make_image.sh: build-kernel-configs
#-----------------------------------------------------------
# This script creates bootloadable images.
#
# SPK_VARIANT=debug(default)
#
# output, should rename it for usb flashing
# picasso/AMS_BCM_MIPS4K_LNUX_DARWIN_01/BigEndian/image/OTV/APPLI_0.FLA.nds_si_devel -> image\OTV\APPLI_0.FLA
# vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/picasso/AMS_BCM_MIPS4K_LNUX_DARWIN_01/BigEndian/drivers

There are 3 types of kernel or variant:
prod      - Only suitable for a production release of the software
preprod   - Production kernel with a minimum of tools to enable some trace info to be extracted
debug     - Development kernel suitable for component teams and SI to investigate issues

# from make_img log
#`target/device/Sky/ams-drx595/kernel-debug.config' -> `/home/NDS-UK/parkkt/cc/parkkt_BSKYB_HZ001_03
# /vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/picasso/SPK/ams-drx595-debug/project_build_mips/ams-drx595/linux-2.6.18.8/.config'

#*
#* Linux Kernel Configuration
#*
#Linux Kernel Configuration
#> 1. .config file (BR2_PACKAGE_LINUX_USE_KCONFIG)
#  2. Run make <board>_defconfig  (BR2_PACKAGE_LINUX_USE_DEFCONFIG)
#  3. Run make ARCH=$(ARCH) [xconfig|menuconfig] before build (BR2_PACKAGE_LINUX_USE_XCONFIG)
#choice[1-3?]: 1
#.config file (BR2_PACKAGE_LINUX_KCONFIG) [target/device/Sky/ams-drx595/kernel-preprod.config] target/device/Sky/ams-drx595/kernel-preprod.config

# vobs\FUSIONOS_INPUT_DEL_5\DEL_DARWIN_SKYDRX595_BCM97350_LNUX_01\build_platform\spk\darwin-spk-1.17 will be created once the build is done previously.
#
vobs\FUSIONOS_INPUT_DEL_5\DEL_DARWIN_SKYDRX595_BCM97350_LNUX_01\build_platform\spk\darwin-spk-1.17\target\device\Sky\ams-drx595\

-rw-r--r-- 1 parkkt ccusers 21178 Apr 21  2010 buildroot-debug.config
-rw-r--r-- 1 parkkt ccusers 20729 Apr 21  2010 buildroot-preprod.config
-rw-r--r-- 1 parkkt ccusers 20658 Mar 16 13:33 buildroot-prod.config
-rw-r--r-- 1 parkkt ccusers 24587 Aug 25  2009 busybox-debug.config
-rw-r--r-- 1 parkkt ccusers 26031 Feb  1  2010 busybox-preprod.config
-rw-r--r-- 1 parkkt ccusers 26173 Feb  1  2010 busybox-prod.config
-rwxrwxr-x 1 parkkt ccusers  7631 Feb 10 13:29 cdi_device_table.txt
-rw-r--r-- 1 parkkt ccusers  2074 Jul 26  2010 device_table.txt
-rw-r--r-- 1 parkkt ccusers 22542 Jan 17 15:33 kernel-debug.config
drwxr-xr-x 2 parkkt ccusers  4096 Jan 28 13:13 kernel-patches
-rw-r--r-- 1 parkkt ccusers 21978 Jan 17 15:33 kernel-preprod.config
-rw-r--r-- 1 parkkt ccusers 21897 Jan 17 15:33 kernel-prod.config
drwxr-xr-x 5 parkkt ccusers  4096 Jan 28 13:13 rootfs


Build outputs at:-
  .../build/picasso/SPK/ams-drx595-prod/binaries/ams-drx595
total 53M
-rwxrwxrwx 1 parkkt ccusers  50K Mar 18 14:56 rootfs.mips.initramfs_list
-rw-r--r-- 1 parkkt ccusers  11M Mar 18 14:57 rootfs.mips.squashfs
-rwxrwxrwx 1 parkkt ccusers  23M Mar 18 14:57 rootfs.mips.tar
-rwxrwxrwx 1 parkkt ccusers  10M Mar 18 14:57 rootfs.mips.tar.bz2
-rwxr-xr-x 1 parkkt ccusers 9.8M Mar 18 14:57 vmlinux


SPK path: 
vobs/FUSIONOS_INPUT_DEL_5/DEL_DARWIN_SKYDRX595_BCM97350_LNUX_01/build_platform/spk/darwin-spk-1.17/

OUTPUT path:
\FUSION_SYSTEM_INTEGRATION\BSKYB_INTEGRATION\build\picasso\SPK\ams-drx890-debug\project_build_mips\ams-drx890\linux-2.6.18.8\include\asm-mips\ucontext.h
vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/picasso/SPK/ams-drx595-prod/project_build_mips/ams-drx595/
vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/picasso/SPK/ams-drx595-debug/project_build_mips/ams-drx595/root/lib/

actuall config file:
vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/picasso/SPK/ams-drx595-prod/project_build_mips/ams-drx595/linux-2.6.18.8/.config

#-----------------------------------------------------------
# build-extra-libs
#-----------------------------------------------------------
# don't know how this script gets run during the build.
#
# vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/picasso/AMS_BCM_MIPS4K_LNUX_DARWIN_01/BigEndian/copy_drivers.sh

FUSIONOS_2/BLD_AMS_BCM_MIPS4K_LNUX_DARWIN_01/platform_cfg/linux/BigEndian/release/Modules/cdi-drivers-ams-drx890-debug.tar.bz2
FUSIONOS_2/BLD_AMS_BCM_MIPS4K_LNUX_DARWIN_01/platform_cfg/linux/BigEndian/release/Scripts/jhmknods_nds.sh
FUSIONOS_2/BLD_AMS_BCM_MIPS4K_LNUX_DARWIN_01/platform_cfg/linux/BigEndian/release/Scripts/supershell
FUSIONOS_2/BLD_AMS_BCM_MIPS4K_LNUX_DARWIN_01/platform_cfg/linux/BigEndian/release/Scripts/libforcesched.so
FUSIONOS_2/BLD_AMS_BCM_MIPS4K_LNUX_DARWIN_01/platform_cfg/linux/BigEndian/release/Scripts/libmutex-desched.so
FUSIONOS_2/BLD_AMS_BCM_MIPS4K_LNUX_DARWIN_01/platform_cfg/linux/BigEndian/debug/BootImage/vmlinux
FUSIONOS_2/BLD_AMS_BCM_MIPS4K_LNUX_DARWIN_01/platform_cfg/linux/BigEndian/release/lib/mhxnvramfs.ko
FUSIONOS_2/BLD_AMS_BCM_MIPS4K_LNUX_DARWIN_01/platform_cfg/linux/BigEndian/release/lib/xtvfs.ko
FUSIONOS_2/BLD_AMS_BCM_MIPS4K_LNUX_DARWIN_01/platform_cfg/linux/BigEndian/release/lib/xtvfs_format
FUSIONOS_2/BLD_AMS_BCM_MIPS4K_LNUX_DARWIN_01/platform_cfg/linux/compiler/mips4k_gcc_x86_linux_hound/mips-linux-uclibc/lib/libgcc_s.so
FUSIONOS_2/BLD_AMS_BCM_MIPS4K_LNUX_DARWIN_01/platform_cfg/linux/BigEndian/release/Scripts/wipe_nvram


############################################################
## CFE-OTV
############################################################

#-----------------------------------------------------------
# from-otv-to-cfe (from http://hoover.uk.nds.com/fusionmadesimple/index.php/RunGaudi)
#-----------------------------------------------------------
# copy it onto usb stick
\\ukstore4.UK.NDS.COM\Data2\SystemsIntegration\Tools\BCM studio\ams890\cfe\cfe_be_bseck_v2.9_svn451.bin

# rename it to 'bootload.fla'
# Place it under root directory of USB.
# Plug it to STB and reboot.
# wait for around 2 minutes, till blue LEDs stop rotating / glowing.
# unplug USB and reboot the box 

# cfe version
BCM97335B0 CFE v2.9, CFE core v2.5, SVN $Rev: 451 $, Endian Mode: Big
Build Date: Tue Aug  4 18:08:48 GMTDT 2009 (MorelAnt@BRWLT0109457)
Copyright (C) Broadcom Corporation.

#-----------------------------------------------------------
# from-cfe-to-otv (from http://hoover.uk.nds.com/fusionmadesimple/index.php/RunGaudi)
#-----------------------------------------------------------
# copy it onto linux server
\\ukstore4.UK.NDS.COM\Data2\SystemsIntegration\Tools\BCM studio\ams890\opentv\bl_eng_signed_00_09.bin

# from cfe
ifconfig eth0 -auto

# pc 
flash -noheader 172.18.200.140:/bl_eng_signed_00_09.bin flash0.cfe

# ukstbuild02
flash -noheader 172.18.253.143:/parkkt/890/bl_eng_signed_00_09.bin flash0.cfe



############################################################
## DICT
############################################################

#-----------------------------------------------------------
# dict-make
#-----------------------------------------------------------
# STEP-01: extract possible dict entries from successful logs. If possible, make sure using right diag.ctl for shortened diag
# output messages.
egrep -an -A 100 --colour=always | less -r

egrep -an --colour=always "(magnum|AFFIRM|HALT|Segmentation Fault|Runtime.exit|MEMMAN)"
egrep -an --colour=always "(AFFIRM|HALT|Segmentation Fault|Runtime.exit)"
egrep -an --colour=always "(AFFIRM|HALT|Segmentation Fault|Runtime.exit|MEMMAN)"
egrep -an --colour=always "(magnum)"
egrep -an "(\!ERROR|\!FATAL|\!WARN|magnum)"
egrep -an "(\!ERROR|\!FATAL|\!WARN|KEY_PRESS)"

# to see starting time from hudson log
egrep -an -A 1 --colour=always "(Starting test)"

egrep -an "SIM_SDT_ACQUISITION_Start\(0x00000000\)"
egrep -a "(-G_Sess|-SQ|-SFM|-J_GUIDE|AFFIRM|HALT)"
egrep -a "[^(G_Sess|SQ|SFM)]"
egrep -a "^[^\+]" ext.ext.log > ext.ext.ext.log
egrep -a '(magnum|cdi|callisto|cal_)' LOG-VI.log > input.dic


egrep -an '_FUNCTION_' LOGlast | grep --colour=always 'took' | cut -f 4 -d']' | cut -f 3 -d' ' | more

# cut
egrep estimated MEM574.TXT | cut -f 4 -d' ' | cut -f 1 -d'/' > memout.txt

# to rid time info in a hudson log
sed 's/^\[.*\]\s//' dic-at01-pass-hudson.dic > dic-at01-pass-hudson.out

# STEP-02: examine if there are any corrupted lines in the extracted via step one.

#
# STEP-03: remove duplicates using 'sort' command depending on diag output format as below.
#
NDS: ^0946684946.752246 !ERROR -aem          < M:aem_list.c F:AEM_ListGetApplicationByInviteHandle L:01808 > Can't find it in the ap
-1-- ----------2------- ---3-- -4--         -5 ------6----- -------------------7------------------ ---8--- 9 -10--

sort -u -k 4,10 ndsfusion.test > ndsfusion.dic 

NDS: ^0946684843.171913 !WARN  -MEMMAN       < p:0000008b t:01063b50 T:SIM_LCC_THREAD M:memman_pinit.c F:PoolCreate L:00316 > Memory 
-1-- ----------2------- ---3-- -4--         -5 ------6--- ----7----- ------8--------- -----9---------- -----10----- --11--- 12 -13-- 

sort -u -k 4,13 ndsfusion.test > ndsfusion.dic 

# STEP-04: run 'deldup.py input.dic main.dic' which will make 'input.dic.uniq'. this output file shows unique entries or duplicates.
#

# STEP-05: extract unique entries from 'input.dic.uniq' and add them into the 'main.dic' as follows
#
egrep '^[^#]' input.dic.uniq >> main.dic
sort -u -k 4,14 main.dic

# use this as don't use free string after '>'
sort -u -k 4,7 main.dic


# for use temp dic
ndsmatch-two dict log

# for use fusion.dic
ndsmatch log

############################################################
## FUSION
############################################################

#-----------------------------------------------------------
# fusion-build (picasso)
#-----------------------------------------------------------
# 1) case 'build_mw_epg.sh'
#
# - snippet from the end of running
#
# Creating middleware epg package
#./
#./etc/
#./etc/start-mw.sh
#./NDS/
#./NDS/bin/
#./NDS/bin/SCD_Process
#./NDS/bin/MW_Process
#./NDS/bin/APP_Process
#./NDS/bin/CA_Process
#./NDS/config/
#./NDS/config/diagctl.cfg
#./NDS/config/fusion_os_storage_labels.cfg
#./NDS/config/guide_cms_cde.cfg
# ( snipped...)
#./NDS/config/oigc.cfg
#./NDS/lib/
#./NDS/lib/picasso.jar
#./NDS/lib/adaptors.jar
#./NDS/lib/common.jar
#./NDS/etc/
#./NDS/etc/sysinit.cfg
#./NDS/classes
#./NDS/Fonts/
#./NDS/Fonts/Zurich.ttf
#./usr/
#./usr/lib/
#./usr/lib/libforcesched.so
# 
#
# ! this is 'stripped/picasso-skelmir_ocap-djpa-zapper_strip_optim.jar'. that is 'stripped' release.
#
#
# once building done, use 'build output' directly as below
#
# mount -t nfs 172.18.253.143:/home/NDS-UK/parkkt/cc/parkkt_BSKYB_HZ001_01/vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/picasso/DARWIN_SKYDRX595_BCM97350_LNUX_01/BigEndian /host
#
# [parkkt@ukstbuild02 build]$ ls picasso/DARWIN_SKYDRX595_BCM97350_LNUX_01/BigEndian/
# bootscript       engines                          mw-epg-ams-drx595-debug-nds_si_devel.tar.bz2  unified_startup.sh
# components       fs                               netcat.py                                     unified_stop7401.sh
# config           get_APP_Process_link_options.mk  picasso_sublibraries_options.mk               unified_stop.sh
# copy_drivers.sh  get_CA_Process_link_options.mk   processes                                     unstripped_processes
# dms              get_MW_Process_link_options.mk   run
# drivers          get_SCD_Process_link_options.mk  unified_startup_7401c1.sh
# 
# then use 'unifiled_startup.sh'
#
# =================================
# 2) case 'picasso_flash_H1.sh'
# =================================
# ./picasso_flash_H1.sh -b ams_drx595 -p stripped_optim -s nds
# ./picasso_flash_H1.sh -b ams_drx595 -p debug
# (-s nds is default)
# 
# - there are *five* picasso files used by '-p' option: 'debug', 'full', 'obfuscated', 'stripped' and 'stripped_optim'.
# - copy jar file depending on '-p' from:
#   vobs/THIRD_PARTY_LIBRARIES/BSKYB_JTH/build/applications/Picasso/picasso/Picasso/dist/release/STB/
#   	debug  full  obfuscated  stripped
#
#   to:
#   vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/picasso/DARWIN_SKYDRX595_BCM97350_LNUX_01/BigEndian/fs/NDS/lib/
#   	picasso.jar
#
#   !Note: the script will rename it to 'picasso.jar'
#
# - run $BUILDHOME/tools/misc/genflash.sh
#
#    For example:
#    OUT_DIR_GAUDI= 
#    /data/home/NDS-UK/parkkt/cc/parkkt_BSKYB_GM_001/vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/picasso/AMS_BCM_MIPS4K_LNUX_DARWIN_01/BigEndian
# -- genflash: create tmp_flash0 and cd to it. e.g. ../build/tmp_flash0
# -- genflash: create /tmp_flash0/fs/NDS, drivers and scripts
# -- genflash: cp $BUILDHOME/tools/release/startstack.sh to /tmp/$USER/flash0/scripts
# -- genflash: cp $VERBOSE $BOOTSCRIPT_LOC .
# -- genflash: cp $VERBOSE ${OUT_DIR_GAUDI}/nvram.bin ./
# -- genflash: cp $VERBOSE -a ${OUT_DIR_GAUDI}/fs/NDS/* ./fs/NDS/ 	# will copy stripped images as these are different from unstripped_processes/
# -- genflash: cp $VERBOSE ${OUT_DIR_GAUDI}/drivers/* ./drivers/
# -- genflash: cp $VERBOSE ${OUT_DIR_GAUDI}/unified_startup.sh ./scripts/
# -- genflash: echo >./scripts/this_is_first_boot
# -- genflash: echo >./this_is_${PLATFORM}_install
# -- genflash: make 'stripped' mw image  # Q: run stip command again on already stripped images?
# -- genflash: tar czf flash0.tar.gz flash0 unstripped_bin  
# -- genflash: cp flash0.tar.gz to $BUILDHOME
# -- genflash: rm /tmp/$USER/flash0
#
# - untar flash0.tar.gz to 'vobs/flash0'
#
# - mount -t nfs 172.18.253.143:/home/NDS-UK/parkkt/cc/parkkt_BSKYB_HZ001_01/vobs/flash0 /flash0
# - run 'startstack.sh' in /flash0/scripts


#-----------------------------------------------------------
# fusion-startstack-sh (595)
#-----------------------------------------------------------
# if [ -f /flash0/scripts/this_is_first_boot ]
# then
#     rm /flash0/scripts/this_is_first_boot
#     echo "This is first boot; enable format"
#     /flash0/scripts/unified_startup.sh . /flash0 FORMAT $SERIAL $* -> effectively use only FORMAT
# else
#     echo "Reboot app - keeping recordings and data"
#     /flash0/scripts/unified_startup.sh . /flash0 NOCLEAN NODELETE $SERIAL $* -> effectively use NOCLEAN
# fi
#


#-----------------------------------------------------------
# fusion-unified-startup-sh (890)
#-----------------------------------------------------------

# unified_startup.sh FORMAT NORUN
#
# In sum, 
# FORMAT will format sda or delete db and recordings
# NORUN will setup env for MW or for test env.
#
# 1. copy xtvfs_format on to box:/usr/bin (actually not used)
# 2. make dirs. no effect appart from /NDS
# 3. untar driver file on to box:/. This includes ko and script files:
#        etc/bumpup.cfg
#        etc/load-cdi-drivers.sh
#        lib/modules/2.6.18.8/callisto_drx890.ko
#        lib/modules/2.6.18.8/callisto_periph.ko
#        lib/modules/2.6.18.8/callisto_tuner.ko
# 
# 4. run /etc/load-cdi-drivers.sh, nfs:/drivers/xtvfs.ko, nfs:/drivers/jhmknods_nds.sh, and nfs:/drivers/mhxnvramfs.ko
#    if NOCLEAN=false(default), populate nvram?.bin to /dev/nds/nvram[01].bin. (actually no effect since no nvram?.bin in nfs.)

# 5. if FORMAT=true, delete /dev/sda3,4 (no effect since there aren't 3, 4 partiiton in a box)
# 6. if FORMAT=true, delete /dev/sda1,2. create /dev/sda1 with FAT12 and format it using xtvfs_format. formatting xtvfs will create own file and dirs.
# 7. if NOCLEAN=false(default), delete /dev/sda1/FSN_DATA/* for dbs and /dev/sda1/* for recodring. Actually, has an effect only when not use FORMAT.
# 8. copy nfs:/fs/NDS/* on to /NDS
# 9. mount sysfs on /sys (no effect since already done after boot)
# 10. copy nfs:/drivers/libs on to /usr/lib, run /etc/bumpup.sh (no effect), delete /tmp/* and /fifo/*
#
# Once system loaded, see that there are fs mounded. Done by MW?
#   /dev/nds/nvram0 on /mnt/nds/dev_2/part_0 type MHNVRAMFS (rw,nosuid)
#   /dev/sda1 on /mnt/nds/dev_5/part_0 type xtvfs (rw,nosuid)
 

#-----------------------------------------------------------
# fusion-unified-startup-sh (595)
#-----------------------------------------------------------
# FORMAT calls 'delete_flash_partition' which is:
# 	flash_eraseall /dev/mtd1
#
# By default, NOCLEAN is false then wipe_nvram called.
#
# NOCLEAN will skip wipe_nvram calls.


#-----------------------------------------------------------
# fusion-boot (from image flashing)
#-----------------------------------------------------------
# /etc/init.d/rcS
# NOTE FOR 595: there is no jhmknods_nds.sh in /etc but there are nodes under /dev/nds when use 27 baseline kernel. 
#             : however, when use kernel img with baselise above 3x, there are no nodes under /dev/nds after bootup.
if [ -e /etc/load-cdi-drivers.sh ]; then
   /etc/load-cdi-drivers.sh
fi
if [ -e /etc/jhmknods_nds.sh ]; then
   /etc/jhmknods_nds.sh
fi
if [ -e /etc/bumpup.sh ]; then
   /etc/bumpup.sh
fi
if [ -e /etc/start-scs.sh ]; then
   /etc/start-scs.sh
fi
if [ -e /etc/load-nds-drivers.sh ]; then
   /etc/load-nds-drivers.sh
fi
if [ -e /etc/start-support.sh ]; then
    /etc/start-support.sh
fi                          
if [ -e /etc/start-mw.sh ]; then
    /etc/start-mw.sh
fi

# 890 case
sh-3.2# ls /etc/*.sh
/etc/load-cdi-drivers.sh  /etc/setup-firewall.sh    /etc/start-scs.sh
/etc/load-nds-drivers.sh  /etc/start-mw.sh

# start-mw.sh
mkdir -p /mnt/nds/disk/FSN_DATA && mount -t tmpfs none /mnt/nds/disk/FSN_DATA -o ro
killall udhcpc || true
cd /tmp
export LD_PRELOAD=/usr/lib/libforcesched.so:/lib/libresolv-refresh.so:/lib/libifnameindex.so
/NDS/bin/SCD_Process


# start-mw.sh (sidevel when bootlog is on)
#
[parkkt@ukstbuild02 x]$ cat etc/start-mw.sh   
#!/bin/sh
ulimit -c unlimited
echo
echo "###########"
echo "# Bootlog #"
echo "###########"
echo
/usr/bin/bootlog.sh 15 1024 upload
echo
echo "##########################"
echo "# Loading NDS middleware #"
echo "##########################"
echo
echo "####################################"
echo "# Middleware starting in 5 seconds #"
echo "# Hit ctrl-C to cancel             #"
echo "####################################"
echo
stty brkint
sleep 5 || exit
mkdir -p /mnt/nds
chgrp NDS_MW /mnt/nds
chown NDS_U2 /mnt/nds
mkdir -p /mnt/nds/disk/FSN_DATA && mount -t tmpfs none /mnt/nds/disk/FSN_DATA -o ro
killall udhcpc || true
mkdir /mnt/nds/tmp
mount /dev/sda1 /mnt/nds/tmp
if [ -f mnt/nds/tmp/FSN_DATA/UPNPUAID ]; then
    UAID=`grep USERAGENTID= mnt/nds/tmp/FSN_DATA/UPNPUAID | sed s/USERAGENTID=//`
    echo "######################"
    echo "Changing UPNP Agent ID"
    echo "######################"
    sed -i "s/FILTERING_ENABLED.*/FILTERING_ENABLED=TRUE/" /NDS/config/libupnp.cfg
    sed -i "s/PRODUCTNAME=.*/PRODUCTNAME=\"$UAID\"/" /NDS/config/libupnp.cfg
    sed -i "s/PRODUCTNAME_FILTER=.*/PRODUCTNAME_FILTER=\"$UAID\"/" /NDS/config/libupnp.cfg
fi
umount /mnt/nds/tmp
rmdir /mnt/nds/tmp
cd /NDS/config
/NDS/bin/FusionConfigImport CFG2BIN ./ *
cd /tmp
export LD_PRELOAD=/usr/lib/libforcesched.so:/lib/libresolv-refresh.so:/lib/libifnameindex.so
/NDS/bin/SCD_Process

# see /usr/lib on the box
ld-uClibc-0.9.29.so     libext2fs.so.2          libresolv.so.0
ld-uClibc.so.0          libext2fs.so.2.4        librt-0.9.29.so
libblkid.so             libgcc_s.so             librt.so.0
libblkid.so.1           libgcc_s.so.1           libss.so
libblkid.so.1.0         libifnameindex.so       libss.so.2
libc.so.0               libm-0.9.29.so          libss.so.2.0
libcom_err.so           libm.so.0               libthread_db-0.9.29.so
libcom_err.so.2         libncurses.so           libthread_db.a
libcom_err.so.2.1       libncurses.so.5         libthread_db.so
libcrypt-0.9.29.so      libncurses.so.5.6       libthread_db.so.1
libcrypt.so.0           libnsl-0.9.29.so        libuClibc-0.9.29.so
libdl-0.9.29.so         libnsl.so.0             libutil-0.9.29.so
libdl.so.0              libproc-3.2.7.so        libutil.so.0
libe2p.so               libpthread-0.9.29.so    libuuid.so
libe2p.so.2             libpthread.so.0         libuuid.so.1
libe2p.so.2.3           libresolv-0.9.29.so     libuuid.so.1.2
libext2fs.so            libresolv-refresh.so    modules

#-----------------------------------------------------------
# fusion-run-595
#-----------------------------------------------------------

# mtd devices
sh-3.2# cat /proc/mtd 
dev:    size   erasesize  name
mtd0: 0f800000 00020000 "rootfs"
mtd1: 0ff00000 00020000 "all"
mtd2: 00400000 00020000 "kernel"
mtd3: 00400000 00020000 "cfe"
mtd4: 03c00000 00020000 "nor"

# to use a kernel only env.
udhcpc
mkdir /host
mount -t nfs 172.18.253.143:/home/NDS-UK/parkkt/cc/parkkt_BSKYB_HZ001_01/vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/picasso/DARWIN_SKYDRX595_BCM97350_LNUX_01/BigEndian /host
cd /host
./unified_startup.sh . /host NORUN
LD_PRELOAD=/usr/lib/libforcesched.so /NDS/bin/SCD_Process

# to use flash. must use /flash0 since it's fixed in startstack.sh to call others.
mkdir /flash0
mount -t nfs 172.18.253.143:/home/NDS-UK/parkkt/cc/parkkt_BSKYB_HZ001_01/vobs/flash0 /flash0
/flash0/scripts/startstack.sh


# FOSH
mount -t nfs 172.18.253.143:/home/NDS-UK/parkkt/fob/595/fosh/Darwin97350_BE/debug/FOSH/NDS /NDS

*******************************************************************************
* Driver Version : 7340_Rev 680 for darwin-spk-1.17 debug built 29-03-2011
*******************************************************************************


#-----------------------------------------------------------
# fusion-run-890
#-----------------------------------------------------------

# as of 13th may 2011
#
sh-3.2# more /etc/start-mw.sh 
#!/bin/sh
echo 
echo "Wiping the disk, /dev/nds/nvram0 and /dev/nds/nvram1"
echo o,n,p,1,,,t,1,c,p,w | sed 's/,/\n/g' | fdisk /dev/sda
/usr/bin/xtvfs_format /dev/sda1 p
dd if=/dev/zero of=/dev/nds/nvram0 count=46
dd if=/dev/zero of=/dev/nds/nvram1 count=16
sync
echo "####################################################"
echo "FORMAT DONE! REMOVE USB & RE-FLASH FULLSTACK IMAGE!!"
echo "####################################################"
sleep 2
sh-3.2#                         


# to use with kernel only env.
udhcpc
mkdir /host
mount -t nfs 172.18.253.143:/home/NDS-UK/parkkt/cc/parkkt_BSKYB_GM_01/vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/picasso/AMS_BCM_MIPS4K_LNUX_DARWIN_01/BigEndian /host
cd /host
./unified_startup.sh . /host FORMAT NORUN
./unified_startup.sh . /host NORUN
LD_PRELOAD=/usr/lib/libforcesched.so /NDS/bin/SCD_Process
LD_PRELOAD=/NDS/lib/cdi_tracker.so /usr/lib/libforcesched.so /NDS/bin/SCD_Process
LD_PRELOAD=/NDS/lib/cdi_tracker.so /usr/lib/libfollrcesched.so /NDS/bin/SCD_Process_us
LD_PRELOAD=/usr/lib/cdi_tracker.so /usr/lib/libforcesched.so /usr/lib/libresolv-refresh.so /usr/lib/libifnameindex.so /NDS/bin/SCD_Process


# tail
script -c "telnet 172.18.201.54" `date +%Y-%m-%d-%k-%M`.log
tail -f /mnt/nds/dev_5/part_0/FSN_DATA/LOG

mkdir /mnt/temp
mount -t nfs 172.18.253.143:/home/NDS-UK/parkkt/fob/890/24206 /mnt/temp
cp /mnt/nds/dev_5/part_0/FSN_DATA/LOG /mnt/temp/
chmod 777 /mnt/temp/LOG 

#-----------------------------------------------------------
# fusion-nvram
#-----------------------------------------------------------
# Once system loaded, done ls on nvramfs:
-rwxrwxrwx    1 root     root          112 Jan  1  1970 99
-rwxrwxrwx    1 root     root          467 Jan  1  1970 dt
-rwxrwxrwx    1 root     root            0 Jan  1  1970 f0
-rwxrwxrwx    1 root     root           27 Jan  1  1970 fv
-rwxrwxrwx    1 root     root            0 Jan  1  1970 lc
-rwxrwxrwx    1 root     root          959 Jan  1  1970 mp
-rwxrwxrwx    1 root     root          670 Jan  1  1970 nv

hexdump -C nv


#-----------------------------------------------------------
# fusion-flash
#-----------------------------------------------------------
# flash0.tar.gz (made from 'release_flash0.sh' command)
# copy and untar it to mount point, e.g., ~/fob/nfsmnt/. this will have:
# note that '/flash0' is the mount point to /host in the box and this is pre-defined and will be used in 'startstack.sh'.
.
|-- flash0 (** this is mount point **)
(780 case)
|   |-- bootscript
|   |-- drivers
|   |   |-- cdi-drivers-ams-drx780-debug.tar.bz2
|   |   |-- cdi_tracker.so
|   |   |-- cnxt_base_drv.ko
|   |   |-- cnxt_cdi.ko
|   |   |-- cnxt_kernel_kal.ko
|   |   |-- dms_delete_partitions.sh
|   |   |-- kernel
|   |   |-- libforcesched.so
|   |   |-- libgcc_s.so
|   |   |-- mhxnvramfs.ko
|   |   |-- restricted_setmod_cnxt_cdi_insmod.sh
|   |   |-- rootfs.arm.squashfs
|   |   |-- setmod_cnxt_cdi_insmod.sh
|   |   |-- unified_startup.sh
|   |   |-- unified_startup.sh~
|   |   |-- unified_stop.sh
|   |   |-- unified_stop.sh~
|   |   |-- wipe_nvram
|   |   |-- xtvfs.ko
|   |   `-- xtvfs_format

(890 case)
|   |-- bootscript
|   |-- drivers
|   |   |-- cdi-drivers-ams-drx890-debug.tar.bz2
|   |   |-- jhmknods_nds.sh
|   |   |-- kernel
|   |   |-- libforcesched.so
|   |   |-- libgcc_s.so
|   |   |-- libmutex-desched.so
|   |   |-- mhxnvramfs.ko
|   |   |-- supershell
|   |   |-- unified_startup.sh
|   |   |-- unified_stop.sh
|   |   |-- xtvfs.ko
|   |   `-- xtvfs_format

|   |-- fs
|   |   `-- NDS
|   |       |-- bin
|   |       |   |-- APP_Process
|   |       |   |-- CA_Process
|   |       |   |-- MW_Process
|   |       |   |-- SCD_Process
|   |       |   |-- xtvfs_format
|   |       |-- config
|   |       |   |-- MS.CFG
|   |       |   |-- diag.cfg
|   |       |   |-- diagctl.cfg
|   |       |   |-- ...
|   |       |   `-- words.eng
|   |       `-- etc
|   |           `-- sysinit.cfg
|   |-- scripts
|   |   |-- startstack.sh
|   |   `-- unified_startup.sh
|   `-- this_is_ams_nxp_install

`-- unstripped_bin
    |-- APP_Process
    |-- CA_Process
    |-- MW_Process
    |-- SCD_Process
    |-- xtvfs_format
    `-- xtvfs_format~


# nfs on ukstbuild02
# mkdir /flash0
# mount -t nfs 172.18.253.143:/home/NDS-UK/parkkt/fob/890/nfs/flash0 /flash0
# run
#./flash0/scripts/startstack.sh



############################################################
## DIAG and TRACKER
############################################################

#-----------------------------------------------------------
# diag-mesg
#-----------------------------------------------------------

# FRAME_PRESENTED
#
!MIL   -MPM          < T:MPM_PROXYMONITOR_THREAD M:mpm_component_video.c F:MPMComponentVideoFramePresentedHandler L:00652 > FRAME_PRESENTED: hMC=6

# FRAME_DECODED
#
!INFO  -MPM          < T:MPM_ITCMAIN_THREAD M:mpm_pres_video_control.c F:MPM_PresHandleVideoDecoderBufferLowEvent L:01577 > FRAME_DECODED on decoder 0

# TransponderId
#
!MIL   -UAMC         < p:00000076 t:00b1a6c0 T:PLAYER_MAIN M:live_pbag.c F:Live_Pbag_Print L:00980 > UAM LIVE EVENT PROGRAM_OPEN
!MIL   -UAMC         < p:00000076 t:00b1a6c0 T:PLAYER_MAIN M:live_pbag.c F:Live_Pbag_Print L:00985 > Live params: NetworkId=0x00000002, TransponderId=0x000007F9 ServiceId=0x000023FB

OR

!MIL   -UAMC         < p:00000076 t:00b1a6c0 T:PLAYER_MAIN M:live_pbag.c F:Live_Pbag_Print L:00984 > UAM_DCM_PARAM_DATA_TYPE_PROGRAM_OFF
!MIL   -UAMC         < p:00000076 t:00b1a6c0 T:PLAYER_MAIN M:live_pbag.c F:Live_Pbag_Print L:00985 > Live params: NetworkId=0x00000002, TransponderId=0x000007F9 ServiceId=0x000023FB


# KEY_PRESS
#
!MIL   -aem          < p:00000076 t:00c47b40 T:AEM_INPUT_MONITOR_THREAD M:aem_userinput.c F:AEM_InputMonitorThread L:00429 > KEY_PRESS: code=0xe007

# DECODER_STARTED and DECODER_STOPPED:
#
!MIL   -MPM          < T:MPM_ITCMAIN_THREAD M:mpm_component_video.c F:MPMComponentVideoStop L:00526 > DECODER_STOPPED: hMC=4
!MIL   -MPM          < p:00000075 t:009d50a0 T:MPM_ITCMAIN_THREAD M:mpm_component_video.c F:MPMComponentVideoStart L:00440 > DECODER_STARTED: hMC=30
!MIL   -MPM          < p:00000075 t:009d50a0 T:MPM_ITCMAIN_THREAD M:mpm_component_audio.c F:MPMComponentAudioStart L:00392 > DECODER_STARTED: hMC=30


# CHANNEL UP
ioctl VIDEO_DECODER_STOP
ioctl DEMUX_STOP posted OK on /dev/nds/demux0/elementaryfilter
ioctl VIDEO_DECODER_FLUSH_RATE_BUFFER
ioctl DEMUX_STOP posted OK on /dev/nds/demux1/remux0

# remove pids: 0(video), 1(audio)
!INFO  -MPM          < T:MPM_ITCMAIN_THREAD M:mpm_demux.c F:MPMDemuxInvalidateTPid L:01455 > Invalidated tpid for component 0
!INFO  -MPM          < T:MPM_ITCMAIN_THREAD M:mpm_demux.c F:MPMDemuxInvalidateTPid L:01455 > Invalidated tpid for component 1

# remove tipd of remux, do 4 times in total.
ioctl DEMUX_REMUX_REMOVE_TPID posted OK on /dev/nds/demux1/remux0

# change pids:
# 0x04, SYSTEMOBJECT_ESI_STREAM_TYPE_MPEG_2_VIDEO
!INFO  -MPM          < T:MPM_ITCMAIN_THREAD M:mpm_media_connection.c F:MPM_MCProcessESIObject L:01037 > Got ESI object of type 0x4 tpid 0xd00
# 0x02, SYSTEMOBJECT_ESI_STREAM_TYPE_MPEG_2_AUDIO
!INFO  -MPM          < T:MPM_ITCMAIN_THREAD M:mpm_media_connection.c F:MPM_MCProcessESIObject L:01037 > Got ESI object of type 0x2 tpid 0xd01
# 0x0a, SYSTEMOBJECT_ESI_STREAM_TYPE_TELETEXT
!INFO  -MPM          < T:MPM_ITCMAIN_THREAD M:mpm_media_connection.c F:MPM_MCProcessESIObject L:01037 > Got ESI object of type 0xa tpid 0x91d
!INFO  -MPM          < T:MPM_ITCMAIN_THREAD M:mpm_media_connection.c F:MPM_MCProcessESIObject L:01037 > Got ESI object of type 0xa tpid 0x91d
# 0x0d, SYSTEMOBJECT_ESI_STREAM_TYPE_OTV_CAROUSEL
!INFO  -MPM          < T:MPM_ITCMAIN_THREAD M:mpm_media_connection.c F:MPM_MCProcessESIObject L:01037 > Got ESI object of type 0xd tpid 0x901

# 
ioctl DEMUX_ATTACH_TPIDFILTER posted OK on /dev/nds/demux0/elementaryfilter


#-----------------------------------------------------------
# diag-error-mesg
#-----------------------------------------------------------
# memory
NDS: ^0946752607.757691 !WARN  -MEMMAN       < M:mem_moveable.c F:MHWMemAlloc L:00152 > Cannot allocate 16444 bytes in pool systemobject, not enough memory

# key buffer overflow
NDS: ^0946752564.144415 !ERROR -GFXINPUT     < M:gfx_eventbuffer_p.c F:GfxInputEventBufferPostEventSafe L:00109 > EventBuffer Overflow

# mutex deadlock since this mutex is already locked. 
NDS: ^0946751630.298833 !ERROR -aem          < M:aem_sys.c F:AEM_ThreadPrintError L:02399 > aem_api.c @ 2905 ~~~ !!!!! DEADLOCK detected !!!!!! ~~~ (try SYSTEMUTIL_DEADLOCK_DEBUG_EXT for more info) (mutex = &g_aem_list_mutex)


NDS: ^0946751501.319698 !ERROR -MSM_MDI      < M:meta_utl.c F:getStringFromArray L:04311 > can not find the string for offset 258, the array lengthis 1, and the array base is 256
NDS: ^0946751501.319795 !ERROR -MSM_MDI      < M:msm_indexer.c F:handleRecordCloseIndex L:03337 > getMasterContextByIndexHandle failed! stat = unknownString


ERROR cdi/demux/cdi_rasp.c:3467:Cannot corrupt packets unless RASP is used on remux 0


#-----------------------------------------------------------
# diag-ctrl
#-----------------------------------------------------------

# diagctl.cfg
vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/projects/picasso/fs/NDS/config/diagctl.cfg


#
# diag_cli
#

get table SYS

possible trace levels: assert fatal error warn mil info fn_entry fn_exit event p
arams return none all

set level P_Api  assert fatal error warn mil info fn_entry event params
get level P_Api

set level SYSINIT_S info

#-----------------------------------------------------------
# diag-level (refer to diag_log_formatter.c, DIAG_LOG_GetFormattedTraceBuffer)
#-----------------------------------------------------------
# Please note that release debug will not give you any more debug than FEW.

# diag.cfg
vobs/CMS_SYSTEM_INFRASTRUCTURE/DIAG/inc/config/diag_master_config.xml

vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/projects/picasso/fs/NDS/config

[DEFAULT_VALUES]
# Default trace level for components which do not call DIAG_LOG_SetTraceSettings
# The format is the same as in diag_cli:
#
# F Fatal , E Error , W Warning , I Info , P Paramaters
# R Return , ! Event , < Function entry , > Function exit
 
TRACE_LEVEL="WEF"
 
# Default trace format for components which do not call DIAG_LOG_FormatTraceSettings
# The available patterns are:
#
#  %p : process identifier (hexadecimal format)
#  %t : thread identifier (hexadecimal format)
#  %m : source file name (string is truncated after 16 characters)
#  %f : function name
#  %l : source line number (decimal number)

# (from source)
# /* Source filename */
# case 'm': 
# /* Module name */
# case 'x':
# /* Function name */
# case 'f':
# /* Thread name */
# case 'T':    
# /* Process name */
# case 'P':    
# /* Line number */
# case 'l':
# /* Thread ID */                                        
# case 't':
# /* Process ID */
# case 'p':


TRACE_FORMAT= " %p %t %m %f %l "

[OVERRIDDEN_VALUES]
# it is possible to force all segments to use the same trace format by specifying the parameter TRACE_FORMAT_FOR_ALL.
# Force a trace format for all segments This format will be applied in all cases

TRACE_FORMAT_FOR_ALL=" %p %t %m %f %l "

# Specific trace level per segment. 
#
# In all cases (i.e. whether the segment called SetTracesSettings or not), 
# the segments specified below will use the overrided trace value.
#
# For example TRACE_LEVEL_cmp1 = "FEW" will force cmp1 to only output 
# FATAL, ERROR and WARN traces at startup
TRACE_LEVEL_APPLE = "PIE"
TRACE_LEVEL_SPOUSE = "WIFE"

# values
A            : ?
F            : Fatal
E            : Error
W            : Warning
M            : Milestone
I            : Information
P            : Parameters
!            : Events
<          : Function exit(&gt;)
>          : Function entry(&lt;)

#-----------------------------------------------------------
# diag-tip
#-----------------------------------------------------------

(first)
# so how about trun on diag debug on a specific file of a component but not a whole component?
# put the below at the beginning of c file. work?

#define DEBUG
#undef DIAG_RELEASE_DBG
#define DIAG_DEBUG
#define SPM_SVR_DIAG_LOG_INFO SPM_SVR_DIAG_LOG_MIL

(second)
# tips for quick diag mesg
Please could you capture a log with the INFO logs from sim_dbc_query_list.c enabled. Unless youre running a full debug build, the easiest way I know to do this is to put a line such as the following just below the other #defines in that file:
#define SIM_TB_LOG_INFO SIM_TB_LOG_WARN


#-----------------------------------------------------------
# diag-cli
#-----------------------------------------------------------
iptables -F


#-----------------------------------------------------------
# cdi-tracker
#-----------------------------------------------------------
# there is pre-built cdi_tracker.so(clinet) in output_del.
#

# view
/view/parkkt_CDI_TRACKER_MAIN_01/vobs/FUSIONOS_3/CDI_TRACKER/build

# make
make NDS_PLATFORM=AMS_NXP_ARM9_LNUX_DARWIN_03 NDS_BUILD_ROOT=/tmp/cdi_tracker NDS_PROJECT=fusionos_cdi_tracker NDS_ENDIAN=LittleEndian

# make (ams890, bcm7335)
make NDS_PLATFORM=AMS_BCM_MIPS4K_LNUX_DARWIN_01 NDS_BUILD_ROOT=/tmp/cdi_tracker NDS_PROJECT=fusionos_cdi_tracker NDS_ENDIAN=BigEndian

# output
ls /tmp/cdi_tracker/AMS_NXP_ARM9_LNUX_DARWIN_03/LittleEndian/components/helper_libraries/cdi_tracker/lib/debug/

# from CC? does it work?
cc/parkkt_BSKYB_HR004_001/vobs/FUSIONOS_OUTPUT_DEL_2/KERN_AMS_BCM_MIPS4K_LNUX_DARWIN_01/BigEndian/debug/debug/lib

[parkkt@ukstbuild02 lib]$ ll
total 3040
drwxr-xr-x 2 parkkt ccusers   4096 Nov 23 11:23 ./
drwxr-xr-x 5 parkkt ccusers   4096 Nov 23 10:38 ../
-r-xr-xr-x 1 parkkt ccusers 532223 Nov 23 11:23 cdi_tracker.so*
-r--r--r-- 1 parkkt ccusers 476088 Nov 23 11:23 libnetwork_helper_api.a
-r--r--r-- 1 parkkt ccusers  10874 Nov 23 11:23 libnetwork_osi_utilities_api.a
-r--r--r-- 1 parkkt ccusers  56104 Nov 23 11:23 libserial_helper.a
-r--r--r-- 1 parkkt ccusers 429804 Nov 23 11:23 libstorage_helper_api.a
-r--r--r-- 1 parkkt ccusers  70574 Nov 23 11:23 libstorage_osi_utilities_api.a
-r--r--r-- 1 parkkt ccusers  69874 Nov 23 11:23 mhxnvramfs.ko
-r-xr-xr-x 1 parkkt ccusers 495472 Nov 23 11:23 xtvfs_format*
-r--r--r-- 1 parkkt ccusers 914399 Nov 23 11:23 xtvfs.ko


# run
#-----------------------------------------------------------

# run tracker server which is phyton script on linux server. 
# ensure that the server is started before starting up the STB and calls should automatically be logged.
# or use ezlog

./cdit_server <log destination>
./cdit_server cdi.log

# client side:
# ensure that following file in 'flash0/scripts/unified_startup.sh' is vaild to use cdi_tracker
# cdi tracker library must be always first in LD_PRELOAD line.
# echo "LD_PRELOAD=/NDS/lib/cdi_tracker.so:/NDS/lib/libforcesched.so:/lib/libresolv-refresh.so:/lib/libifnameindex.so /NDS
# /bin/SCD_Process" >> run.sh

#
    else
        echo "Info : Running without GDB"
		echo "Info : Copying cdi_traker"
		cp $host_root/drivers/cdit_bcm7335_be_1.0.23.so /usr/lib
		echo "Info : Loading cdi_traker"
		export CDIT_SERVER="172.18.253.143"
		echo "LD_PRELOAD=/usr/lib/cdit_bcm7335_be_1.0.23.so:/usr/lib/libforcesched.so:/lib/libresolv-refresh.so:/lib/libifnameindex.so:/usr/lib/libmutex-desched.so  /NDS/bin/SCD_Process" >> run.sh
        if [ "$WITH_CDI_TRACKER" = "1" ]
        then
           echo "LD_PRELOAD=/usr/lib/cdi_tracker.so /NDS/bin/SCD_Process" >> run.sh
        fi
    fi

# output to serial. ukstbuild02(172.18.253.143)
#
mount -t nfs 172.18.253.143:/home/NDS-UK/parkkt/fob/nfsmnt/flash0 /host
export HOME=/host
export CDIT_SERVER="1"
/host/scripts/startstack-tr.sh

# pc ip where ezlog is running
export CDIT_SERVER="172.18.200.140"

# ukstbuild02
export CDIT_SERVER="172.18.253.143"

# when tried to use a tracker, got this error. found that this was because libmutex-desched.so is somehow broken. 
# don't know how this get copied under flash0 but it's different from where it was
# vobs/FUSION_SYSTEM_INTEGRATION/BSKYB_INTEGRATION/build/picasso/AMS_BCM_MIPS4K_LNUX_DARWIN_01/BigEndian/drivers
# remove this lib from the LD_PRELOAD and worked fine.
#
/NDS/bin/SCD_Process: can't resolve symbol 'dlinit' in lib '/usr/lib/libmutex-desched.so'

#-----------------------------------------------------------
# tracker-mesg
#-----------------------------------------------------------

videodecoder0
VIDEO_DECODER_SUBSCRIBE_EVENTS

demux0/icam0/descrambler
egrep (videodecoder0|descrambler)

# CLOSE(358="demux0/elementaryfilter")0 {1042 us}
grep -n elementaryfilter log.cdi | grep CLOSE

# userinputremote0
00:15:40:385 [pid=168,tid=13447712] POLL_EXIT(timeout=-1, [fd=124="userinputremote0", revents=POLLIN,] )  = 1
00:15:40:386 [pid=168,tid=13447712] READ(124="userinputremote0", buf=0xcd2b58(06E0010000E00000), size=128) = 4 {30 us}
00:15:40:387 [pid=168,tid=13447712] POLL_START(timeout=350, [fd=124="userinputremote0", events=POLLIN,],[fd=123, events=POLLIN,],)

#define USER_INPUT_KEY_CHANNEL_UP            (0xE006U)
06.E0.01.00.00.E0.00.00 -> 00.00.E0.00.00.01.E0.06


#-----------------------------------------------------------
# IP setting (static)
#-----------------------------------------------------------
172.18.203.92
172.18.203.93
172.18.203.94
172.18.203.95
172.18.203.96

\ eth get_ip

ip 172.18.203.92
subnet 255.255.252.0
gateway 172.18.203.254
mac <mac addr>

# 266 is box num found at the bottom
ip_default 266 

ping 172.18.203.92


#-----------------------------------------------------------
# IP setting from kernel
#-----------------------------------------------------------
ifconfig eth0 up

# not works
ifconfig eth0 172.18.203.92 netmask 255.255.252.0 broadcast 172.18.203.255
route add default gw 172.18.203.255 eth0
udhcpc
ifconfig eth0 hw ether 00:60:6E:00:00:25

# the below works
udhcpc
ifconfig eth0 172.18.203.92

# ukstbuild02
ping 172.18.253.143

############################################################
## key-code
############################################################

#define USER_INPUT_KEY_STANDBY               (0xE000U)
#define USER_INPUT_KEY_SELECT                (0xE001
#define USER_INPUT_KEY_BACK                  (0xE002U)
#define USER_INPUT_KEY_VOLUME_UP             (0xE003U)
#define USER_INPUT_KEY_VOLUME_DOWN           (0xE004U)
#define USER_INPUT_KEY_MUTE                  (0xE005U)
#define USER_INPUT_KEY_CHANNEL_UP            (0xE006, 06E0010000E00000, 
#define USER_INPUT_KEY_CHANNEL_DOWN          (0xE007, 
#define USER_INPUT_KEY_INTERACTIVE           (0xE008U)
#define USER_INPUT_KEY_HELP                  (0xE009U)
#define USER_INPUT_KEY_SERVICES              (0xE00AU)
#define USER_INPUT_KEY_GUIDE                 (0xE00BU)
#define USER_INPUT_KEY_MOSAIC                (0xE00CU)
#define USER_INPUT_KEY_CANCEL                (0xE00DU)
#define USER_INPUT_KEY_INFO                  (0xE00E, 57358, )
#define USER_INPUT_KEY_TEXT                  (0xE00FU)
#define USER_INPUT_KEY_TV                    (0xE010U)
#define USER_INPUT_KEY_RCH_UNPROGRAMMED      (0xE011U)
#define USER_INPUT_KEY_REMOTE_BATTERY_LOW    (0xE012U)
#define USER_INPUT_KEY_POWER_OFF             (0xE013U)
#define USER_INPUT_KEY_POWER_ON              (0xE014U)
#define USER_INPUT_KEY_UP                    (0xE100U)
#define USER_INPUT_KEY_DOWN                  (0xE101U)
#define USER_INPUT_KEY_LEFT                  (0xE102U)
#define USER_INPUT_KEY_RIGHT                 (0xE103U)
#define USER_INPUT_KEY_RED                   (0xE200, 00E2000000E00000, 
#define USER_INPUT_KEY_GREEN                 (0xE201)
#define USER_INPUT_KEY_YELLOW                (0xE202, , 57858
#define USER_INPUT_KEY_BLUE                  (0xE203U)

#define USER_INPUT_KEY_NUMERIC_ZERO          (0xE300)
#define USER_INPUT_KEY_NUMERIC_ONE           (0xE301)
#define USER_INPUT_KEY_NUMERIC_TWO           (0xE302,
#define USER_INPUT_KEY_NUMERIC_THREE         (0xE303,
#define USER_INPUT_KEY_NUMERIC_FOUR          (0xE304U)
#define USER_INPUT_KEY_NUMERIC_FIVE          (0xE305U)
#define USER_INPUT_KEY_NUMERIC_SIX           (0xE306U)
#define USER_INPUT_KEY_NUMERIC_SEVEN         (0xE307U)
#define USER_INPUT_KEY_NUMERIC_EIGHT         (0xE308U)
#define USER_INPUT_KEY_NUMERIC_NINE          (0xE309U)
#define USER_INPUT_KEY_PLAY                  (0xE400U)
#define USER_INPUT_KEY_PAUSE                 (0xE401U)
#define USER_INPUT_KEY_STOP                  (0xE402U)
#define USER_INPUT_KEY_RECORD                (0xE403U)
#define USER_INPUT_KEY_FORWARD               (0xE404U)
#define USER_INPUT_KEY_FAST_FORWARD          (0xE405U)
#define USER_INPUT_KEY_REVERSE               (0xE406U)
#define USER_INPUT_KEY_FAST_REVERSE          (0xE407U)
#define USER_INPUT_KEY_STEP_FORWARD          (0xE408U)
#define USER_INPUT_KEY_STEP_BACKWARD         (0xE409U)
#define USER_INPUT_KEY_BOX_OFFICE            (0xEF00U)
#define USER_INPUT_KEY_SKY                   (0xEF01U)
#define USER_INPUT_KEY_PRIVATE_002           (0xEF02U)
#define USER_INPUT_KEY_PRIVATE_003           (0xEF03U)
#define USER_INPUT_KEY_PRIVATE_004           (0xEF04U)
#define USER_INPUT_KEY_PRIVATE_005           (0xEF05U)


############################################################
## test-soak
############################################################

# hudsonmater1
172.17.53.98


http://hudsonmaster1.uk.nds.com:8080/hudson/
http://hudsonmaster1.uk.nds.com:8082/farmstatus

# stormtest1 
\\172.17.53.1\d$\Picasso\stormtest\internal\soak\Tests
\\172.17.53.1\d$\Picasso\stormtest\internal\soak\Tests\logs\Fri-110527\AT21-900-171132_PORT3

# stormtest2
\\172.17.53.33\d$\Picasso\stormtest\internal\soak\Tests 

# stormtest4
\\172.17.53.129\d$\Picasso\stormtest\internal\soak\Tests 

# console full
Logging into

# look for the below from 'Console Output':
# Storm: All logs stored in \\STORMTEST1\D$\Picasso\stormtest\internal\soak\Tests\logs\Sun-110508\AT3-720-175640_PORT16
All logs stored in logs\Mon-101122\AT1-900-170202_PORT8

command=AT10_ChannelTypes.py stormtest1 14 hudson /export/systemTestFarmBoxes/STORM-01_14 True 900 20
Test FAILED

# http://hoover.uk.nds.com/fusionmadesimple/index.php/GaudiTesting
# AT1: test_script_name <Server> <Slot> <Tester> <mount point> <power cycle> <max run time>
# test=AT1_Channel_UpDown.py %s %s %s %s True 900 129
AT1_ChannelZap.bat KT-RR01 10 9000 20
AT1_ChannelZap.bat KT-RR02 10 9000 20

# 2
AT2_BannerNavigate.bat KT-RR01 50000000000

# 3
AT3_Interactive.bat KT-RR01 5000000000

# 4: Booking, Live Pause, Review Buffer Trick Modes, Playback, Delete
AT4_Trickmode.bat KT-RR01 50000000000

# 6
# AT6_NormalUsuage.bat <redratname> <number of times to run the test> <smart card pin>
AT6_NormalUsuage.bat KT-RR02 10000 8586

# 8
# test=AT8_GuideNavigate.py %s %s %s %s True 900 32
AT8_GuideNavigate.bat KT-RR01 20 10 50000000000

# 10: Viewing and live pause on SD, HD and Radio channels 
AT10_ChannelTypes.bat KT-RR01 50000000000

# 13:
AT13_Banner.bat KT-RR01 50000000000

# 21:
AT21_ManEventRec.bat KT-RR01 40 50000000000
AT21_ManEventRec.bat KT-RR02 40 50000000000

# 10: Viewing and live pause on SD, HD and Radio channels 
AT28_DITL.bat KT-RR01 500000

# 24
AT24_FastChannelZap.bat KT-RR01 50000000000
AT24_FastChannelZap.bat KT-RR02 50000000000

# 28
AT28_DITL.bat KT-RR02 50000000000

############################################################
## PYTHON
############################################################
# calc
>>> hex(((25 & 0x3FF) << 22) | ((0x02 & 0x3) << 16) | ((2 & 0xF) << 12) | (1))
'0x6422001'

>>> print "0x%x" % 104996865
0x6422001


############################################################
## LINUX CMDS
############################################################
#
egrep -nr "java.lang.Exception|KEY_PRESS:|ERROR|FATAL|AFFIRM"
grep -nr --include makefile COMPONENT_NAME ./ | more

# -r reverse
# -n numeric
# -k range
sort -r -n -k 25,25 output.ext.log | more

# 
# -n : only print lines specified with the p command or the p flag of the s command.
sed -n 25,75p you-file-here 

# sed '11 q' which quits when the eleventh line is reached.
# the below outputs '25-74' excluding 75th line.
sed -n '75q;25,75p' you-file-here 

#
# | sed 's/^[ \t]*//;s/[ \t]*$//'
#
# (before)
               ALARM_MEMORY_POOL
                 BEM_SERVER_POOL
                CAMM_SERVER_POOL
                     CAPPROC_SVR
                             CTM
                         CTM_SVR

# (after)
ALARM_MEMORY_POOL
BEM_SERVER_POOL
CAMM_SERVER_POOL
CAPPROC_SVR
CTM

# exampe input
#                ALARM_MEMORY_POOL,   28016,   28016,   30720
# remove spaces between columns and ',' as well
#
# output:
# ALARM_MEMORY_POOL 28016 28016 30720
#
| sed 's/ //g' | sed 's/,/ /g'


# sed -n -e '/BEGIN/,/END/p' /my/test/file > needed blocks* 
sed -n -e '/PCAT_VIEW_CLNT_POOL/,/usage/p' MEM117.TXT | more

sed 's/^NDS.*F://' all.out > all-shout.out

while x=0; do echo "----"; grep ADPT_GUIDE /tmp/MPROF122.TXT;grep ADPT_GUIDE /mnt/nds/dev_5/part_0/FSN_DATA/LOG; sleep 60; done

#-----------------------------------------------------------
# klogd
#-----------------------------------------------------------
klogd -c 7

#-----------------------------------------------------------
# LD_LIBRARY_PATH
#-----------------------------------------------------------
export LD_LIBRARY_PATH=./

#-----------------------------------------------------------
# force core dump
#-----------------------------------------------------------
# print a process tree
ps axjf

# print threads info
ps -eLf

# print threads belongs to this PID
ps -p PID -T

#-----------------------------------------------------------
# force core dump (for 595)
#-----------------------------------------------------------
echo '/mnt/nds/dev_5/part_0/FSN_DATA/cor.%p' >/proc/sys/kernel/core_pattern
export P=`ps -a | grep APP_Process | cut -d' ' -f3`;echo $P;kill -s 11 $P;export P=`ps -a | grep MW_Process | cut -d' ' -f3`;echo $P;kill -s 11 $P;

SIGSEGV 	11 	Core 	Invalid memory reference 
kill -SEGV 11 PID
kill -s 11 PID
kill -s 11 113
./tmp/core.{PID}


############################################################
## REG-EXP
############################################################
\S
When the LOCALE and UNICODE flags are not specified, matches any non-whitespace character; 
this is equivalent to the set [^ \t\n\r\f\v] With LOCALE, it will match any character not in this set, 
and not defined as space in the current locale. If UNICODE is set, this will match anything other than [ \t\n\r\f\v] 
and characters marked as space in the Unicode character properties database.


\w
When the LOCALE and UNICODE flags are not specified, matches any alphanumeric character and the underscore; 
this is equivalent to the set [a-zA-Z0-9_]. With LOCALE, it will match the set [0-9_] plus whatever characters 
are defined as alphanumeric for the current locale. If UNICODE is set, this will match the characters [0-9_] plus 
whatever is classified as alphanumeric in the Unicode character properties database.

\W
When the LOCALE and UNICODE flags are not specified, matches any non-alphanumeric character; this is equivalent to the set [^a-zA-Z0-9_].

\b
Matches the empty string, but only at the beginning or end of a word. A word is defined as a sequence of alphanumeric 
or underscore characters, so the end of a word is indicated by whitespace or a non-alphanumeric, non-underscore character. 
Note that \b is defined as the boundary between \w and \W, so the precise set of characters deemed to be alphanumeric 
depends on the values of the UNICODE and LOCALE flags. Inside a character range, \b represents the backspace character, 
for compatibility with Pythons string literals.

egrep "\b(IC|ID|digam)\b" log.log


############################################################
## ANSI COLOR PRINT
############################################################

# dark blue
printf("\033[32m CR-1048: NVRAM Retry Byte set to 0xqlX \033[0m \n",nvram_retry_bytes);


############################################################
## UTILS
############################################################
# log_convert logfile
# extract key presesses and covert it into redrat scripts


############################################################
## CFE
############################################################
# vmlinux isn't a compressed file, do not use 'boot -z'
vobs/FUSIONOS_OUTPUT_DEL_2/KERN_AMS_BCM_MIPS4K_LNUX_DARWIN_01/BigEndian/debug/release/BootImage/vmlinux

##
macprog2 00-19-FB-1A-2C-2F

##
ifconfig eth0 -auto
100 MB Full-Duplex (auto-neg)
Device eth0:  hwaddr 00-19-FB-1A-2C-2F, ipaddr 172.18.200.200, mask 255.255.252.0
        gateway 172.18.203.254, nameserver 172.18.253.100, domain uk.nds.com
*** command status = 0

##
ping 172.18.253.143

##
ifconfig eth0 -auto; boot -elf 172.18.253.143:/parkkt/890/vmlinux 'mem=128M ip=dhcp console=uart,mmio,0x10400b00,115200n8'
setenv -p STARTUP "ifconfig eth0 -auto;boot -elf 172.18.253.143:/parkkt/890/vmlinux 'mem=128M ip=dhcp console=uart,mmio,0x10400b00,115200n8'"
setenv -p STARTUP " "

############################################################
# look for the below error mesg from the main log, all-tests.log.
=============================[SYSTEM TEST ERROR]================================



############################################################
## DMS
############################################################
DMS_0452.1 - Book PPV event from promo



############################################################
## ca-cards
############################################################
946684917205: PooledExecutor#3: [  EPG_CA:WARN]: CA.stateActive: __________________________________________________________________
946684917205: PooledExecutor#3: [  EPG_CA:WARN]: CA.stateActive: 
946684917205: PooledExecutor#3: [  EPG_CA:WARN]: CA.stateActive: CARD ID: 42705542
946684917205: PooledExecutor#3: [  EPG_CA:WARN]: CA.stateActive: CARD TYPE: 1
946684917205: PooledExecutor#3: [  EPG_CA:WARN]: CA.stateActive: CARD CHECK DIGIT: 1
946684917205: PooledExecutor#3: [  EPG_CA:WARN]: CA.stateActive: SUBSCRIBER ID: 22633364
946684917205: PooledExecutor#3: [  EPG_CA:WARN]: CA.stateActive: CAS ID: 2403
946684917205: PooledExecutor#3: [  EPG_CA:WARN]: CA.stateActive: BOUQUET ID: 4101
946684917205: PooledExecutor#3: [  EPG_CA:WARN]: CA.stateActive: SUB-BOUQUET ID: 1
946684917205: PooledExecutor#3: [  EPG_CA:WARN]: CA.stateActive: COUNTRY CODE: 4670034
946684917205: PooledExecutor#3: [  EPG_CA:WARN]: CA.stateActive: CURRENCY CODE: 1
946684917205: PooledExecutor#3: [  EPG_CA:WARN]: CA.stateActive: ZIP CODE: TW7     
946684917205: PooledExecutor#3: [  EPG_CA:WARN]: CA.stateActive: CARD AUTHORIZED: true
946684917205: PooledExecutor#3: [  EPG_CA:WARN]: CA.stateActive: CARD PAIRED: true
946684917205: PooledExecutor#3: [  EPG_CA:WARN]: CA.stateActive: PVR SUB: true
946684917205: PooledExecutor#3: [  EPG_CA:WARN]: CA.stateActive: BSKYB IPPV ALLOWED: false
946684917205: PooledExecutor#3: [  EPG_CA:WARN]: CA.stateActive: PDL ENTITLEMENT: true
946684917205: PooledExecutor#3: [  EPG_CA:WARN]: CA.stateActive: COMMERCIAL: false
946684917205: PooledExecutor#3: [  EPG_CA:WARN]: CA.stateActive: __________________________________________________________________

############################################################
## sky-contacts
############################################################

# QC?
Kumar, Satish [Satish.Kumar@bskyb.com], 07982024680

# Picasso Dev
Louw, Thorben (Thorben.Louw@bskyb.com, Toby)
Tapper, James [James.Tapper@bskyb.com]
Bayliss, James [mailto:James.Bayliss@bskyb.com] 
O'Regan, Mike
Jim (was NDS colleague)
Lee Miles, 02070324757
McDonnell, Deirdre Sky is 0207 03 24779
#
Nodwell, Charlie

#
Golani, Santosh

#
Robin Davis
Release Support Manager 

#
Ravindranath, Dileep [Dileep.Ravindranath@bskyb.com] 01277208836


############################################################
## VIM
############################################################
# not working
Fp KEY_PRESS\|VRM_JOB_START

Fp VRM_JOB_START\|TUNER_LOCKED\|hMC=0x304\|hMC=772
s/MCM_MEDIACONN_Run\|VRM_JOB_START\|hMC=0x36

